<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Active Support Core Extensions â€” Ruby on Rails Guides</title>
<link rel="stylesheet" type="text/css" href="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/style.css">
<link rel="stylesheet" type="text/css" href="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/print.css" media="print">

<link rel="stylesheet" type="text/css" href="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shCore.css">
<link rel="stylesheet" type="text/css" href="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shThemeRailsGuides.css">

<link rel="stylesheet" type="text/css" href="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/fixes.css">

<link href="http://edgeguides.rubyonrails.org/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
</head>
<body class="guide">
  <div>
    <img src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/edge_badge.png" alt="edge-badge" id="edge-badge">
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">More at <a href="http://rubyonrails.org/">rubyonrails.org:</a> </strong>
      <span class="red-button more-info-button">
        More Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="http://rubyonrails.org/">Overview</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/download">Download</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/deploy">Deploy</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">Code</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/screencasts">Screencasts</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/documentation">Documentation</a></li>
        <li class="more-info"><a href="http://rubyonrails.org/community">Community</a></li>
        <li class="more-info"><a href="http://weblog.rubyonrails.org/">Blog</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="http://edgeguides.rubyonrails.org/index.html" title="Return to home page">Guides.rubyonrails.org</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="http://edgeguides.rubyonrails.org/index.html">Home</a></li>
        <li class="guides-index guides-index-large">
          <a href="http://edgeguides.rubyonrails.org/index.html" id="guidesMenu" class="guides-index-item nav-item">Guides Index</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr>
              <dl class="L">
                <dt>Start Here</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/getting_started.html">Getting Started with Rails</a></dd>
                <dt>Models</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/active_record_basics.html">Active Record Basics</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/active_record_migrations.html">Active Record Migrations</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/active_record_validations.html">Active Record Validations</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/active_record_callbacks.html">Active Record Callbacks</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/association_basics.html">Active Record Associations</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/active_record_querying.html">Active Record Query Interface</a></dd>
                <dt>Views</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/layouts_and_rendering.html">Layouts and Rendering in Rails</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/form_helpers.html">Action View Form Helpers</a></dd>
                <dt>Controllers</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/action_controller_overview.html">Action Controller Overview</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/routing.html">Rails Routing from the Outside In</a></dd>
              </dl>
              <dl class="R">
                <dt>Digging Deeper</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/active_support_core_extensions.html">Active Support Core Extensions</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/i18n.html">Rails Internationalization API</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/action_mailer_basics.html">Action Mailer Basics</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/active_job_basics.html">Active Job Basics</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/security.html">Securing Rails Applications</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/debugging_rails_applications.html">Debugging Rails Applications</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/configuring.html">Configuring Rails Applications</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/command_line.html">Rails Command Line Tools and Rake Tasks</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/asset_pipeline.html">Asset Pipeline</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/working_with_javascript_in_rails.html">Working with JavaScript in Rails</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/autoloading_and_reloading_constants.html">Autoloading and Reloading Constants</a></dd>
                <dt>Extending Rails</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/rails_on_rack.html">Rails on Rack</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/generators.html">Creating and Customizing Rails Generators</a></dd>
                <dt>Contributing to Ruby on Rails</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/api_documentation_guidelines.html">API Documentation Guidelines</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a></dd>
                <dt>Maintenance Policy</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/maintenance_policy.html">Maintenance Policy</a></dd>
                <dt>Release Notes</dt>
                <dd><a href="http://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/4_2_release_notes.html">Ruby on Rails 4.2 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/4_1_release_notes.html">Ruby on Rails 4.1 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/4_0_release_notes.html">Ruby on Rails 4.0 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/3_2_release_notes.html">Ruby on Rails 3.2 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/3_1_release_notes.html">Ruby on Rails 3.1 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/3_0_release_notes.html">Ruby on Rails 3.0 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/2_3_release_notes.html">Ruby on Rails 2.3 Release Notes</a></dd>
                <dd><a href="http://edgeguides.rubyonrails.org/2_2_release_notes.html">Ruby on Rails 2.2 Release Notes</a></dd>
              </dl>
          </div>
        </li>
        <li><a class="nav-item" href="http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html">Contribute</a></li>
        <li><a class="nav-item" href="http://edgeguides.rubyonrails.org/credits.html">Credits</a></li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">Guides Index</option>
              <optgroup label="Start Here">
                  <option value="getting_started.html">Getting Started with Rails</option>
              </optgroup>
              <optgroup label="Models">
                  <option value="active_record_basics.html">Active Record Basics</option>
                  <option value="active_record_migrations.html">Active Record Migrations</option>
                  <option value="active_record_validations.html">Active Record Validations</option>
                  <option value="active_record_callbacks.html">Active Record Callbacks</option>
                  <option value="association_basics.html">Active Record Associations</option>
                  <option value="active_record_querying.html">Active Record Query Interface</option>
              </optgroup>
              <optgroup label="Views">
                  <option value="layouts_and_rendering.html">Layouts and Rendering in Rails</option>
                  <option value="form_helpers.html">Action View Form Helpers</option>
              </optgroup>
              <optgroup label="Controllers">
                  <option value="action_controller_overview.html">Action Controller Overview</option>
                  <option value="routing.html">Rails Routing from the Outside In</option>
              </optgroup>
              <optgroup label="Digging Deeper">
                  <option selected="selected" value="active_support_core_extensions.html">Active Support Core Extensions</option>
                  <option value="i18n.html">Rails Internationalization API</option>
                  <option value="action_mailer_basics.html">Action Mailer Basics</option>
                  <option value="active_job_basics.html">Active Job Basics</option>
                  <option value="security.html">Securing Rails Applications</option>
                  <option value="debugging_rails_applications.html">Debugging Rails Applications</option>
                  <option value="configuring.html">Configuring Rails Applications</option>
                  <option value="command_line.html">Rails Command Line Tools and Rake Tasks</option>
                  <option value="asset_pipeline.html">Asset Pipeline</option>
                  <option value="working_with_javascript_in_rails.html">Working with JavaScript in Rails</option>
                  <option value="autoloading_and_reloading_constants.html">Autoloading and Reloading Constants</option>
              </optgroup>
              <optgroup label="Extending Rails">
                  <option value="rails_on_rack.html">Rails on Rack</option>
                  <option value="generators.html">Creating and Customizing Rails Generators</option>
              </optgroup>
              <optgroup label="Contributing to Ruby on Rails">
                  <option value="contributing_to_ruby_on_rails.html">Contributing to Ruby on Rails</option>
                  <option value="api_documentation_guidelines.html">API Documentation Guidelines</option>
                  <option value="ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</option>
              </optgroup>
              <optgroup label="Maintenance Policy">
                  <option value="maintenance_policy.html">Maintenance Policy</option>
              </optgroup>
              <optgroup label="Release Notes">
                  <option value="upgrading_ruby_on_rails.html">Upgrading Ruby on Rails</option>
                  <option value="4_2_release_notes.html">Ruby on Rails 4.2 Release Notes</option>
                  <option value="4_1_release_notes.html">Ruby on Rails 4.1 Release Notes</option>
                  <option value="4_0_release_notes.html">Ruby on Rails 4.0 Release Notes</option>
                  <option value="3_2_release_notes.html">Ruby on Rails 3.2 Release Notes</option>
                  <option value="3_1_release_notes.html">Ruby on Rails 3.1 Release Notes</option>
                  <option value="3_0_release_notes.html">Ruby on Rails 3.0 Release Notes</option>
                  <option value="2_3_release_notes.html">Ruby on Rails 2.3 Release Notes</option>
                  <option value="2_2_release_notes.html">Ruby on Rails 2.2 Release Notes</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide">

  <div id="feature">
    <div class="wrapper">
      <h2>Active Support Core Extensions</h2><p>Active Support is the 
Ruby on Rails component responsible for providing Ruby language 
extensions, utilities, and other transversal stuff.</p><p>It offers a 
richer bottom-line at the language level, targeted both at the 
development of Rails applications, and at the development of Ruby on 
Rails itself.</p><p>After reading this guide, you will know:</p>
<ul>
<li>What Core Extensions are.</li>
<li>How to load all extensions.</li>
<li>How to cherry-pick just the extensions you want.</li>
<li>What extensions Active Support provides.</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/chapters_icon.gif" alt="">Chapters</h3>
            <ol class="chapters">
<li>
<a href="#how-to-load-core-extensions">How to Load Core Extensions</a>

<ul>
<li><a href="#stand-alone-active-support">Stand-Alone Active Support</a></li>
<li><a href="#active-support-within-a-ruby-on-rails-application">Active Support Within a Ruby on Rails Application</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-all-objects">Extensions to All Objects</a>

<ul>
<li><a href="#blank-questionmark-and-present-questionmark"><code>blank?</code> and <code>present?</code></a></li>
<li><a href="#presence"><code>presence</code></a></li>
<li><a href="#duplicable-questionmark"><code>duplicable?</code></a></li>
<li><a href="#deep-dup"><code>deep_dup</code></a></li>
<li><a href="#try"><code>try</code></a></li>
<li><a href="#class-eval-args-block"><code>class_eval(*args, &amp;block)</code></a></li>
<li><a href="#acts-like-questionmark-duck"><code>acts_like?(duck)</code></a></li>
<li><a href="#to-param"><code>to_param</code></a></li>
<li><a href="#to-query"><code>to_query</code></a></li>
<li><a href="#with-options"><code>with_options</code></a></li>
<li><a href="#json-support">JSON support</a></li>
<li><a href="#instance-variables">Instance Variables</a></li>
<li><a href="#silencing-warnings-and-exceptions">Silencing Warnings and Exceptions</a></li>
<li><a href="#in-questionmark"><code>in?</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-module">Extensions to <code>Module</code></a>

<ul>
<li><a href="#alias-method-chain"><code>alias_method_chain</code></a></li>
<li><a href="#attributes">Attributes</a></li>
<li><a href="#extensions-to-module-parents">Parents</a></li>
<li><a href="#constants">Constants</a></li>
<li><a href="#reachable">Reachable</a></li>
<li><a href="#anonymous">Anonymous</a></li>
<li><a href="#method-delegation">Method Delegation</a></li>
<li><a href="#redefining-methods">Redefining Methods</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-class">Extensions to <code>Class</code></a>

<ul>
<li><a href="#class-attributes">Class Attributes</a></li>
<li><a href="#subclasses-descendants">Subclasses &amp; Descendants</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-string">Extensions to <code>String</code></a>

<ul>
<li><a href="#output-safety">Output Safety</a></li>
<li><a href="#remove"><code>remove</code></a></li>
<li><a href="#squish"><code>squish</code></a></li>
<li><a href="#truncate"><code>truncate</code></a></li>
<li><a href="#truncate-words"><code>truncate_words</code></a></li>
<li><a href="#inquiry"><code>inquiry</code></a></li>
<li><a href="#starts-with-questionmark-and-ends-with-questionmark"><code>starts_with?</code> and <code>ends_with?</code></a></li>
<li><a href="#strip-heredoc"><code>strip_heredoc</code></a></li>
<li><a href="#indent"><code>indent</code></a></li>
<li><a href="#access">Access</a></li>
<li><a href="#inflections">Inflections</a></li>
<li><a href="#extensions-to-string-conversions">Conversions</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-numeric">Extensions to <code>Numeric</code></a>

<ul>
<li><a href="#bytes">Bytes</a></li>
<li><a href="#time">Time</a></li>
<li><a href="#formatting">Formatting</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-integer">Extensions to <code>Integer</code></a>

<ul>
<li><a href="#multiple-of-questionmark"><code>multiple_of?</code></a></li>
<li><a href="#ordinal"><code>ordinal</code></a></li>
<li><a href="#ordinalize"><code>ordinalize</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-bigdecimal">Extensions to <code>BigDecimal</code></a>

<ul>
<li><a href="#extensions-to-bigdecimal-to-s"><code>to_s</code></a></li>
<li><a href="#extensions-to-bigdecimal-to-formatted-s"><code>to_formatted_s</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-enumerable">Extensions to <code>Enumerable</code></a>

<ul>
<li><a href="#sum"><code>sum</code></a></li>
<li><a href="#index-by"><code>index_by</code></a></li>
<li><a href="#many-questionmark"><code>many?</code></a></li>
<li><a href="#exclude-questionmark"><code>exclude?</code></a></li>
<li><a href="#without"><code>without</code></a></li>
<li><a href="#pluck"><code>pluck</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-array">Extensions to <code>Array</code></a>

<ul>
<li><a href="#accessing">Accessing</a></li>
<li><a href="#adding-elements">Adding Elements</a></li>
<li><a href="#options-extraction">Options Extraction</a></li>
<li><a href="#extensions-to-array-conversions">Conversions</a></li>
<li><a href="#wrapping">Wrapping</a></li>
<li><a href="#duplicating">Duplicating</a></li>
<li><a href="#grouping">Grouping</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-hash">Extensions to <code>Hash</code></a>

<ul>
<li><a href="#extensions-to-hash-conversions">Conversions</a></li>
<li><a href="#merging">Merging</a></li>
<li><a href="#deep-duplicating">Deep duplicating</a></li>
<li><a href="#working-with-keys">Working with Keys</a></li>
<li><a href="#working-with-values">Working with Values</a></li>
<li><a href="#slicing">Slicing</a></li>
<li><a href="#extracting">Extracting</a></li>
<li><a href="#indifferent-access">Indifferent Access</a></li>
<li><a href="#compacting">Compacting</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-regexp">Extensions to <code>Regexp</code></a>

<ul>
<li><a href="#multiline-questionmark"><code>multiline?</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-range">Extensions to <code>Range</code></a>

<ul>
<li><a href="#extensions-to-range-to-s"><code>to_s</code></a></li>
<li><a href="#include-questionmark"><code>include?</code></a></li>
<li><a href="#overlaps-questionmark"><code>overlaps?</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-date">Extensions to <code>Date</code></a>

<ul>
<li><a href="#extensions-to-date-calculations">Calculations</a></li>
<li><a href="#extensions-to-date-conversions">Conversions</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-datetime">Extensions to <code>DateTime</code></a>

<ul>
<li><a href="#extensions-to-datetime-calculations">Calculations</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-time">Extensions to <code>Time</code></a>

<ul>
<li><a href="#calculations">Calculations</a></li>
<li><a href="#time-constructors">Time Constructors</a></li>
</ul>
</li>
<li>
<a href="#extensions-to-file">Extensions to <code>File</code></a>

<ul>
<li><a href="#atomic-write"><code>atomic_write</code></a></li>
</ul>
</li>
<li>
<a href="#extensions-to-marshal">Extensions to <code>Marshal</code></a>

<ul>
<li><a href="#load"><code>load</code></a></li>
</ul>
</li>
<li><a href="#extensions-to-nameerror">Extensions to <code>NameError</code></a></li>
<li><a href="#extensions-to-loaderror">Extensions to <code>LoadError</code></a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id="how-to-load-core-extensions">1 How to Load Core Extensions</h3><h4 id="stand-alone-active-support">1.1 Stand-Alone Active Support</h4><p>In
 order to have a near-zero default footprint, Active Support does not 
load anything by default. It is broken in small pieces so that you can 
load just what you need, and also has some convenience entry points to 
load related extensions in one shot, even everything.</p><p>Thus, after a simple require like:</p><div class="code_container">
<div><div id="highlighter_484857" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">require </code><code class="ruby string">'active_support'</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>objects do not even respond to <code>blank?</code>. Let's see how to load its definition.</p><h5 id="cherry-picking-a-definition">1.1.1 Cherry-picking a Definition</h5><p>The most lightweight way to get <code>blank?</code> is to cherry-pick the file that defines it.</p><p>For
 every single method defined as a core extension this guide has a note 
that says where such a method is defined. In the case of <code>blank?</code> the note reads:</p><div class="note"><p>Defined in <code>active_support/core_ext/object/blank.rb</code>.</p></div><p>That means that you can require it like this:</p><div class="code_container">
<div><div id="highlighter_106311" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">require </code><code class="ruby string">'active_support'</code></div><div class="line number2 index1 alt1"><code class="ruby plain">require </code><code class="ruby string">'active_support/core_ext/object/blank'</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Support has been carefully revised so that cherry-picking a file loads only strictly needed dependencies, if any.</p><h5 id="loading-grouped-core-extensions">1.1.2 Loading Grouped Core Extensions</h5><p>The next level is to simply load all extensions to <code>Object</code>. As a rule of thumb, extensions to <code>SomeClass</code> are available in one shot by loading <code>active_support/core_ext/some_class</code>.</p><p>Thus, to load all extensions to <code>Object</code> (including <code>blank?</code>):</p><div class="code_container">
<div><div id="highlighter_468306" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">require </code><code class="ruby string">'active_support'</code></div><div class="line number2 index1 alt1"><code class="ruby plain">require </code><code class="ruby string">'active_support/core_ext/object'</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="loading-all-core-extensions">1.1.3 Loading All Core Extensions</h5><p>You may prefer just to load all core extensions, there is a file for that:</p><div class="code_container">
<div><div id="highlighter_937025" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">require </code><code class="ruby string">'active_support'</code></div><div class="line number2 index1 alt1"><code class="ruby plain">require </code><code class="ruby string">'active_support/core_ext'</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="loading-all-active-support">1.1.4 Loading All Active Support</h5><p>And finally, if you want to have all Active Support available just issue:</p><div class="code_container">
<div><div id="highlighter_1691" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">require </code><code class="ruby string">'active_support/all'</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>That does not even put the entire Active Support in memory upfront indeed, some stuff is configured via <code>autoload</code>, so it is only loaded if used.</p><h4 id="active-support-within-a-ruby-on-rails-application">1.2 Active Support Within a Ruby on Rails Application</h4><p>A Ruby on Rails application loads all Active Support unless <code>config.active_support.bare</code>
 is true. In that case, the application will only load what the 
framework itself cherry-picks for its own needs, and can still 
cherry-pick itself at any granularity level, as explained in the 
previous section.</p><h3 id="extensions-to-all-objects">2 Extensions to All Objects</h3><h4 id="blank-questionmark-and-present-questionmark">2.1 <code>blank?</code> and <code>present?</code>
</h4><p>The following values are considered to be blank in a Rails application:</p>
<ul>
<li><p><code>nil</code> and <code>false</code>,</p></li>
<li><p>strings composed only of whitespace (see note below),</p></li>
<li><p>empty arrays and hashes, and</p></li>
<li><p>any other object that responds to <code>empty?</code> and is empty.</p></li>
</ul>
<div class="info"><p>The predicate for strings uses the Unicode-aware character class <code>[:space:]</code>, so for example U+2029 (paragraph separator) is considered to be whitespace.</p></div><div class="warning"><p>Note that numbers are not mentioned. In particular, 0 and 0.0 are <strong>not</strong> blank.</p></div><p>For example, this method from <code>ActionController::HttpAuthentication::Token::ControllerMethods</code> uses <code>blank?</code> for checking whether a token is present:</p><div class="code_container">
<div><div id="highlighter_436416" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">authenticate(controller, &amp;login_procedure)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">token, options = token_and_options(controller.request)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">unless</code> <code class="ruby plain">token.blank?</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">login_procedure.call(token, options)</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>present?</code> is equivalent to <code>!blank?</code>. This example is taken from <code>ActionDispatch::Http::Cache::Response</code>:</p><div class="code_container">
<div><div id="highlighter_767130" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">set_conditional_cache_control!</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">return</code> <code class="ruby keyword">if</code> <code class="ruby keyword">self</code><code class="ruby plain">[</code><code class="ruby string">"Cache-Control"</code><code class="ruby plain">].present?</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/blank.rb</code>.</p></div><h4 id="presence">2.2 <code>presence</code>
</h4><p>The <code>presence</code> method returns its receiver if <code>present?</code>, and <code>nil</code> otherwise. It is useful for idioms like this:</p><div class="code_container">
<div><div id="highlighter_267923" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">host = config[</code><code class="ruby color2">:host</code><code class="ruby plain">].presence || </code><code class="ruby string">'localhost'</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/blank.rb</code>.</p></div><h4 id="duplicable-questionmark">2.3 <code>duplicable?</code>
</h4><p>A few fundamental objects in Ruby are singletons. For example, 
in the whole life of a program the integer 1 refers always to the same 
instance:</p><div class="code_container">
<div><div id="highlighter_786017" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1</code><code class="ruby plain">.object_id&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 3</code></div><div class="line number2 index1 alt1"><code class="ruby plain">Math.cos(</code><code class="ruby constants">0</code><code class="ruby plain">).to_i.object_id&nbsp; </code><code class="ruby comments"># =&gt; 3</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Hence, there's no way these objects can be duplicated through <code>dup</code> or <code>clone</code>:</p><div class="code_container">
<div><div id="highlighter_617734" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">true</code><code class="ruby plain">.dup&nbsp; </code><code class="ruby comments"># =&gt; TypeError: can't dup TrueClass</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Some numbers which are not singletons are not duplicable either:</p><div class="code_container">
<div><div id="highlighter_932543" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">0</code><code class="ruby plain">.</code><code class="ruby constants">0</code><code class="ruby plain">.clone&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; allocator undefined for Float</code></div><div class="line number2 index1 alt1"><code class="ruby plain">(</code><code class="ruby constants">2</code><code class="ruby plain">**</code><code class="ruby constants">1024</code><code class="ruby plain">).clone&nbsp; </code><code class="ruby comments"># =&gt; allocator undefined for Bignum</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Support provides <code>duplicable?</code> to programmatically query an object about this property:</p><div class="code_container">
<div><div id="highlighter_236027" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"foo"</code><code class="ruby plain">.duplicable? </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby string">""</code><code class="ruby plain">.duplicable?&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number3 index2 alt2"><code class="ruby constants">0</code><code class="ruby plain">.</code><code class="ruby constants">0</code><code class="ruby plain">.duplicable?&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">false</code><code class="ruby plain">.duplicable? </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>By definition all objects are <code>duplicable?</code> except <code>nil</code>, <code>false</code>, <code>true</code>, symbols, numbers, class, module, and method objects.</p><div class="warning"><p>Any class can disallow duplication by removing <code>dup</code> and <code>clone</code> or raising exceptions from them. Thus only <code>rescue</code> can tell whether a given arbitrary object is duplicable. <code>duplicable?</code> depends on the hard-coded list above, but it is much faster than <code>rescue</code>. Use it only if you know the hard-coded list is enough in your use case.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/object/duplicable.rb</code>.</p></div><h4 id="deep-dup">2.4 <code>deep_dup</code>
</h4><p>The <code>deep_dup</code> method returns deep copy of a given object. Normally, when you <code>dup</code> an object that contains other objects, Ruby does not <code>dup</code> them, so it creates a shallow copy of the object. If you have an array with a string, for example, it will look like this:</p><div class="code_container">
<div><div id="highlighter_303595" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">array&nbsp;&nbsp;&nbsp;&nbsp; = [</code><code class="ruby string">'string'</code><code class="ruby plain">]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">duplicate = array.dup</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby plain">duplicate.push </code><code class="ruby string">'another-string'</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby comments"># the object was duplicated, so the element was added only to the duplicate</code></div><div class="line number7 index6 alt2"><code class="ruby plain">array&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ['string']</code></div><div class="line number8 index7 alt1"><code class="ruby plain">duplicate </code><code class="ruby comments"># =&gt; ['string', 'another-string']</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="ruby plain">duplicate.first.gsub!(</code><code class="ruby string">'string'</code><code class="ruby plain">, </code><code class="ruby string">'foo'</code><code class="ruby plain">)</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="ruby comments"># first element was not duplicated, it will be changed in both arrays</code></div><div class="line number13 index12 alt2"><code class="ruby plain">array&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ['foo']</code></div><div class="line number14 index13 alt1"><code class="ruby plain">duplicate </code><code class="ruby comments"># =&gt; ['foo', 'another-string']</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As you can see, after duplicating the <code>Array</code> instance, we
 got another object, therefore we can modify it and the original object 
will stay unchanged. This is not true for array's elements, however. 
Since <code>dup</code> does not make deep copy, the string inside the array is still the same object.</p><p>If you need a deep copy of an object, you should use <code>deep_dup</code>. Here is an example:</p><div class="code_container">
<div><div id="highlighter_47647" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">array&nbsp;&nbsp;&nbsp;&nbsp; = [</code><code class="ruby string">'string'</code><code class="ruby plain">]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">duplicate = array.deep_dup</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby plain">duplicate.first.gsub!(</code><code class="ruby string">'string'</code><code class="ruby plain">, </code><code class="ruby string">'foo'</code><code class="ruby plain">)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby plain">array&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ['string']</code></div><div class="line number7 index6 alt2"><code class="ruby plain">duplicate </code><code class="ruby comments"># =&gt; ['foo']</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the object is not duplicable, <code>deep_dup</code> will just return it:</p><div class="code_container">
<div><div id="highlighter_261348" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">number = </code><code class="ruby constants">1</code></div><div class="line number2 index1 alt1"><code class="ruby plain">duplicate = number.deep_dup</code></div><div class="line number3 index2 alt2"><code class="ruby plain">number.object_id == duplicate.object_id&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p></div><h4 id="try">2.5 <code>try</code>
</h4><p>When you want to call a method on an object only if it is not <code>nil</code>, the simplest way to achieve it is with conditional statements, adding unnecessary clutter. The alternative is to use <code>try</code>. <code>try</code> is like <code>Object#send</code> except that it returns <code>nil</code> if sent to <code>nil</code>.</p><p>Here is an example:</p><div class="code_container">
<div><div id="highlighter_336965" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># without try</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">unless</code> <code class="ruby variable bold">@number</code><code class="ruby plain">.</code><code class="ruby keyword">nil</code><code class="ruby plain">?</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby variable bold">@number</code><code class="ruby plain">.</code><code class="ruby keyword">next</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby comments"># with try</code></div><div class="line number7 index6 alt2"><code class="ruby variable bold">@number</code><code class="ruby plain">.try(</code><code class="ruby color2">:next</code><code class="ruby plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Another example is this code from <code>ActiveRecord::ConnectionAdapters::AbstractAdapter</code> where <code>@logger</code> could be <code>nil</code>. You can see that the code uses <code>try</code> and avoids an unnecessary check.</p><div class="code_container">
<div><div id="highlighter_224740" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">log_info(sql, name, ms)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">if</code> <code class="ruby variable bold">@logger</code><code class="ruby plain">.try(</code><code class="ruby color2">:debug</code><code class="ruby plain">?)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">name = </code><code class="ruby string">'%s (%.1fms)'</code> <code class="ruby plain">% [name || </code><code class="ruby string">'SQL'</code><code class="ruby plain">, ms]</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby variable bold">@logger</code><code class="ruby plain">.debug(format_log_entry(name, sql.squeeze(</code><code class="ruby string">' '</code><code class="ruby plain">)))</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>try</code> can also be called without arguments but a block, which will only be executed if the object is not nil:</p><div class="code_container">
<div><div id="highlighter_41156" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby variable bold">@person</code><code class="ruby plain">.try { |p| </code><code class="ruby string">"#{p.first_name} #{p.last_name}"</code> <code class="ruby plain">}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/try.rb</code>.</p></div><h4 id="class-eval-args-block">2.6 <code>class_eval(*args, &amp;block)</code>
</h4><p>You can evaluate code in the context of any object's singleton class using <code>class_eval</code>:</p><div class="code_container">
<div><div id="highlighter_522973" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby color1">Proc</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">bind(object)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">block, time = </code><code class="ruby keyword">self</code><code class="ruby plain">, </code><code class="ruby color1">Time</code><code class="ruby plain">.current</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">object.class_eval </code><code class="ruby keyword">do</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">method_name = </code><code class="ruby string">"__bind_#{time.to_i}_#{time.usec}"</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">define_method</code><code class="ruby plain">(method_name, &amp;block)</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">method = instance_method(method_name)</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">remove_method(method_name)</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">method</code></div><div class="line number10 index9 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">end</code><code class="ruby plain">.bind(object)</code></div><div class="line number11 index10 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number12 index11 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/kernel/singleton_class.rb</code>.</p></div><h4 id="acts-like-questionmark-duck">2.7 <code>acts_like?(duck)</code>
</h4><p>The method <code>acts_like?</code> provides a way to check 
whether some class acts like some other class based on a simple 
convention: a class that provides the same interface as <code>String</code> defines</p><div class="code_container">
<div><div id="highlighter_218715" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">acts_like_string?</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>which is only a marker, its body or return value are irrelevant. Then, client code can query for duck-type-safeness this way:</p><div class="code_container">
<div><div id="highlighter_831478" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">some_klass.acts_like?(</code><code class="ruby color2">:string</code><code class="ruby plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Rails has classes that act like <code>Date</code> or <code>Time</code> and follow this contract.</p><div class="note"><p>Defined in <code>active_support/core_ext/object/acts_like.rb</code>.</p></div><h4 id="to-param">2.8 <code>to_param</code>
</h4><p>All objects in Rails respond to the method <code>to_param</code>, which is meant to return something that represents them as values in a query string, or as URL fragments.</p><p>By default <code>to_param</code> just calls <code>to_s</code>:</p><div class="code_container">
<div><div id="highlighter_77748" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">7</code><code class="ruby plain">.to_param </code><code class="ruby comments"># =&gt; "7"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The return value of <code>to_param</code> should <strong>not</strong> be escaped:</p><div class="code_container">
<div><div id="highlighter_522027" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Tom &amp; Jerry"</code><code class="ruby plain">.to_param </code><code class="ruby comments"># =&gt; "Tom &amp; Jerry"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Several classes in Rails overwrite this method.</p><p>For example <code>nil</code>, <code>true</code>, and <code>false</code> return themselves. <code>Array#to_param</code> calls <code>to_param</code> on the elements and joins the result with "/":</p><div class="code_container">
<div><div id="highlighter_99426" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">0</code><code class="ruby plain">, </code><code class="ruby keyword">true</code><code class="ruby plain">, </code><code class="ruby color1">String</code><code class="ruby plain">].to_param </code><code class="ruby comments"># =&gt; "0/true/String"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Notably, the Rails routing system calls <code>to_param</code> on models to get a value for the <code>:id</code> placeholder. <code>ActiveRecord::Base#to_param</code> returns the <code>id</code> of a model, but you can redefine that method in your models. For example, given</p><div class="code_container">
<div><div id="highlighter_198539" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">User</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">to_param</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby string">"#{id}-#{name.parameterize}"</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>we get:</p><div class="code_container">
<div><div id="highlighter_339337" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">user_path(</code><code class="ruby variable bold">@user</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "/users/357-john-smith"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>Controllers need to be aware of any redefinition of <code>to_param</code> because when a request like that comes in "357-john-smith" is the value of <code>params[:id]</code>.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/object/to_param.rb</code>.</p></div><h4 id="to-query">2.9 <code>to_query</code>
</h4><p>Except for hashes, given an unescaped <code>key</code> this method constructs the part of a query string that would map such key to what <code>to_param</code> returns. For example, given</p><div class="code_container">
<div><div id="highlighter_423375" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">User</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">to_param</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby string">"#{id}-#{name.parameterize}"</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>we get:</p><div class="code_container">
<div><div id="highlighter_262481" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">current_user.to_query(</code><code class="ruby string">'user'</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "user=357-john-smith"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method escapes whatever is needed, both for the key and the value:</p><div class="code_container">
<div><div id="highlighter_221466" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">account.to_query(</code><code class="ruby string">'company[name]'</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "company%5Bname%5D=Johnson+%26+Johnson"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>so its output is ready to be used in a query string.</p><p>Arrays return the result of applying <code>to_query</code> to each element with <code>_key_[]</code> as key, and join the result with "&amp;":</p><div class="code_container">
<div><div id="highlighter_811074" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">3</code><code class="ruby plain">.</code><code class="ruby constants">4</code><code class="ruby plain">, -</code><code class="ruby constants">45</code><code class="ruby plain">.</code><code class="ruby constants">6</code><code class="ruby plain">].to_query(</code><code class="ruby string">'sample'</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "sample%5B%5D=3.4&amp;sample%5B%5D=-45.6"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Hashes also respond to <code>to_query</code> but with a different signature. If no argument is passed a call generates a sorted series of key/value assignments calling <code>to_query(key)</code> on its values. Then it joins the result with "&amp;":</p><div class="code_container">
<div><div id="highlighter_77531" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{c: </code><code class="ruby constants">3</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">, a: </code><code class="ruby constants">1</code><code class="ruby plain">}.to_query </code><code class="ruby comments"># =&gt; "a=1&amp;b=2&amp;c=3"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>Hash#to_query</code> accepts an optional namespace for the keys:</p><div class="code_container">
<div><div id="highlighter_428389" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{id: </code><code class="ruby constants">89</code><code class="ruby plain">, name: </code><code class="ruby string">"John Smith"</code><code class="ruby plain">}.to_query(</code><code class="ruby string">'user'</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "user%5Bid%5D=89&amp;user%5Bname%5D=John+Smith"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/to_query.rb</code>.</p></div><h4 id="with-options">2.10 <code>with_options</code>
</h4><p>The method <code>with_options</code> provides a way to factor out common options in a series of method calls.</p><p>Given a default options hash, <code>with_options</code>
 yields a proxy object to a block. Within the block, methods called on 
the proxy are forwarded to the receiver with their options merged. For 
example, you get rid of the duplication in:</p><div class="code_container">
<div><div id="highlighter_402030" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">Account &lt; ActiveRecord::Base</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_many </code><code class="ruby color2">:customers</code><code class="ruby plain">, dependent: </code><code class="ruby color2">:destroy</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_many </code><code class="ruby color2">:products</code><code class="ruby plain">,&nbsp; dependent: </code><code class="ruby color2">:destroy</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_many </code><code class="ruby color2">:invoices</code><code class="ruby plain">,&nbsp; dependent: </code><code class="ruby color2">:destroy</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_many </code><code class="ruby color2">:expenses</code><code class="ruby plain">,&nbsp; dependent: </code><code class="ruby color2">:destroy</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>this way:</p><div class="code_container">
<div><div id="highlighter_592730" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">Account &lt; ActiveRecord::Base</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">with_options dependent: </code><code class="ruby color2">:destroy</code> <code class="ruby keyword">do</code> <code class="ruby plain">|assoc|</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">assoc.has_many </code><code class="ruby color2">:customers</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">assoc.has_many </code><code class="ruby color2">:products</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">assoc.has_many </code><code class="ruby color2">:invoices</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">assoc.has_many </code><code class="ruby color2">:expenses</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number8 index7 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>That idiom may convey <em>grouping</em> to the reader as well. For 
example, say you want to send a newsletter whose language depends on the
 user. Somewhere in the mailer you could group locale-dependent bits 
like this:</p><div class="code_container">
<div><div id="highlighter_561749" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">I18n.with_options locale: user.locale, scope: </code><code class="ruby string">"newsletter"</code> <code class="ruby keyword">do</code> <code class="ruby plain">|i18n|</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">subject i18n.t </code><code class="ruby color2">:subject</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">body&nbsp;&nbsp;&nbsp; i18n.t </code><code class="ruby color2">:body</code><code class="ruby plain">, user_name: user.name</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="info"><p>Since <code>with_options</code> forwards calls to its receiver they can be nested. Each nesting level will merge inherited defaults in addition to their own.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/object/with_options.rb</code>.</p></div><h4 id="json-support">2.11 JSON support</h4><p>Active Support provides a better implementation of <code>to_json</code> than the <code>json</code> gem ordinarily provides for Ruby objects. This is because some classes, like <code>Hash</code>, <code>OrderedHash</code> and <code>Process::Status</code> need special handling in order to provide a proper JSON representation.</p><div class="note"><p>Defined in <code>active_support/core_ext/object/json.rb</code>.</p></div><h4 id="instance-variables">2.12 Instance Variables</h4><p>Active Support provides several methods to ease access to instance variables.</p><h5 id="instance-values">2.12.1 <code>instance_values</code>
</h5><p>The method <code>instance_values</code> returns a hash that maps instance variable names without "@" to their
corresponding values. Keys are strings:</p><div class="code_container">
<div><div id="highlighter_944704" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">C</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">initialize(x, y)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby variable bold">@x</code><code class="ruby plain">, </code><code class="ruby variable bold">@y</code> <code class="ruby plain">= x, y</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby constants">C</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">0</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">).instance_values </code><code class="ruby comments"># =&gt; {"x" =&gt; 0, "y" =&gt; 1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/instance_variables.rb</code>.</p></div><h5 id="instance-variable-names">2.12.2 <code>instance_variable_names</code>
</h5><p>The method <code>instance_variable_names</code> returns an array.  Each name includes the "@" sign.</p><div class="code_container">
<div><div id="highlighter_669291" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">C</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">initialize(x, y)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby variable bold">@x</code><code class="ruby plain">, </code><code class="ruby variable bold">@y</code> <code class="ruby plain">= x, y</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby constants">C</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">0</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">).instance_variable_names </code><code class="ruby comments"># =&gt; ["@x", "@y"]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/instance_variables.rb</code>.</p></div><h4 id="silencing-warnings-and-exceptions">2.13 Silencing Warnings and Exceptions</h4><p>The methods <code>silence_warnings</code> and <code>enable_warnings</code> change the value of <code>$VERBOSE</code> accordingly for the duration of their block, and reset it afterwards:</p><div class="code_container">
<div><div id="highlighter_225641" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">silence_warnings { </code><code class="ruby color1">Object</code><code class="ruby plain">.const_set </code><code class="ruby string">"RAILS_DEFAULT_LOGGER"</code><code class="ruby plain">, logger }</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Silencing exceptions is also possible with <code>suppress</code>. 
This method receives an arbitrary number of exception classes. If an 
exception is raised during the execution of the block and is <code>kind_of?</code> any of the arguments, <code>suppress</code> captures it and returns silently. Otherwise the exception is not captured:</p><div class="code_container">
<div><div id="highlighter_160958" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># If the user is locked, the increment is lost, no big deal.</code></div><div class="line number2 index1 alt1"><code class="ruby plain">suppress(ActiveRecord::StaleObjectError) </code><code class="ruby keyword">do</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">current_user.increment! </code><code class="ruby color2">:visits</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/kernel/reporting.rb</code>.</p></div><h4 id="in-questionmark">2.14 <code>in?</code>
</h4><p>The predicate <code>in?</code> tests if an object is included in another object. An <code>ArgumentError</code> exception will be raised if the argument passed does not respond to <code>include?</code>.</p><p>Examples of <code>in?</code>:</p><div class="code_container">
<div><div id="highlighter_158016" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1</code><code class="ruby plain">.</code><code class="ruby keyword">in</code><code class="ruby plain">?([</code><code class="ruby constants">1</code><code class="ruby plain">,</code><code class="ruby constants">2</code><code class="ruby plain">])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby string">"lo"</code><code class="ruby plain">.</code><code class="ruby keyword">in</code><code class="ruby plain">?(</code><code class="ruby string">"hello"</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number3 index2 alt2"><code class="ruby constants">25</code><code class="ruby plain">.</code><code class="ruby keyword">in</code><code class="ruby plain">?(</code><code class="ruby constants">30</code><code class="ruby plain">..</code><code class="ruby constants">50</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number4 index3 alt1"><code class="ruby constants">1</code><code class="ruby plain">.</code><code class="ruby keyword">in</code><code class="ruby plain">?(</code><code class="ruby constants">1</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ArgumentError</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/inclusion.rb</code>.</p></div><h3 id="extensions-to-module">3 Extensions to <code>Module</code>
</h3><h4 id="alias-method-chain">3.1 <code>alias_method_chain</code>
</h4><p><strong>This method is deprecated in favour of using Module#prepend.</strong></p><p>Using plain Ruby you can wrap methods with other methods, that's called <em>alias chaining</em>.</p><p>For
 example, let's say you'd like params to be strings in functional tests,
 as they are in real requests, but still want the convenience of 
assigning integers and other kind of values. To accomplish that you 
could wrap <code>ActionController::TestCase#process</code> this way in <code>test/test_helper.rb</code>:</p><div class="code_container">
<div><div id="highlighter_414087" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">ActionController::TestCase.class_eval </code><code class="ruby keyword">do</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby comments"># save a reference to the original process method</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">alias_method </code><code class="ruby color2">:original_process</code><code class="ruby plain">, </code><code class="ruby color2">:process</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby comments"># now redefine process and delegate to original_process</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">process(action, params=</code><code class="ruby keyword">nil</code><code class="ruby plain">, session=</code><code class="ruby keyword">nil</code><code class="ruby plain">, flash=</code><code class="ruby keyword">nil</code><code class="ruby plain">, http_method=</code><code class="ruby string">'GET'</code><code class="ruby plain">)</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">params = </code><code class="ruby color1">Hash</code><code class="ruby plain">[*params.map {|k, v| [k, v.to_s]}.flatten]</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">original_process(action, params, session, flash, http_method)</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number10 index9 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>That's the method <code>get</code>, <code>post</code>, etc., delegate the work to.</p><p>That technique has a risk, it could be the case that <code>:original_process</code> was taken. To try to avoid collisions people choose some label that characterizes what the chaining is about:</p><div class="code_container">
<div><div id="highlighter_778633" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">ActionController::TestCase.class_eval </code><code class="ruby keyword">do</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">process_with_stringified_params(...)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">params = </code><code class="ruby color1">Hash</code><code class="ruby plain">[*params.map {|k, v| [k, v.to_s]}.flatten]</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">process_without_stringified_params(action, params, session, flash, http_method)</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">alias_method </code><code class="ruby color2">:process_without_stringified_params</code><code class="ruby plain">, </code><code class="ruby color2">:process</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">alias_method </code><code class="ruby color2">:process</code><code class="ruby plain">, </code><code class="ruby color2">:process_with_stringified_params</code></div><div class="line number8 index7 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>alias_method_chain</code> provides a shortcut for that pattern:</p><div class="code_container">
<div><div id="highlighter_52720" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">ActionController::TestCase.class_eval </code><code class="ruby keyword">do</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">process_with_stringified_params(...)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">params = </code><code class="ruby color1">Hash</code><code class="ruby plain">[*params.map {|k, v| [k, v.to_s]}.flatten]</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">process_without_stringified_params(action, params, session, flash, http_method)</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">alias_method_chain </code><code class="ruby color2">:process</code><code class="ruby plain">, </code><code class="ruby color2">:stringified_params</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/module/aliasing.rb</code>.</p></div><h4 id="attributes">3.2 Attributes</h4><h5 id="alias-attribute">3.2.1 <code>alias_attribute</code>
</h5><p>Model attributes have a reader, a writer, and a predicate. You 
can alias a model attribute having the corresponding three methods 
defined for you in one shot. As in other aliasing methods, the new name 
is the first argument, and the old name is the second (one mnemonic is 
that they go in the same order as if you did an assignment):</p><div class="code_container">
<div><div id="highlighter_36151" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">User &lt; ActiveRecord::Base</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby comments"># You can refer to the email column as "login".</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby comments"># This can be meaningful for authentication code.</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">alias_attribute </code><code class="ruby color2">:login</code><code class="ruby plain">, </code><code class="ruby color2">:email</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/module/aliasing.rb</code>.</p></div><h5 id="internal-attributes">3.2.2 Internal Attributes</h5><p>When
 you are defining an attribute in a class that is meant to be 
subclassed, name collisions are a risk. That's remarkably important for 
libraries.</p><p>Active Support defines the macros <code>attr_internal_reader</code>, <code>attr_internal_writer</code>, and <code>attr_internal_accessor</code>. They behave like their Ruby built-in <code>attr_*</code> counterparts, except they name the underlying instance variable in a way that makes collisions less likely.</p><p>The macro <code>attr_internal</code> is a synonym for <code>attr_internal_accessor</code>:</p><div class="code_container">
<div><div id="highlighter_345361" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># library</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">class</code> <code class="ruby plain">ThirdPartyLibrary::Crawler</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">attr_internal </code><code class="ruby color2">:log_level</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby comments"># client code</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">MyCrawler &lt; ThirdPartyLibrary::Crawler</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">attr_accessor </code><code class="ruby color2">:log_level</code></div><div class="line number9 index8 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In the previous example it could be the case that <code>:log_level</code>
 does not belong to the public interface of the library and it is only 
used for development. The client code, unaware of the potential 
conflict, subclasses and defines its own <code>:log_level</code>. Thanks to <code>attr_internal</code> there's no collision.</p><p>By default the internal instance variable is named with a leading underscore, <code>@_log_level</code> in the example above. That's configurable via <code>Module.attr_internal_naming_format</code> though, you can pass any <code>sprintf</code>-like format string with a leading <code>@</code> and a <code>%s</code> somewhere, which is where the name will be placed. The default is <code>"@_%s"</code>.</p><p>Rails uses internal attributes in a few spots, for examples for views:</p><div class="code_container">
<div><div id="highlighter_156102" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby plain">ActionView</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">class</code> <code class="ruby plain">Base</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">attr_internal </code><code class="ruby color2">:captures</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">attr_internal </code><code class="ruby color2">:request</code><code class="ruby plain">, </code><code class="ruby color2">:layout</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">attr_internal </code><code class="ruby color2">:controller</code><code class="ruby plain">, </code><code class="ruby color2">:template</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/module/attr_internal.rb</code>.</p></div><h5 id="module-attributes">3.2.3 Module Attributes</h5><p>The macros <code>mattr_reader</code>, <code>mattr_writer</code>, and <code>mattr_accessor</code> are the same as the <code>cattr_*</code> macros defined for class. In fact, the <code>cattr_*</code> macros are just aliases for the <code>mattr_*</code> macros. Check <a href="#class-attributes">Class Attributes</a>.</p><p>For example, the dependencies mechanism uses them:</p><div class="code_container">
<div><div id="highlighter_31721" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby plain">ActiveSupport</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby plain">Dependencies</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:warnings_on_first_load</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:history</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:loaded</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:mechanism</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:load_paths</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:load_once_paths</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:autoloaded_constants</code></div><div class="line number10 index9 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:explicitly_unloadable_constants</code></div><div class="line number11 index10 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:logger</code></div><div class="line number12 index11 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:log_activity</code></div><div class="line number13 index12 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:constant_watch_stack</code></div><div class="line number14 index13 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">mattr_accessor </code><code class="ruby color2">:constant_watch_stack_mutex</code></div><div class="line number15 index14 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number16 index15 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/module/attribute_accessors.rb</code>.</p></div><h4 id="extensions-to-module-parents">3.3 Parents</h4><h5 id="parent">3.3.1 <code>parent</code>
</h5><p>The <code>parent</code> method on a nested named module returns the module that contains its corresponding constant:</p><div class="code_container">
<div><div id="highlighter_94081" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">X</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Y</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Z</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div><div class="line number7 index6 alt2"><code class="ruby constants">M</code> <code class="ruby plain">= </code><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">::</code><code class="ruby constants">Z</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">::</code><code class="ruby constants">Z</code><code class="ruby plain">.parent </code><code class="ruby comments"># =&gt; X::Y</code></div><div class="line number10 index9 alt1"><code class="ruby constants">M</code><code class="ruby plain">.parent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; X::Y</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the module is anonymous or belongs to the top-level, <code>parent</code> returns <code>Object</code>.</p><div class="warning"><p>Note that in that case <code>parent_name</code> returns <code>nil</code>.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p></div><h5 id="parent-name">3.3.2 <code>parent_name</code>
</h5><p>The <code>parent_name</code> method on a nested named module returns the fully-qualified name of the module that contains its corresponding constant:</p><div class="code_container">
<div><div id="highlighter_738681" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">X</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Y</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Z</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div><div class="line number7 index6 alt2"><code class="ruby constants">M</code> <code class="ruby plain">= </code><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">::</code><code class="ruby constants">Z</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">::</code><code class="ruby constants">Z</code><code class="ruby plain">.parent_name </code><code class="ruby comments"># =&gt; "X::Y"</code></div><div class="line number10 index9 alt1"><code class="ruby constants">M</code><code class="ruby plain">.parent_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "X::Y"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>For top-level or anonymous modules <code>parent_name</code> returns <code>nil</code>.</p><div class="warning"><p>Note that in that case <code>parent</code> returns <code>Object</code>.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p></div><h5 id="extensions-to-module-parents-parents">3.3.3 <code>parents</code>
</h5><p>The method <code>parents</code> calls <code>parent</code> on the receiver and upwards until <code>Object</code> is reached. The chain is returned in an array, from bottom to top:</p><div class="code_container">
<div><div id="highlighter_592395" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">X</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Y</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Z</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div><div class="line number7 index6 alt2"><code class="ruby constants">M</code> <code class="ruby plain">= </code><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">::</code><code class="ruby constants">Z</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">::</code><code class="ruby constants">Z</code><code class="ruby plain">.parents </code><code class="ruby comments"># =&gt; [X::Y, X, Object]</code></div><div class="line number10 index9 alt1"><code class="ruby constants">M</code><code class="ruby plain">.parents&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [X::Y, X, Object]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p></div><h4 id="constants">3.4 Constants</h4><p>The method <code>local_constants</code> returns the names of the constants that have been
defined in the receiver module:</p><div class="code_container">
<div><div id="highlighter_711772" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">X</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">X1</code> <code class="ruby plain">= </code><code class="ruby constants">1</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">X2</code> <code class="ruby plain">= </code><code class="ruby constants">2</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">module</code> <code class="ruby constants">Y</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby constants">Y1</code> <code class="ruby plain">= </code><code class="ruby color2">:y1</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby constants">X1</code> <code class="ruby plain">= </code><code class="ruby color2">:overrides_X1_above</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number8 index7 alt1"><code class="ruby keyword">end</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="ruby constants">X</code><code class="ruby plain">.local_constants&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [:X1, :X2, :Y]</code></div><div class="line number11 index10 alt2"><code class="ruby constants">X</code><code class="ruby plain">::</code><code class="ruby constants">Y</code><code class="ruby plain">.local_constants </code><code class="ruby comments"># =&gt; [:Y1, :X1]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The names are returned as symbols.</p><div class="note"><p>Defined in <code>active_support/core_ext/module/introspection.rb</code>.</p></div><h5 id="qualified-constant-names">3.4.1 Qualified Constant Names</h5><p>The standard methods <code>const_defined?</code>, <code>const_get</code>, and <code>const_set</code> accept
bare constant names. Active Support extends this API to be able to pass
relative qualified constant names.</p><p>The new methods are <code>qualified_const_defined?</code>, <code>qualified_const_get</code>, and
<code>qualified_const_set</code>. Their arguments are assumed to be qualified constant
names relative to their receiver:</p><div class="code_container">
<div><div id="highlighter_943658" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Object</code><code class="ruby plain">.qualified_const_defined?(</code><code class="ruby string">"Math::PI"</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby color1">Object</code><code class="ruby plain">.qualified_const_get(</code><code class="ruby string">"Math::PI"</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 3.141592653589793</code></div><div class="line number3 index2 alt2"><code class="ruby color1">Object</code><code class="ruby plain">.qualified_const_set(</code><code class="ruby string">"Math::Phi"</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">.</code><code class="ruby constants">618034</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; 1.618034</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Arguments may be bare constant names:</p><div class="code_container">
<div><div id="highlighter_140458" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Math.qualified_const_get(</code><code class="ruby string">"E"</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; 2.718281828459045</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>These methods are analogous to their built-in counterparts. In particular,
<code>qualified_constant_defined?</code> accepts an optional second argument to be
able to say whether you want the predicate to look in the ancestors.
This flag is taken into account for each constant in the expression while
walking down the path.</p><p>For example, given</p><div class="code_container">
<div><div id="highlighter_578848" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">X</code> <code class="ruby plain">= </code><code class="ruby constants">1</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">N</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">class</code> <code class="ruby constants">C</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">include </code><code class="ruby constants">M</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number9 index8 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>qualified_const_defined?</code> behaves this way:</p><div class="code_container">
<div><div id="highlighter_777169" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">N</code><code class="ruby plain">.qualified_const_defined?(</code><code class="ruby string">"C::X"</code><code class="ruby plain">, </code><code class="ruby keyword">false</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; false</code></div><div class="line number2 index1 alt1"><code class="ruby constants">N</code><code class="ruby plain">.qualified_const_defined?(</code><code class="ruby string">"C::X"</code><code class="ruby plain">, </code><code class="ruby keyword">true</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number3 index2 alt2"><code class="ruby constants">N</code><code class="ruby plain">.qualified_const_defined?(</code><code class="ruby string">"C::X"</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As the last example implies, the second argument defaults to true,
as in <code>const_defined?</code>.</p><p>For coherence with the built-in methods only relative paths are accepted.
Absolute qualified constant names like <code>::Math::PI</code> raise <code>NameError</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/module/qualified_const.rb</code>.</p></div><h4 id="reachable">3.5 Reachable</h4><p>A
 named module is reachable if it is stored in its corresponding 
constant. It means you can reach the module object via the constant.</p><p>That is what ordinarily happens, if a module is called "M", the <code>M</code> constant exists and holds it:</p><div class="code_container">
<div><div id="highlighter_335091" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">end</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby constants">M</code><code class="ruby plain">.reachable? </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>But since constants and modules are indeed kind of decoupled, module objects can become unreachable:</p><div class="code_container">
<div><div id="highlighter_615786" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">end</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby plain">orphan = </code><code class="ruby color1">Object</code><code class="ruby plain">.send(</code><code class="ruby color2">:remove_const</code><code class="ruby plain">, :</code><code class="ruby constants">M</code><code class="ruby plain">)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby comments"># The module object is orphan now but it still has a name.</code></div><div class="line number7 index6 alt2"><code class="ruby plain">orphan.name </code><code class="ruby comments"># =&gt; "M"</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="ruby comments"># You cannot reach it via the constant M because it does not even exist.</code></div><div class="line number10 index9 alt1"><code class="ruby plain">orphan.reachable? </code><code class="ruby comments"># =&gt; false</code></div><div class="line number11 index10 alt2">&nbsp;</div><div class="line number12 index11 alt1"><code class="ruby comments"># Let's define a module called "M" again.</code></div><div class="line number13 index12 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number14 index13 alt1"><code class="ruby keyword">end</code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="ruby comments"># The constant M exists now again, and it stores a module</code></div><div class="line number17 index16 alt2"><code class="ruby comments"># object called "M", but it is a new instance.</code></div><div class="line number18 index17 alt1"><code class="ruby plain">orphan.reachable? </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/module/reachable.rb</code>.</p></div><h4 id="anonymous">3.6 Anonymous</h4><p>A module may or may not have a name:</p><div class="code_container">
<div><div id="highlighter_533335" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">end</code></div><div class="line number3 index2 alt2"><code class="ruby constants">M</code><code class="ruby plain">.name </code><code class="ruby comments"># =&gt; "M"</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby constants">N</code> <code class="ruby plain">= </code><code class="ruby color1">Module</code><code class="ruby plain">.</code><code class="ruby keyword">new</code></div><div class="line number6 index5 alt1"><code class="ruby constants">N</code><code class="ruby plain">.name </code><code class="ruby comments"># =&gt; "N"</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="ruby color1">Module</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">.name </code><code class="ruby comments"># =&gt; nil</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>You can check whether a module has a name with the predicate <code>anonymous?</code>:</p><div class="code_container">
<div><div id="highlighter_20229" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">end</code></div><div class="line number3 index2 alt2"><code class="ruby constants">M</code><code class="ruby plain">.anonymous? </code><code class="ruby comments"># =&gt; false</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby color1">Module</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">.anonymous? </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Note that being unreachable does not imply being anonymous:</p><div class="code_container">
<div><div id="highlighter_387251" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">end</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby plain">m = </code><code class="ruby color1">Object</code><code class="ruby plain">.send(</code><code class="ruby color2">:remove_const</code><code class="ruby plain">, :</code><code class="ruby constants">M</code><code class="ruby plain">)</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby plain">m.reachable? </code><code class="ruby comments"># =&gt; false</code></div><div class="line number7 index6 alt2"><code class="ruby plain">m.anonymous? </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>though an anonymous module is unreachable by definition.</p><div class="note"><p>Defined in <code>active_support/core_ext/module/anonymous.rb</code>.</p></div><h4 id="method-delegation">3.7 Method Delegation</h4><p>The macro <code>delegate</code> offers an easy way to forward methods.</p><p>Let's imagine that users in some application have login information in the <code>User</code> model but name and other data in a separate <code>Profile</code> model:</p><div class="code_container">
<div><div id="highlighter_183472" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">User &lt; ActiveRecord::Base</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_one </code><code class="ruby color2">:profile</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>With that configuration you get a user's name via their profile, <code>user.profile.name</code>, but it could be handy to still be able to access such attribute directly:</p><div class="code_container">
<div><div id="highlighter_366900" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">User &lt; ActiveRecord::Base</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_one </code><code class="ruby color2">:profile</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">name</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">profile.name</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>That is what <code>delegate</code> does for you:</p><div class="code_container">
<div><div id="highlighter_98156" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">User &lt; ActiveRecord::Base</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">has_one </code><code class="ruby color2">:profile</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">delegate </code><code class="ruby color2">:name</code><code class="ruby plain">, to: </code><code class="ruby color2">:profile</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>It is shorter, and the intention more obvious.</p><p>The method must be public in the target.</p><p>The <code>delegate</code> macro accepts several methods:</p><div class="code_container">
<div><div id="highlighter_814185" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">delegate </code><code class="ruby color2">:name</code><code class="ruby plain">, </code><code class="ruby color2">:age</code><code class="ruby plain">, </code><code class="ruby color2">:address</code><code class="ruby plain">, </code><code class="ruby color2">:twitter</code><code class="ruby plain">, to: </code><code class="ruby color2">:profile</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>When interpolated into a string, the <code>:to</code> option should 
become an expression that evaluates to the object the method is 
delegated to. Typically a string or symbol. Such an expression is 
evaluated in the context of the receiver:</p><div class="code_container">
<div><div id="highlighter_168788" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># delegates to the Rails constant</code></div><div class="line number2 index1 alt1"><code class="ruby plain">delegate </code><code class="ruby color2">:logger</code><code class="ruby plain">, to: :Rails</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby comments"># delegates to the receiver's class</code></div><div class="line number5 index4 alt2"><code class="ruby plain">delegate </code><code class="ruby color2">:table_name</code><code class="ruby plain">, to: </code><code class="ruby color2">:class</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>If the <code>:prefix</code> option is <code>true</code> this is less generic, see below.</p></div><p>By default, if the delegation raises <code>NoMethodError</code> and the target is <code>nil</code> the exception is propagated. You can ask that <code>nil</code> is returned instead with the <code>:allow_nil</code> option:</p><div class="code_container">
<div><div id="highlighter_728016" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">delegate </code><code class="ruby color2">:name</code><code class="ruby plain">, to: </code><code class="ruby color2">:profile</code><code class="ruby plain">, allow_nil: </code><code class="ruby keyword">true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>With <code>:allow_nil</code> the call <code>user.name</code> returns <code>nil</code> if the user has no profile.</p><p>The option <code>:prefix</code> adds a prefix to the name of the generated method. This may be handy for example to get a better name:</p><div class="code_container">
<div><div id="highlighter_169895" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">delegate </code><code class="ruby color2">:street</code><code class="ruby plain">, to: </code><code class="ruby color2">:address</code><code class="ruby plain">, prefix: </code><code class="ruby keyword">true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The previous example generates <code>address_street</code> rather than <code>street</code>.</p><div class="warning"><p>Since in this case the name of the generated method is composed of the target object and target method names, the <code>:to</code> option must be a method name.</p></div><p>A custom prefix may also be configured:</p><div class="code_container">
<div><div id="highlighter_346852" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">delegate </code><code class="ruby color2">:size</code><code class="ruby plain">, to: </code><code class="ruby color2">:attachment</code><code class="ruby plain">, prefix: </code><code class="ruby color2">:avatar</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In the previous example the macro generates <code>avatar_size</code> rather than <code>size</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/module/delegation.rb</code></p></div><h4 id="redefining-methods">3.8 Redefining Methods</h4><p>There are cases where you need to define a method with <code>define_method</code>,
 but don't know whether a method with that name already exists. If it 
does, a warning is issued if they are enabled. No big deal, but not 
clean either.</p><p>The method <code>redefine_method</code> prevents such a potential warning, removing the existing method before if needed.</p><div class="note"><p>Defined in <code>active_support/core_ext/module/remove_method.rb</code></p></div><h3 id="extensions-to-class">4 Extensions to <code>Class</code>
</h3><h4 id="class-attributes">4.1 Class Attributes</h4><h5 id="class-attribute">4.1.1 <code>class_attribute</code>
</h5><p>The method <code>class_attribute</code> declares one or more inheritable class attributes that can be overridden at any level down the hierarchy.</p><div class="code_container">
<div><div id="highlighter_822570" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">A</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">class_attribute </code><code class="ruby color2">:x</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">B</code> <code class="ruby plain">&lt; </code><code class="ruby constants">A</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">C</code> <code class="ruby plain">&lt; </code><code class="ruby constants">B</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="ruby constants">A</code><code class="ruby plain">.x = </code><code class="ruby color2">:a</code></div><div class="line number10 index9 alt1"><code class="ruby constants">B</code><code class="ruby plain">.x </code><code class="ruby comments"># =&gt; :a</code></div><div class="line number11 index10 alt2"><code class="ruby constants">C</code><code class="ruby plain">.x </code><code class="ruby comments"># =&gt; :a</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="ruby constants">B</code><code class="ruby plain">.x = </code><code class="ruby color2">:b</code></div><div class="line number14 index13 alt1"><code class="ruby constants">A</code><code class="ruby plain">.x </code><code class="ruby comments"># =&gt; :a</code></div><div class="line number15 index14 alt2"><code class="ruby constants">C</code><code class="ruby plain">.x </code><code class="ruby comments"># =&gt; :b</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="ruby constants">C</code><code class="ruby plain">.x = </code><code class="ruby color2">:c</code></div><div class="line number18 index17 alt1"><code class="ruby constants">A</code><code class="ruby plain">.x </code><code class="ruby comments"># =&gt; :a</code></div><div class="line number19 index18 alt2"><code class="ruby constants">B</code><code class="ruby plain">.x </code><code class="ruby comments"># =&gt; :b</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>For example <code>ActionMailer::Base</code> defines:</p><div class="code_container">
<div><div id="highlighter_112245" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">class_attribute </code><code class="ruby color2">:default_params</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">self</code><code class="ruby plain">.default_params = {</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">mime_version: </code><code class="ruby string">"1.0"</code><code class="ruby plain">,</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">charset: </code><code class="ruby string">"UTF-8"</code><code class="ruby plain">,</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">content_type: </code><code class="ruby string">"text/plain"</code><code class="ruby plain">,</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">parts_order: [ </code><code class="ruby string">"text/plain"</code><code class="ruby plain">, </code><code class="ruby string">"text/enriched"</code><code class="ruby plain">, </code><code class="ruby string">"text/html"</code> <code class="ruby plain">]</code></div><div class="line number7 index6 alt2"><code class="ruby plain">}.freeze</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They can also be accessed and overridden at the instance level.</p><div class="code_container">
<div><div id="highlighter_832463" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">A</code><code class="ruby plain">.x = </code><code class="ruby constants">1</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="ruby plain">a1 = </code><code class="ruby constants">A</code><code class="ruby plain">.</code><code class="ruby keyword">new</code></div><div class="line number4 index3 alt1"><code class="ruby plain">a2 = </code><code class="ruby constants">A</code><code class="ruby plain">.</code><code class="ruby keyword">new</code></div><div class="line number5 index4 alt2"><code class="ruby plain">a2.x = </code><code class="ruby constants">2</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby plain">a1.x </code><code class="ruby comments"># =&gt; 1, comes from A</code></div><div class="line number8 index7 alt1"><code class="ruby plain">a2.x </code><code class="ruby comments"># =&gt; 2, overridden in a2</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The generation of the writer instance method can be prevented by setting the option <code>:instance_writer</code> to <code>false</code>.</p><div class="code_container">
<div><div id="highlighter_221944" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby plain">ActiveRecord</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">class</code> <code class="ruby plain">Base</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">class_attribute </code><code class="ruby color2">:table_name_prefix</code><code class="ruby plain">, instance_writer: </code><code class="ruby keyword">false</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">self</code><code class="ruby plain">.table_name_prefix = </code><code class="ruby string">""</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>A model may find that option useful as a way to prevent mass-assignment from setting the attribute.</p><p>The generation of the reader instance method can be prevented by setting the option <code>:instance_reader</code> to <code>false</code>.</p><div class="code_container">
<div><div id="highlighter_704774" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">A</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">class_attribute </code><code class="ruby color2">:x</code><code class="ruby plain">, instance_reader: </code><code class="ruby keyword">false</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby constants">A</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">.x = </code><code class="ruby constants">1</code> <code class="ruby comments"># NoMethodError</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>For convenience <code>class_attribute</code> also defines an instance
 predicate which is the double negation of what the instance reader 
returns. In the examples above it would be called <code>x?</code>.</p><p>When <code>:instance_reader</code> is <code>false</code>, the instance predicate returns a <code>NoMethodError</code> just like the reader method.</p><p>If you do not want the instance predicate, pass <code>instance_predicate: false</code> and it will not be defined.</p><div class="note"><p>Defined in <code>active_support/core_ext/class/attribute.rb</code></p></div><h5 id="cattr-reader-cattr-writer-and-cattr-accessor">4.1.2 <code>cattr_reader</code>, <code>cattr_writer</code>, and <code>cattr_accessor</code>
</h5><p>The macros <code>cattr_reader</code>, <code>cattr_writer</code>, and <code>cattr_accessor</code> are analogous to their <code>attr_*</code> counterparts but for classes. They initialize a class variable to <code>nil</code> unless it already exists, and generate the corresponding class methods to access it:</p><div class="code_container">
<div><div id="highlighter_213555" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">MysqlAdapter &lt; AbstractAdapter</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby comments"># Generates class methods to access @@emulate_booleans.</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">cattr_accessor </code><code class="ruby color2">:emulate_booleans</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">self</code><code class="ruby plain">.emulate_booleans = </code><code class="ruby keyword">true</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Instance methods are created as well for convenience, they are just 
proxies to the class attribute. So, instances can change the class 
attribute, but cannot override it as it happens with <code>class_attribute</code> (see above). For example given</p><div class="code_container">
<div><div id="highlighter_66235" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby plain">ActionView</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">class</code> <code class="ruby plain">Base</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">cattr_accessor </code><code class="ruby color2">:field_error_proc</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby variable bold">@@field_error_proc</code> <code class="ruby plain">= </code><code class="ruby color1">Proc</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">{ ... }</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>we can access <code>field_error_proc</code> in views.</p><p>Also, you can pass a block to <code>cattr_*</code> to set up the attribute with a default value:</p><div class="code_container">
<div><div id="highlighter_563737" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby plain">MysqlAdapter &lt; AbstractAdapter</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby comments"># Generates class methods to access @@emulate_booleans with default value of true.</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">cattr_accessor(</code><code class="ruby color2">:emulate_booleans</code><code class="ruby plain">) { </code><code class="ruby keyword">true</code> <code class="ruby plain">}</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The generation of the reader instance method can be prevented by setting <code>:instance_reader</code> to <code>false</code> and the generation of the writer instance method can be prevented by setting <code>:instance_writer</code> to <code>false</code>. Generation of both methods can be prevented by setting <code>:instance_accessor</code> to <code>false</code>. In all cases, the value must be exactly <code>false</code> and not any false value.</p><div class="code_container">
<div><div id="highlighter_11212" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">A</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">class</code> <code class="ruby constants">B</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby comments"># No first_name instance reader is generated.</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">cattr_accessor </code><code class="ruby color2">:first_name</code><code class="ruby plain">, instance_reader: </code><code class="ruby keyword">false</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby comments"># No last_name= instance writer is generated.</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">cattr_accessor </code><code class="ruby color2">:last_name</code><code class="ruby plain">, instance_writer: </code><code class="ruby keyword">false</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby comments"># No surname instance reader or surname= writer is generated.</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">cattr_accessor </code><code class="ruby color2">:surname</code><code class="ruby plain">, instance_accessor: </code><code class="ruby keyword">false</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number10 index9 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>A model may find it useful to set <code>:instance_accessor</code> to <code>false</code> as a way to prevent mass-assignment from setting the attribute.</p><div class="note"><p>Defined in <code>active_support/core_ext/module/attribute_accessors.rb</code>.</p></div><h4 id="subclasses-descendants">4.2 Subclasses &amp; Descendants</h4><h5 id="subclasses">4.2.1 <code>subclasses</code>
</h5><p>The <code>subclasses</code> method returns the subclasses of the receiver:</p><div class="code_container">
<div><div id="highlighter_863270" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">C</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number2 index1 alt1"><code class="ruby constants">C</code><code class="ruby plain">.subclasses </code><code class="ruby comments"># =&gt; []</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby keyword">class</code> <code class="ruby constants">B</code> <code class="ruby plain">&lt; </code><code class="ruby constants">C</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby constants">C</code><code class="ruby plain">.subclasses </code><code class="ruby comments"># =&gt; [B]</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">A</code> <code class="ruby plain">&lt; </code><code class="ruby constants">B</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number8 index7 alt1"><code class="ruby constants">C</code><code class="ruby plain">.subclasses </code><code class="ruby comments"># =&gt; [B]</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="ruby keyword">class</code> <code class="ruby constants">D</code> <code class="ruby plain">&lt; </code><code class="ruby constants">C</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number11 index10 alt2"><code class="ruby constants">C</code><code class="ruby plain">.subclasses </code><code class="ruby comments"># =&gt; [B, D]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The order in which these classes are returned is unspecified.</p><div class="note"><p>Defined in <code>active_support/core_ext/class/subclasses.rb</code>.</p></div><h5 id="descendants">4.2.2 <code>descendants</code>
</h5><p>The <code>descendants</code> method returns all classes that are <code>&lt;</code> than its receiver:</p><div class="code_container">
<div><div id="highlighter_219986" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">C</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number2 index1 alt1"><code class="ruby constants">C</code><code class="ruby plain">.descendants </code><code class="ruby comments"># =&gt; []</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby keyword">class</code> <code class="ruby constants">B</code> <code class="ruby plain">&lt; </code><code class="ruby constants">C</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby constants">C</code><code class="ruby plain">.descendants </code><code class="ruby comments"># =&gt; [B]</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby keyword">class</code> <code class="ruby constants">A</code> <code class="ruby plain">&lt; </code><code class="ruby constants">B</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number8 index7 alt1"><code class="ruby constants">C</code><code class="ruby plain">.descendants </code><code class="ruby comments"># =&gt; [B, A]</code></div><div class="line number9 index8 alt2">&nbsp;</div><div class="line number10 index9 alt1"><code class="ruby keyword">class</code> <code class="ruby constants">D</code> <code class="ruby plain">&lt; </code><code class="ruby constants">C</code><code class="ruby plain">; </code><code class="ruby keyword">end</code></div><div class="line number11 index10 alt2"><code class="ruby constants">C</code><code class="ruby plain">.descendants </code><code class="ruby comments"># =&gt; [B, A, D]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The order in which these classes are returned is unspecified.</p><div class="note"><p>Defined in <code>active_support/core_ext/class/subclasses.rb</code>.</p></div><h3 id="extensions-to-string">5 Extensions to <code>String</code>
</h3><h4 id="output-safety">5.1 Output Safety</h4><h5 id="motivation">5.1.1 Motivation</h5><p>Inserting data into HTML templates needs extra care. For example, you can't just interpolate <code>@review.title</code>
 verbatim into an HTML page. For one thing, if the review title is 
"Flanagan &amp; Matz rules!" the output won't be well-formed because an 
ampersand has to be escaped as "&amp;amp;". What's more, depending on 
the application, that may be a big security hole because users can 
inject malicious HTML setting a hand-crafted review title. Check out the
 section about cross-site scripting in the <a href="http://edgeguides.rubyonrails.org/security.html#cross-site-scripting-xss">Security guide</a> for further information about the risks.</p><h5 id="safe-strings">5.1.2 Safe Strings</h5><p>Active Support has the concept of <em>(html) safe</em>
 strings. A safe string is one that is marked as being insertable into 
HTML as is. It is trusted, no matter whether it has been escaped or not.</p><p>Strings are considered to be <em>unsafe</em> by default:</p><div class="code_container">
<div><div id="highlighter_720288" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">""</code><code class="ruby plain">.html_safe? </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>You can obtain a safe string from a given one with the <code>html_safe</code> method:</p><div class="code_container">
<div><div id="highlighter_234126" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">s = </code><code class="ruby string">""</code><code class="ruby plain">.html_safe</code></div><div class="line number2 index1 alt1"><code class="ruby plain">s.html_safe? </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>It is important to understand that <code>html_safe</code> performs no escaping whatsoever, it is just an assertion:</p><div class="code_container">
<div><div id="highlighter_653602" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">s = </code><code class="ruby string">"&lt;script&gt;...&lt;/script&gt;"</code><code class="ruby plain">.html_safe</code></div><div class="line number2 index1 alt1"><code class="ruby plain">s.html_safe? </code><code class="ruby comments"># =&gt; true</code></div><div class="line number3 index2 alt2"><code class="ruby plain">s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "&lt;script&gt;...&lt;/script&gt;"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>It is your responsibility to ensure calling <code>html_safe</code> on a particular string is fine.</p><p>If you append onto a safe string, either in-place with <code>concat</code>/<code>&lt;&lt;</code>, or with <code>+</code>, the result is a safe string. Unsafe arguments are escaped:</p><div class="code_container">
<div><div id="highlighter_419033" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">""</code><code class="ruby plain">.html_safe + </code><code class="ruby string">"&lt;"</code> <code class="ruby comments"># =&gt; "&amp;lt;"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Safe arguments are directly appended:</p><div class="code_container">
<div><div id="highlighter_131900" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">""</code><code class="ruby plain">.html_safe + </code><code class="ruby string">"&lt;"</code><code class="ruby plain">.html_safe </code><code class="ruby comments"># =&gt; "&lt;"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>These methods should not be used in ordinary views. Unsafe values are automatically escaped:</p><div class="code_container">
<div><div id="highlighter_290427" class="syntaxhighlighter nogutter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby script">&lt;%=</code> <code class="ruby variable bold">@review</code><code class="ruby plain">.title </code><code class="ruby script">%&gt;</code> <code class="ruby script">&lt;%</code><code class="ruby comments"># fine, escaped if needed </code><code class="ruby script">%&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>To insert something verbatim use the <code>raw</code> helper rather than calling <code>html_safe</code>:</p><div class="code_container">
<div><div id="highlighter_874956" class="syntaxhighlighter nogutter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby script">&lt;%=</code> <code class="ruby plain">raw </code><code class="ruby variable bold">@cms</code><code class="ruby plain">.current_template </code><code class="ruby script">%&gt;</code> <code class="ruby script">&lt;%</code><code class="ruby comments"># inserts @cms.current_template as is </code><code class="ruby script">%&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>or, equivalently, use <code>&lt;%==</code>:</p><div class="code_container">
<div><div id="highlighter_163578" class="syntaxhighlighter nogutter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby script">&lt;%=</code><code class="ruby plain">= </code><code class="ruby variable bold">@cms</code><code class="ruby plain">.current_template </code><code class="ruby script">%&gt;</code> <code class="ruby script">&lt;%</code><code class="ruby comments"># inserts @cms.current_template as is </code><code class="ruby script">%&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The <code>raw</code> helper calls <code>html_safe</code> for you:</p><div class="code_container">
<div><div id="highlighter_107595" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">raw(stringish)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">stringish.to_s.html_safe</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/output_safety.rb</code>.</p></div><h5 id="transformation">5.1.3 Transformation</h5><p>As
 a rule of thumb, except perhaps for concatenation as explained above, 
any method that may change a string gives you an unsafe string. These 
are <code>downcase</code>, <code>gsub</code>, <code>strip</code>, <code>chomp</code>, <code>underscore</code>, etc.</p><p>In the case of in-place transformations like <code>gsub!</code> the receiver itself becomes unsafe.</p><div class="info"><p>The safety bit is lost always, no matter whether the transformation actually changed something.</p></div><h5 id="conversion-and-coercion">5.1.4 Conversion and Coercion</h5><p>Calling <code>to_s</code> on a safe string returns a safe string, but coercion with <code>to_str</code> returns an unsafe string.</p><h5 id="copying">5.1.5 Copying</h5><p>Calling <code>dup</code> or <code>clone</code> on safe strings yields safe strings.</p><h4 id="remove">5.2 <code>remove</code>
</h4><p>The method <code>remove</code> will remove all occurrences of the pattern:</p><div class="code_container">
<div><div id="highlighter_525822" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Hello World"</code><code class="ruby plain">.remove(/Hello /) </code><code class="ruby comments"># =&gt; "World"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>There's also the destructive version <code>String#remove!</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/filters.rb</code>.</p></div><h4 id="squish">5.3 <code>squish</code>
</h4><p>The method <code>squish</code> strips leading and trailing whitespace, and substitutes runs of whitespace with a single space each:</p><div class="code_container">
<div><div id="highlighter_709655" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">" \n&nbsp; foo\n\r \t bar \n"</code><code class="ruby plain">.squish </code><code class="ruby comments"># =&gt; "foo bar"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>There's also the destructive version <code>String#squish!</code>.</p><p>Note that it handles both ASCII and Unicode whitespace.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/filters.rb</code>.</p></div><h4 id="truncate">5.4 <code>truncate</code>
</h4><p>The method <code>truncate</code> returns a copy of its receiver truncated after a given <code>length</code>:</p><div class="code_container">
<div><div id="highlighter_299418" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate(</code><code class="ruby constants">20</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh dear!..."</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Ellipsis can be customized with the <code>:omission</code> option:</p><div class="code_container">
<div><div id="highlighter_964480" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate(</code><code class="ruby constants">20</code><code class="ruby plain">, omission: </code><code class="ruby string">'&amp;hellip;'</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh &amp;hellip;"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Note in particular that truncation takes into account the length of the omission string.</p><p>Pass a <code>:separator</code> to truncate the string at a natural break:</p><div class="code_container">
<div><div id="highlighter_808738" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate(</code><code class="ruby constants">18</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh dea..."</code></div><div class="line number3 index2 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate(</code><code class="ruby constants">18</code><code class="ruby plain">, separator: </code><code class="ruby string">' '</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh..."</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The option <code>:separator</code> can be a regexp:</p><div class="code_container">
<div><div id="highlighter_719480" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate(</code><code class="ruby constants">18</code><code class="ruby plain">, separator: /\s/)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh..."</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In above examples "dear" gets cut first, but then <code>:separator</code> prevents it.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/filters.rb</code>.</p></div><h4 id="truncate-words">5.5 <code>truncate_words</code>
</h4><p>The method <code>truncate_words</code> returns a copy of its receiver truncated after a given number of words:</p><div class="code_container">
<div><div id="highlighter_989480" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate_words(</code><code class="ruby constants">4</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh dear!..."</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Ellipsis can be customized with the <code>:omission</code> option:</p><div class="code_container">
<div><div id="highlighter_345216" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate_words(</code><code class="ruby constants">4</code><code class="ruby plain">, omission: </code><code class="ruby string">'&amp;hellip;'</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh dear!&amp;hellip;"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Pass a <code>:separator</code> to truncate the string at a natural break:</p><div class="code_container">
<div><div id="highlighter_264845" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate_words(</code><code class="ruby constants">3</code><code class="ruby plain">, separator: </code><code class="ruby string">'!'</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh dear! I shall be late..."</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The option <code>:separator</code> can be a regexp:</p><div class="code_container">
<div><div id="highlighter_540370" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Oh dear! Oh dear! I shall be late!"</code><code class="ruby plain">.truncate_words(</code><code class="ruby constants">4</code><code class="ruby plain">, separator: /\s/)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "Oh dear! Oh dear!..."</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/filters.rb</code>.</p></div><h4 id="inquiry">5.6 <code>inquiry</code>
</h4><p>The <code>inquiry</code> method converts a string into a <code>StringInquirer</code> object making equality checks prettier.</p><div class="code_container">
<div><div id="highlighter_792155" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"production"</code><code class="ruby plain">.inquiry.production? </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby string">"active"</code><code class="ruby plain">.inquiry.inactive?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<h4 id="starts-with-questionmark-and-ends-with-questionmark">5.7 <code>starts_with?</code> and <code>ends_with?</code>
</h4><p>Active Support defines 3rd person aliases of <code>String#start_with?</code> and <code>String#end_with?</code>:</p><div class="code_container">
<div><div id="highlighter_170397" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"foo"</code><code class="ruby plain">.starts_with?(</code><code class="ruby string">"f"</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby string">"foo"</code><code class="ruby plain">.ends_with?(</code><code class="ruby string">"o"</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/starts_ends_with.rb</code>.</p></div><h4 id="strip-heredoc">5.8 <code>strip_heredoc</code>
</h4><p>The method <code>strip_heredoc</code> strips indentation in heredocs.</p><p>For example in</p><div class="code_container">
<div><div id="highlighter_71157" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">if</code> <code class="ruby plain">options[</code><code class="ruby color2">:usage</code><code class="ruby plain">]</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">puts &lt;&lt;-</code><code class="ruby constants">USAGE</code><code class="ruby plain">.strip_heredoc</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">This command does such </code><code class="ruby keyword">and</code> <code class="ruby plain">such.</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">Supported options are:</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This message</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">USAGE</code></div><div class="line number9 index8 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>the user would see the usage message aligned against the left margin.</p><p>Technically, it looks for the least indented line in the whole string, and removes
that amount of leading whitespace.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/strip.rb</code>.</p></div><h4 id="indent">5.9 <code>indent</code>
</h4><p>Indents the lines in the receiver:</p><div class="code_container">
<div><div id="highlighter_354889" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">&lt;&lt;</code><code class="ruby constants">EOS</code><code class="ruby plain">.indent(</code><code class="ruby constants">2</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">some_method</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">some_code</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">end</code></div><div class="line number5 index4 alt2"><code class="ruby constants">EOS</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">def</code> <code class="ruby plain">some_method</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">some_code</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The second argument, <code>indent_string</code>, specifies which indent string to use. The default is <code>nil</code>, which tells the method to make an educated guess peeking at the first indented line, and fallback to a space if there is none.</p><div class="code_container">
<div><div id="highlighter_461217" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"&nbsp; foo"</code><code class="ruby plain">.indent(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "&nbsp;&nbsp;&nbsp; foo"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"foo\n\t\tbar"</code><code class="ruby plain">.indent(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "\t\tfoo\n\t\t\t\tbar"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"foo"</code><code class="ruby plain">.indent(</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby string">"\t"</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "\t\tfoo"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>While <code>indent_string</code> is typically one space or tab, it may be any string.</p><p>The third argument, <code>indent_empty_lines</code>, is a flag that says whether empty lines should be indented. Default is false.</p><div class="code_container">
<div><div id="highlighter_605532" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"foo\n\nbar"</code><code class="ruby plain">.indent(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "&nbsp; foo\n\n&nbsp; bar"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"foo\n\nbar"</code><code class="ruby plain">.indent(</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby keyword">true</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "&nbsp; foo\n&nbsp; \n&nbsp; bar"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The <code>indent!</code> method performs indentation in-place.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/indent.rb</code>.</p></div><h4 id="access">5.10 Access</h4><h5 id="at-position">5.10.1 <code>at(position)</code>
</h5><p>Returns the character of the string at position <code>position</code>:</p><div class="code_container">
<div><div id="highlighter_128109" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"hello"</code><code class="ruby plain">.at(</code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "h"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"hello"</code><code class="ruby plain">.at(</code><code class="ruby constants">4</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "o"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"hello"</code><code class="ruby plain">.at(-</code><code class="ruby constants">1</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "o"</code></div><div class="line number4 index3 alt1"><code class="ruby string">"hello"</code><code class="ruby plain">.at(</code><code class="ruby constants">10</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; nil</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/access.rb</code>.</p></div><h5 id="from-position">5.10.2 <code>from(position)</code>
</h5><p>Returns the substring of the string starting at position <code>position</code>:</p><div class="code_container">
<div><div id="highlighter_151509" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"hello"</code><code class="ruby plain">.from(</code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "hello"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"hello"</code><code class="ruby plain">.from(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "llo"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"hello"</code><code class="ruby plain">.from(-</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "lo"</code></div><div class="line number4 index3 alt1"><code class="ruby string">"hello"</code><code class="ruby plain">.from(</code><code class="ruby constants">10</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; nil</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/access.rb</code>.</p></div><h5 id="to-position">5.10.3 <code>to(position)</code>
</h5><p>Returns the substring of the string up to position <code>position</code>:</p><div class="code_container">
<div><div id="highlighter_622134" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"hello"</code><code class="ruby plain">.to(</code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "h"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"hello"</code><code class="ruby plain">.to(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "hel"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"hello"</code><code class="ruby plain">.to(-</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "hell"</code></div><div class="line number4 index3 alt1"><code class="ruby string">"hello"</code><code class="ruby plain">.to(</code><code class="ruby constants">10</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "hello"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/access.rb</code>.</p></div><h5 id="first-limit-1">5.10.4 <code>first(limit = 1)</code>
</h5><p>The call <code>str.first(n)</code> is equivalent to <code>str.to(n-1)</code> if <code>n</code> &gt; 0, and returns an empty string for <code>n</code> == 0.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/access.rb</code>.</p></div><h5 id="last-limit-1">5.10.5 <code>last(limit = 1)</code>
</h5><p>The call <code>str.last(n)</code> is equivalent to <code>str.from(-n)</code> if <code>n</code> &gt; 0, and returns an empty string for <code>n</code> == 0.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/access.rb</code>.</p></div><h4 id="inflections">5.11 Inflections</h4><h5 id="pluralize">5.11.1 <code>pluralize</code>
</h5><p>The method <code>pluralize</code> returns the plural of its receiver:</p><div class="code_container">
<div><div id="highlighter_626369" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"table"</code><code class="ruby plain">.pluralize&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "tables"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"ruby"</code><code class="ruby plain">.pluralize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "rubies"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"equipment"</code><code class="ruby plain">.pluralize </code><code class="ruby comments"># =&gt; "equipment"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As the previous example shows, Active Support knows some irregular 
plurals and uncountable nouns. Built-in rules can be extended in <code>config/initializers/inflections.rb</code>. That file is generated by the <code>rails</code> command and has instructions in comments.</p><p><code>pluralize</code> can also take an optional <code>count</code> parameter. If <code>count == 1</code> the singular form will be returned. For any other value of <code>count</code> the plural form will be returned:</p><div class="code_container">
<div><div id="highlighter_358647" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"dude"</code><code class="ruby plain">.pluralize(</code><code class="ruby constants">0</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "dudes"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"dude"</code><code class="ruby plain">.pluralize(</code><code class="ruby constants">1</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "dude"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"dude"</code><code class="ruby plain">.pluralize(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "dudes"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Record uses this method to compute the default table name that corresponds to a model:</p><div class="code_container">
<div><div id="highlighter_999499" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># active_record/model_schema.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">undecorated_table_name(class_name = base_class.name)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">table_name = class_name.to_s.demodulize.underscore</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">pluralize_table_names ? table_name.pluralize : table_name</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="singularize">5.11.2 <code>singularize</code>
</h5><p>The inverse of <code>pluralize</code>:</p><div class="code_container">
<div><div id="highlighter_50888" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"tables"</code><code class="ruby plain">.singularize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "table"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"rubies"</code><code class="ruby plain">.singularize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "ruby"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"equipment"</code><code class="ruby plain">.singularize </code><code class="ruby comments"># =&gt; "equipment"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Associations compute the name of the corresponding default associated class using this method:</p><div class="code_container">
<div><div id="highlighter_251717" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># active_record/reflection.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">derive_class_name</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">class_name = name.to_s.camelize</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">class_name = class_name.singularize </code><code class="ruby keyword">if</code> <code class="ruby plain">collection?</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">class_name</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="camelize">5.11.3 <code>camelize</code>
</h5><p>The method <code>camelize</code> returns its receiver in camel case:</p><div class="code_container">
<div><div id="highlighter_845317" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"product"</code><code class="ruby plain">.camelize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Product"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"admin_user"</code><code class="ruby plain">.camelize </code><code class="ruby comments"># =&gt; "AdminUser"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As a rule of thumb you can think of this method as the one that 
transforms paths into Ruby class or module names, where slashes separate
 namespaces:</p><div class="code_container">
<div><div id="highlighter_569202" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"backoffice/session"</code><code class="ruby plain">.camelize </code><code class="ruby comments"># =&gt; "Backoffice::Session"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>For example, Action Pack uses this method to load the class that provides a certain session store:</p><div class="code_container">
<div><div id="highlighter_883934" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># action_controller/metal/session_management.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">session_store=(store)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby variable bold">@@session_store</code> <code class="ruby plain">= store.is_a?(</code><code class="ruby color1">Symbol</code><code class="ruby plain">) ?</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">ActionDispatch::Session.const_get(store.to_s.camelize) :</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">store</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>camelize</code> accepts an optional argument, it can be <code>:upper</code> (default), or <code>:lower</code>. With the latter the first letter becomes lowercase:</p><div class="code_container">
<div><div id="highlighter_279458" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"visual_effect"</code><code class="ruby plain">.camelize(</code><code class="ruby color2">:lower</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "visualEffect"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>That may be handy to compute method names in a language that follows that convention, for example JavaScript.</p><div class="info"><p>As a rule of thumb you can think of <code>camelize</code> as the inverse of <code>underscore</code>, though there are cases where that does not hold: <code>"SSLError".underscore.camelize</code> gives back <code>"SslError"</code>. To support cases such as this, Active Support allows you to specify acronyms in <code>config/initializers/inflections.rb</code>:</p></div><div class="code_container">
<div><div id="highlighter_9470" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">ActiveSupport::Inflector.inflections </code><code class="ruby keyword">do</code> <code class="ruby plain">|inflect|</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">inflect.acronym </code><code class="ruby string">'SSL'</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby string">"SSLError"</code><code class="ruby plain">.underscore.camelize </code><code class="ruby comments"># =&gt; "SSLError"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>camelize</code> is aliased to <code>camelcase</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="underscore">5.11.4 <code>underscore</code>
</h5><p>The method <code>underscore</code> goes the other way around, from camel case to paths:</p><div class="code_container">
<div><div id="highlighter_909672" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Product"</code><code class="ruby plain">.underscore&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "product"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"AdminUser"</code><code class="ruby plain">.underscore </code><code class="ruby comments"># =&gt; "admin_user"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Also converts "::" back to "/":</p><div class="code_container">
<div><div id="highlighter_721742" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Backoffice::Session"</code><code class="ruby plain">.underscore </code><code class="ruby comments"># =&gt; "backoffice/session"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>and understands strings that start with lowercase:</p><div class="code_container">
<div><div id="highlighter_409354" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"visualEffect"</code><code class="ruby plain">.underscore </code><code class="ruby comments"># =&gt; "visual_effect"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>underscore</code> accepts no argument though.</p><p>Rails class and module autoloading uses <code>underscore</code> to infer the relative path without extension of a file that would define a given missing constant:</p><div class="code_container">
<div><div id="highlighter_561143" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># active_support/dependencies.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">load_missing_constant(from_mod, const_name)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">qualified_name = qualified_name_for from_mod, const_name</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">path_suffix = qualified_name.underscore</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="info"><p>As a rule of thumb you can think of <code>underscore</code> as the inverse of <code>camelize</code>, though there are cases where that does not hold. For example, <code>"SSLError".underscore.camelize</code> gives back <code>"SslError"</code>.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="titleize">5.11.5 <code>titleize</code>
</h5><p>The method <code>titleize</code> capitalizes the words in the receiver:</p><div class="code_container">
<div><div id="highlighter_59162" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"alice in wonderland"</code><code class="ruby plain">.titleize </code><code class="ruby comments"># =&gt; "Alice In Wonderland"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"fermat's enigma"</code><code class="ruby plain">.titleize&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Fermat's Enigma"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>titleize</code> is aliased to <code>titlecase</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="dasherize">5.11.6 <code>dasherize</code>
</h5><p>The method <code>dasherize</code> replaces the underscores in the receiver with dashes:</p><div class="code_container">
<div><div id="highlighter_253390" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"name"</code><code class="ruby plain">.dasherize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "name"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"contact_data"</code><code class="ruby plain">.dasherize </code><code class="ruby comments"># =&gt; "contact-data"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The XML serializer of models uses this method to dasherize node names:</p><div class="code_container">
<div><div id="highlighter_965299" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># active_model/serializers/xml.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">reformat_name(name)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">name = name.camelize </code><code class="ruby keyword">if</code> <code class="ruby plain">camelize?</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">dasherize? ? name.dasherize : name</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="demodulize">5.11.7 <code>demodulize</code>
</h5><p>Given a string with a qualified constant name, <code>demodulize</code> returns the very constant name, that is, the rightmost part of it:</p><div class="code_container">
<div><div id="highlighter_3810" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Product"</code><code class="ruby plain">.demodulize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Product"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"Backoffice::UsersController"</code><code class="ruby plain">.demodulize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "UsersController"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"Admin::Hotel::ReservationUtils"</code><code class="ruby plain">.demodulize </code><code class="ruby comments"># =&gt; "ReservationUtils"</code></div><div class="line number4 index3 alt1"><code class="ruby string">"::Inflections"</code><code class="ruby plain">.demodulize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Inflections"</code></div><div class="line number5 index4 alt2"><code class="ruby string">""</code><code class="ruby plain">.demodulize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ""</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Record for example uses this method to compute the name of a counter cache column:</p><div class="code_container">
<div><div id="highlighter_408638" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># active_record/reflection.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">counter_cache_column</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">if</code> <code class="ruby plain">options[</code><code class="ruby color2">:counter_cache</code><code class="ruby plain">] == </code><code class="ruby keyword">true</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby string">"#{active_record.name.demodulize.underscore.pluralize}_count"</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">elsif</code> <code class="ruby plain">options[</code><code class="ruby color2">:counter_cache</code><code class="ruby plain">]</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby plain">options[</code><code class="ruby color2">:counter_cache</code><code class="ruby plain">]</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number8 index7 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="deconstantize">5.11.8 <code>deconstantize</code>
</h5><p>Given a string with a qualified constant reference expression, <code>deconstantize</code> removes the rightmost segment, generally leaving the name of the constant's container:</p><div class="code_container">
<div><div id="highlighter_725959" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Product"</code><code class="ruby plain">.deconstantize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ""</code></div><div class="line number2 index1 alt1"><code class="ruby string">"Backoffice::UsersController"</code><code class="ruby plain">.deconstantize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Backoffice"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"Admin::Hotel::ReservationUtils"</code><code class="ruby plain">.deconstantize </code><code class="ruby comments"># =&gt; "Admin::Hotel"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Support for example uses this method in <code>Module#qualified_const_set</code>:</p><div class="code_container">
<div><div id="highlighter_40068" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">qualified_const_set(path, value)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">QualifiedConstUtils.raise_if_absolute(path)</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">const_name = path.demodulize</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">mod_name = path.deconstantize</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">mod = mod_name.empty? ? </code><code class="ruby keyword">self</code> <code class="ruby plain">: qualified_const_get(mod_name)</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">mod.const_set(const_name, value)</code></div><div class="line number8 index7 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="parameterize">5.11.9 <code>parameterize</code>
</h5><p>The method <code>parameterize</code> normalizes its receiver in a way that can be used in pretty URLs.</p><div class="code_container">
<div><div id="highlighter_65149" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"John Smith"</code><code class="ruby plain">.parameterize </code><code class="ruby comments"># =&gt; "john-smith"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"Kurt GÃ¶del"</code><code class="ruby plain">.parameterize </code><code class="ruby comments"># =&gt; "kurt-godel"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In fact, the result string is wrapped in an instance of <code>ActiveSupport::Multibyte::Chars</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="tableize">5.11.10 <code>tableize</code>
</h5><p>The method <code>tableize</code> is <code>underscore</code> followed by <code>pluralize</code>.</p><div class="code_container">
<div><div id="highlighter_864516" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Person"</code><code class="ruby plain">.tableize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "people"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"Invoice"</code><code class="ruby plain">.tableize&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "invoices"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"InvoiceLine"</code><code class="ruby plain">.tableize </code><code class="ruby comments"># =&gt; "invoice_lines"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As a rule of thumb, <code>tableize</code> returns the table name that
 corresponds to a given model for simple cases. The actual 
implementation in Active Record is not straight <code>tableize</code> indeed, because it also demodulizes the class name and checks a few options that may affect the returned string.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="classify">5.11.11 <code>classify</code>
</h5><p>The method <code>classify</code> is the inverse of <code>tableize</code>. It gives you the class name corresponding to a table name:</p><div class="code_container">
<div><div id="highlighter_310056" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"people"</code><code class="ruby plain">.classify&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Person"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"invoices"</code><code class="ruby plain">.classify&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Invoice"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"invoice_lines"</code><code class="ruby plain">.classify </code><code class="ruby comments"># =&gt; "InvoiceLine"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method understands qualified table names:</p><div class="code_container">
<div><div id="highlighter_777173" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"highrise_production.companies"</code><code class="ruby plain">.classify </code><code class="ruby comments"># =&gt; "Company"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Note that <code>classify</code> returns a class name as a string. You can get the actual class object invoking <code>constantize</code> on it, explained next.</p><div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="constantize">5.11.12 <code>constantize</code>
</h5><p>The method <code>constantize</code> resolves the constant reference expression in its receiver:</p><div class="code_container">
<div><div id="highlighter_543089" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"Fixnum"</code><code class="ruby plain">.constantize </code><code class="ruby comments"># =&gt; Fixnum</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">X</code> <code class="ruby plain">= </code><code class="ruby constants">1</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby string">"M::X"</code><code class="ruby plain">.constantize </code><code class="ruby comments"># =&gt; 1</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the string evaluates to no known constant, or its content is not even a valid constant name, <code>constantize</code> raises <code>NameError</code>.</p><p>Constant name resolution by <code>constantize</code> starts always at the top-level <code>Object</code> even if there is no leading "::".</p><div class="code_container">
<div><div id="highlighter_763999" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">X</code> <code class="ruby plain">= </code><code class="ruby color2">:in_Object</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">module</code> <code class="ruby constants">M</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">X</code> <code class="ruby plain">= </code><code class="ruby color2">:in_M</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby constants">X</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby comments"># =&gt; :in_M</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"::X"</code><code class="ruby plain">.constantize </code><code class="ruby comments"># =&gt; :in_Object</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"X"</code><code class="ruby plain">.constantize&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; :in_Object (!)</code></div><div class="line number8 index7 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>So, it is in general not equivalent to what Ruby would do in the same spot, had a real constant be evaluated.</p><p>Mailer test cases obtain the mailer being tested from the name of the test class using <code>constantize</code>:</p><div class="code_container">
<div><div id="highlighter_171523" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># action_mailer/test_case.rb</code></div><div class="line number2 index1 alt1"><code class="ruby keyword">def</code> <code class="ruby plain">determine_default_mailer(name)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">name.sub(/Test$/, </code><code class="ruby string">''</code><code class="ruby plain">).constantize</code></div><div class="line number4 index3 alt1"><code class="ruby keyword">rescue</code> <code class="ruby plain">NameError =&gt; e</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">raise</code> <code class="ruby plain">NonInferrableMailerError.</code><code class="ruby keyword">new</code><code class="ruby plain">(name)</code></div><div class="line number6 index5 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="humanize">5.11.13 <code>humanize</code>
</h5><p>The method <code>humanize</code> tweaks an attribute name for display to end users.</p><p>Specifically performs these transformations:</p>
<ul>
<li>Applies human inflection rules to the argument.</li>
<li>Deletes leading underscores, if any.</li>
<li>Removes a "_id" suffix if present.</li>
<li>Replaces underscores with spaces, if any.</li>
<li>Downcases all words except acronyms.</li>
<li>Capitalizes the first word.</li>
</ul>
<p>The capitalization of the first word can be turned off by setting the
+:capitalize+ option to false (default is true).</p><div class="code_container">
<div><div id="highlighter_677327" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"name"</code><code class="ruby plain">.humanize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Name"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"author_id"</code><code class="ruby plain">.humanize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Author"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"author_id"</code><code class="ruby plain">.humanize(capitalize: </code><code class="ruby keyword">false</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "author"</code></div><div class="line number4 index3 alt1"><code class="ruby string">"comments_count"</code><code class="ruby plain">.humanize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Comments count"</code></div><div class="line number5 index4 alt2"><code class="ruby string">"_id"</code><code class="ruby plain">.humanize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Id"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If "SSL" was defined to be an acronym:</p><div class="code_container">
<div><div id="highlighter_705855" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">'ssl_error'</code><code class="ruby plain">.humanize </code><code class="ruby comments"># =&gt; "SSL error"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The helper method <code>full_messages</code> uses <code>humanize</code> as a fallback to include
attribute names:</p><div class="code_container">
<div><div id="highlighter_184909" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">full_messages</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">map { |attribute, message| full_message(attribute, message) }</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">full_message</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">attr_name = attribute.to_s.tr(</code><code class="ruby string">'.'</code><code class="ruby plain">, </code><code class="ruby string">'_'</code><code class="ruby plain">).humanize</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">attr_name = </code><code class="ruby variable bold">@base</code><code class="ruby plain">.</code><code class="ruby keyword">class</code><code class="ruby plain">.human_attribute_name(attribute, default: attr_name)</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number10 index9 alt1"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h5 id="foreign-key">5.11.14 <code>foreign_key</code>
</h5><p>The method <code>foreign_key</code> gives a foreign key column name from a class name. To do so it demodulizes, underscores, and adds "_id":</p><div class="code_container">
<div><div id="highlighter_849481" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"User"</code><code class="ruby plain">.foreign_key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "user_id"</code></div><div class="line number2 index1 alt1"><code class="ruby string">"InvoiceLine"</code><code class="ruby plain">.foreign_key&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "invoice_line_id"</code></div><div class="line number3 index2 alt2"><code class="ruby string">"Admin::Session"</code><code class="ruby plain">.foreign_key </code><code class="ruby comments"># =&gt; "session_id"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Pass a false argument if you do not want the underscore in "_id":</p><div class="code_container">
<div><div id="highlighter_271079" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"User"</code><code class="ruby plain">.foreign_key(</code><code class="ruby keyword">false</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "userid"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Associations use this method to infer foreign keys, for example <code>has_one</code> and <code>has_many</code> do this:</p><div class="code_container">
<div><div id="highlighter_565378" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># active_record/associations.rb</code></div><div class="line number2 index1 alt1"><code class="ruby plain">foreign_key = options[</code><code class="ruby color2">:foreign_key</code><code class="ruby plain">] || reflection.active_record.name.foreign_key</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/string/inflections.rb</code>.</p></div><h4 id="extensions-to-string-conversions">5.12 Conversions</h4><h5 id="to-date-to-time-to-datetime">5.12.1 <code>to_date</code>, <code>to_time</code>, <code>to_datetime</code>
</h5><p>The methods <code>to_date</code>, <code>to_time</code>, and <code>to_datetime</code> are basically convenience wrappers around <code>Date._parse</code>:</p><div class="code_container">
<div><div id="highlighter_761598" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"2010-07-27"</code><code class="ruby plain">.to_date&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Tue, 27 Jul 2010</code></div><div class="line number2 index1 alt1"><code class="ruby string">"2010-07-27 23:37:00"</code><code class="ruby plain">.to_time&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Tue Jul 27 23:37:00 UTC 2010</code></div><div class="line number3 index2 alt2"><code class="ruby string">"2010-07-27 23:37:00"</code><code class="ruby plain">.to_datetime </code><code class="ruby comments"># =&gt; Tue, 27 Jul 2010 23:37:00 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>to_time</code> receives an optional argument <code>:utc</code> or <code>:local</code>, to indicate which time zone you want the time in:</p><div class="code_container">
<div><div id="highlighter_362119" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby string">"2010-07-27 23:42:00"</code><code class="ruby plain">.to_time(</code><code class="ruby color2">:utc</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Tue Jul 27 23:42:00 UTC 2010</code></div><div class="line number2 index1 alt1"><code class="ruby string">"2010-07-27 23:42:00"</code><code class="ruby plain">.to_time(</code><code class="ruby color2">:local</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Tue Jul 27 23:42:00 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Default is <code>:utc</code>.</p><p>Please refer to the documentation of <code>Date._parse</code> for further details.</p><div class="info"><p>The three of them return <code>nil</code> for blank receivers.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/string/conversions.rb</code>.</p></div><h3 id="extensions-to-numeric">6 Extensions to <code>Numeric</code>
</h3><h4 id="bytes">6.1 Bytes</h4><p>All numbers respond to these methods:</p><div class="code_container">
<div><div id="highlighter_234574" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">bytes</code></div><div class="line number2 index1 alt1"><code class="ruby plain">kilobytes</code></div><div class="line number3 index2 alt2"><code class="ruby plain">megabytes</code></div><div class="line number4 index3 alt1"><code class="ruby plain">gigabytes</code></div><div class="line number5 index4 alt2"><code class="ruby plain">terabytes</code></div><div class="line number6 index5 alt1"><code class="ruby plain">petabytes</code></div><div class="line number7 index6 alt2"><code class="ruby plain">exabytes</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They return the corresponding amount of bytes, using a conversion factor of 1024:</p><div class="code_container">
<div><div id="highlighter_55343" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">2</code><code class="ruby plain">.kilobytes&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 2048</code></div><div class="line number2 index1 alt1"><code class="ruby constants">3</code><code class="ruby plain">.megabytes&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 3145728</code></div><div class="line number3 index2 alt2"><code class="ruby constants">3</code><code class="ruby plain">.</code><code class="ruby constants">5</code><code class="ruby plain">.gigabytes </code><code class="ruby comments"># =&gt; 3758096384</code></div><div class="line number4 index3 alt1"><code class="ruby plain">-</code><code class="ruby constants">4</code><code class="ruby plain">.exabytes&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; -4611686018427387904</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Singular forms are aliased so you are able to say:</p><div class="code_container">
<div><div id="highlighter_369538" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1</code><code class="ruby plain">.megabyte </code><code class="ruby comments"># =&gt; 1048576</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/numeric/bytes.rb</code>.</p></div><h4 id="time">6.2 Time</h4><p>Enables the use of time calculations and declarations, like <code>45.minutes + 2.hours + 4.years</code>.</p><p>These methods use Time#advance for precise date calculations when using from_now, ago, etc.
as well as adding or subtracting their results from a Time object. For example:</p><div class="code_container">
<div><div id="highlighter_314188" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby comments"># equivalent to Time.current.advance(months: 1)</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1</code><code class="ruby plain">.month.from_now</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby comments"># equivalent to Time.current.advance(years: 2)</code></div><div class="line number5 index4 alt2"><code class="ruby constants">2</code><code class="ruby plain">.years.from_now</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby comments"># equivalent to Time.current.advance(months: 4, years: 5)</code></div><div class="line number8 index7 alt1"><code class="ruby plain">(</code><code class="ruby constants">4</code><code class="ruby plain">.months + </code><code class="ruby constants">5</code><code class="ruby plain">.years).from_now</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/numeric/time.rb</code></p></div><h4 id="formatting">6.3 Formatting</h4><p>Enables the formatting of numbers in a variety of ways.</p><p>Produce a string representation of a number as a telephone number:</p><div class="code_container">
<div><div id="highlighter_41960" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">5551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; 555-1234</code></div><div class="line number3 index2 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; 123-555-1234</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, area_code: </code><code class="ruby keyword">true</code><code class="ruby plain">)</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; (123) 555-1234</code></div><div class="line number7 index6 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, delimiter: </code><code class="ruby string">" "</code><code class="ruby plain">)</code></div><div class="line number8 index7 alt1"><code class="ruby comments"># =&gt; 123 555 1234</code></div><div class="line number9 index8 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, area_code: </code><code class="ruby keyword">true</code><code class="ruby plain">, extension: </code><code class="ruby constants">555</code><code class="ruby plain">)</code></div><div class="line number10 index9 alt1"><code class="ruby comments"># =&gt; (123) 555-1234 x 555</code></div><div class="line number11 index10 alt2"><code class="ruby constants">1235551234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:phone</code><code class="ruby plain">, country_code: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number12 index11 alt1"><code class="ruby comments"># =&gt; +1-123-555-1234</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number as currency:</p><div class="code_container">
<div><div id="highlighter_388318" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.</code><code class="ruby constants">50</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:currency</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; $1,234,567,890.50</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1234567890</code><code class="ruby plain">.</code><code class="ruby constants">506</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:currency</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; $1,234,567,890.51</code></div><div class="line number3 index2 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.</code><code class="ruby constants">506</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:currency</code><code class="ruby plain">, precision: </code><code class="ruby constants">3</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; $1,234,567,890.506</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number as a percentage:</p><div class="code_container">
<div><div id="highlighter_73380" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">100</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; 100.000%</code></div><div class="line number3 index2 alt2"><code class="ruby constants">100</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">, precision: </code><code class="ruby constants">0</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; 100%</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1000</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">, delimiter: </code><code class="ruby string">'.'</code><code class="ruby plain">, separator: </code><code class="ruby string">','</code><code class="ruby plain">)</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; 1.000,000%</code></div><div class="line number7 index6 alt2"><code class="ruby constants">302</code><code class="ruby plain">.</code><code class="ruby constants">24398923423</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:percentage</code><code class="ruby plain">, precision: </code><code class="ruby constants">5</code><code class="ruby plain">)</code></div><div class="line number8 index7 alt1"><code class="ruby comments"># =&gt; 302.24399%</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number in delimited form:</p><div class="code_container">
<div><div id="highlighter_163936" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">12345678</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678</code></div><div class="line number2 index1 alt1"><code class="ruby constants">12345678</code><code class="ruby plain">.</code><code class="ruby constants">05</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678.05</code></div><div class="line number3 index2 alt2"><code class="ruby constants">12345678</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">, delimiter: </code><code class="ruby string">"."</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12.345.678</code></div><div class="line number4 index3 alt1"><code class="ruby constants">12345678</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">, delimiter: </code><code class="ruby string">","</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678</code></div><div class="line number5 index4 alt2"><code class="ruby constants">12345678</code><code class="ruby plain">.</code><code class="ruby constants">05</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:delimited</code><code class="ruby plain">, separator: </code><code class="ruby string">" "</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; 12,345,678 05</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number rounded to a precision:</p><div class="code_container">
<div><div id="highlighter_545837" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">111</code><code class="ruby plain">.</code><code class="ruby constants">2345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 111.235</code></div><div class="line number2 index1 alt1"><code class="ruby constants">111</code><code class="ruby plain">.</code><code class="ruby constants">2345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, precision: </code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 111.23</code></div><div class="line number3 index2 alt2"><code class="ruby constants">13</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, precision: </code><code class="ruby constants">5</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 13.00000</code></div><div class="line number4 index3 alt1"><code class="ruby constants">389</code><code class="ruby plain">.</code><code class="ruby constants">32314</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, precision: </code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 389</code></div><div class="line number5 index4 alt2"><code class="ruby constants">111</code><code class="ruby plain">.</code><code class="ruby constants">2345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:rounded</code><code class="ruby plain">, significant: </code><code class="ruby keyword">true</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; 111</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number as a human-readable number of bytes:</p><div class="code_container">
<div><div id="highlighter_640835" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 123 Bytes</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 1.21 KB</code></div><div class="line number3 index2 alt2"><code class="ruby constants">12345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 12.1 KB</code></div><div class="line number4 index3 alt1"><code class="ruby constants">1234567</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 1.18 MB</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 1.15 GB</code></div><div class="line number6 index5 alt1"><code class="ruby constants">1234567890123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human_size</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; 1.12 TB</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Produce a string representation of a number in human-readable words:</p><div class="code_container">
<div><div id="highlighter_546768" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "123"</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1234</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Thousand"</code></div><div class="line number3 index2 alt2"><code class="ruby constants">12345</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "12.3 Thousand"</code></div><div class="line number4 index3 alt1"><code class="ruby constants">1234567</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Million"</code></div><div class="line number5 index4 alt2"><code class="ruby constants">1234567890</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Billion"</code></div><div class="line number6 index5 alt1"><code class="ruby constants">1234567890123</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Trillion"</code></div><div class="line number7 index6 alt2"><code class="ruby constants">1234567890123456</code><code class="ruby plain">.to_s(</code><code class="ruby color2">:human</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "1.23 Quadrillion"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/numeric/conversions.rb</code>.</p></div><h3 id="extensions-to-integer">7 Extensions to <code>Integer</code>
</h3><h4 id="multiple-of-questionmark">7.1 <code>multiple_of?</code>
</h4><p>The method <code>multiple_of?</code> tests whether an integer is multiple of the argument:</p><div class="code_container">
<div><div id="highlighter_722284" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">2</code><code class="ruby plain">.multiple_of?(</code><code class="ruby constants">1</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby constants">1</code><code class="ruby plain">.multiple_of?(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/integer/multiple.rb</code>.</p></div><h4 id="ordinal">7.2 <code>ordinal</code>
</h4><p>The method <code>ordinal</code> returns the ordinal suffix string corresponding to the receiver integer:</p><div class="code_container">
<div><div id="highlighter_456240" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1</code><code class="ruby plain">.ordinal&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "st"</code></div><div class="line number2 index1 alt1"><code class="ruby constants">2</code><code class="ruby plain">.ordinal&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "nd"</code></div><div class="line number3 index2 alt2"><code class="ruby constants">53</code><code class="ruby plain">.ordinal&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "rd"</code></div><div class="line number4 index3 alt1"><code class="ruby constants">2009</code><code class="ruby plain">.ordinal </code><code class="ruby comments"># =&gt; "th"</code></div><div class="line number5 index4 alt2"><code class="ruby plain">-</code><code class="ruby constants">21</code><code class="ruby plain">.ordinal&nbsp; </code><code class="ruby comments"># =&gt; "st"</code></div><div class="line number6 index5 alt1"><code class="ruby plain">-</code><code class="ruby constants">134</code><code class="ruby plain">.ordinal </code><code class="ruby comments"># =&gt; "th"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/integer/inflections.rb</code>.</p></div><h4 id="ordinalize">7.3 <code>ordinalize</code>
</h4><p>The method <code>ordinalize</code> returns the ordinal string corresponding to the receiver integer. In comparison, note that the <code>ordinal</code> method returns <strong>only</strong> the suffix string.</p><div class="code_container">
<div><div id="highlighter_920935" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">1</code><code class="ruby plain">.ordinalize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "1st"</code></div><div class="line number2 index1 alt1"><code class="ruby constants">2</code><code class="ruby plain">.ordinalize&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "2nd"</code></div><div class="line number3 index2 alt2"><code class="ruby constants">53</code><code class="ruby plain">.ordinalize&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "53rd"</code></div><div class="line number4 index3 alt1"><code class="ruby constants">2009</code><code class="ruby plain">.ordinalize </code><code class="ruby comments"># =&gt; "2009th"</code></div><div class="line number5 index4 alt2"><code class="ruby plain">-</code><code class="ruby constants">21</code><code class="ruby plain">.ordinalize&nbsp; </code><code class="ruby comments"># =&gt; "-21st"</code></div><div class="line number6 index5 alt1"><code class="ruby plain">-</code><code class="ruby constants">134</code><code class="ruby plain">.ordinalize </code><code class="ruby comments"># =&gt; "-134th"</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/integer/inflections.rb</code>.</p></div><h3 id="extensions-to-bigdecimal">8 Extensions to <code>BigDecimal</code>
</h3><h4 id="extensions-to-bigdecimal-to-s">8.1 <code>to_s</code>
</h4><p>The method <code>to_s</code> is aliased to <code>to_formatted_s</code>. This provides a convenient way to display a BigDecimal value in floating-point notation:</p><div class="code_container">
<div><div id="highlighter_766926" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">BigDecimal.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">5</code><code class="ruby plain">.</code><code class="ruby constants">00</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">).to_s&nbsp; </code><code class="ruby comments"># =&gt; "5.0"</code></div></div></td></tr></tbody></table></div></div>
</div>
<h4 id="extensions-to-bigdecimal-to-formatted-s">8.2 <code>to_formatted_s</code>
</h4><p>Te method <code>to_formatted_s</code> provides a default specifier of "F".  This means that a simple call to <code>to_formatted_s</code> or <code>to_s</code> will result in floating point representation instead of engineering notation:</p><div class="code_container">
<div><div id="highlighter_903299" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">BigDecimal.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">5</code><code class="ruby plain">.</code><code class="ruby constants">00</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">).to_formatted_s&nbsp; </code><code class="ruby comments"># =&gt; "5.0"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>and that symbol specifiers are also supported:</p><div class="code_container">
<div><div id="highlighter_548983" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">BigDecimal.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">5</code><code class="ruby plain">.</code><code class="ruby constants">00</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">).to_formatted_s(</code><code class="ruby color2">:db</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "5.0"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Engineering notation is still supported:</p><div class="code_container">
<div><div id="highlighter_309615" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">BigDecimal.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">5</code><code class="ruby plain">.</code><code class="ruby constants">00</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">).to_formatted_s(</code><code class="ruby string">"e"</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; "0.5E1"</code></div></div></td></tr></tbody></table></div></div>
</div>
<h3 id="extensions-to-enumerable">9 Extensions to <code>Enumerable</code>
</h3><h4 id="sum">9.1 <code>sum</code>
</h4><p>The method <code>sum</code> adds the elements of an enumerable:</p><div class="code_container">
<div><div id="highlighter_162988" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">].sum </code><code class="ruby comments"># =&gt; 6</code></div><div class="line number2 index1 alt1"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">100</code><code class="ruby plain">).sum&nbsp; </code><code class="ruby comments"># =&gt; 5050</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Addition only assumes the elements respond to <code>+</code>:</p><div class="code_container">
<div><div id="highlighter_722591" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[[</code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">], [</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">], [</code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">]].sum&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [1, 2, 2, 3, 3, 4]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">%w(foo bar baz).sum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "foobarbaz"</code></div><div class="line number3 index2 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">, c: </code><code class="ruby constants">3</code><code class="ruby plain">}.sum </code><code class="ruby comments"># =&gt; [:b, 2, :c, 3, :a, 1]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The sum of an empty collection is zero by default, but this is customizable:</p><div class="code_container">
<div><div id="highlighter_575830" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[].sum&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 0</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[].sum(</code><code class="ruby constants">1</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; 1</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If a block is given, <code>sum</code> becomes an iterator that yields the elements of the collection and sums the returned values:</p><div class="code_container">
<div><div id="highlighter_135784" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">5</code><code class="ruby plain">).sum {|n| n * </code><code class="ruby constants">2</code> <code class="ruby plain">} </code><code class="ruby comments"># =&gt; 30</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">8</code><code class="ruby plain">, </code><code class="ruby constants">10</code><code class="ruby plain">].sum&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; 30</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The sum of an empty receiver can be customized in this form as well:</p><div class="code_container">
<div><div id="highlighter_554299" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[].sum(</code><code class="ruby constants">1</code><code class="ruby plain">) {|n| n**</code><code class="ruby constants">3</code><code class="ruby plain">} </code><code class="ruby comments"># =&gt; 1</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/enumerable.rb</code>.</p></div><h4 id="index-by">9.2 <code>index_by</code>
</h4><p>The method <code>index_by</code> generates a hash with the elements of an enumerable indexed by some key.</p><p>It
 iterates through the collection and passes each element to a block. The
 element will be keyed by the value returned by the block:</p><div class="code_container">
<div><div id="highlighter_549027" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">invoices.index_by(&amp;</code><code class="ruby color2">:number</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {'2009-032' =&gt; &lt;Invoice ...&gt;, '2009-008' =&gt; &lt;Invoice ...&gt;, ...}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>Keys should normally be unique. If the block 
returns the same value for different elements no collection is built for
 that key. The last item will win.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/enumerable.rb</code>.</p></div><h4 id="many-questionmark">9.3 <code>many?</code>
</h4><p>The method <code>many?</code> is shorthand for <code>collection.size &gt; 1</code>:</p><div class="code_container">
<div><div id="highlighter_271761" class="syntaxhighlighter nogutter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby script">&lt;%</code> <code class="ruby keyword">if</code> <code class="ruby plain">pages.many? </code><code class="ruby script">%&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;</code><code class="ruby script">&lt;%=</code> <code class="ruby plain">pagination_links </code><code class="ruby script">%&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby script">&lt;%</code> <code class="ruby keyword">end</code> <code class="ruby script">%&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If an optional block is given, <code>many?</code> only takes into account those elements that return true:</p><div class="code_container">
<div><div id="highlighter_43733" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby variable bold">@see_more</code> <code class="ruby plain">= videos.many? {|video| video.category == params[</code><code class="ruby color2">:category</code><code class="ruby plain">]}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/enumerable.rb</code>.</p></div><h4 id="exclude-questionmark">9.4 <code>exclude?</code>
</h4><p>The predicate <code>exclude?</code> tests whether a given object does <strong>not</strong> belong to the collection. It is the negation of the built-in <code>include?</code>:</p><div class="code_container">
<div><div id="highlighter_153366" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">to_visit &lt;&lt; node </code><code class="ruby keyword">if</code> <code class="ruby plain">visited.exclude?(node)</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/enumerable.rb</code>.</p></div><h4 id="without">9.5 <code>without</code>
</h4><p>The method <code>without</code> returns a copy of an enumerable with the specified elements
removed:</p><div class="code_container">
<div><div id="highlighter_655205" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby string">"David"</code><code class="ruby plain">, </code><code class="ruby string">"Rafael"</code><code class="ruby plain">, </code><code class="ruby string">"Aaron"</code><code class="ruby plain">, </code><code class="ruby string">"Todd"</code><code class="ruby plain">].without(</code><code class="ruby string">"Aaron"</code><code class="ruby plain">, </code><code class="ruby string">"Todd"</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; ["David", "Rafael"]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/enumerable.rb</code>.</p></div><h4 id="pluck">9.6 <code>pluck</code>
</h4><p>The method <code>pluck</code> returns an array based on the given key:</p><div class="code_container">
<div><div id="highlighter_558753" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[{ name: </code><code class="ruby string">"David"</code> <code class="ruby plain">}, { name: </code><code class="ruby string">"Rafael"</code> <code class="ruby plain">}, { name: </code><code class="ruby string">"Aaron"</code> <code class="ruby plain">}].pluck(</code><code class="ruby color2">:name</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; ["David", "Rafael", "Aaron"]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/enumerable.rb</code>.</p></div><h3 id="extensions-to-array">10 Extensions to <code>Array</code>
</h3><h4 id="accessing">10.1 Accessing</h4><p>Active Support augments the API of arrays to ease certain ways of accessing them. For example, <code>to</code> returns the subarray of elements up to the one at the passed index:</p><div class="code_container">
<div><div id="highlighter_742808" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(a b c d).to(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; ["a", "b", "c"]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[].to(</code><code class="ruby constants">7</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; []</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Similarly, <code>from</code> returns the tail from the element at the
 passed index to the end. If the index is greater than the length of the
 array, it returns an empty array.</p><div class="code_container">
<div><div id="highlighter_627873" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(a b c d).from(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; ["c", "d"]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">%w(a b c d).from(</code><code class="ruby constants">10</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; []</code></div><div class="line number3 index2 alt2"><code class="ruby plain">[].from(</code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; []</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The methods <code>second</code>, <code>third</code>, <code>fourth</code>, and <code>fifth</code> return the corresponding element (<code>first</code> is built-in). Thanks to social wisdom and positive constructiveness all around, <code>forty_two</code> is also available.</p><div class="code_container">
<div><div id="highlighter_183425" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(a b c d).third </code><code class="ruby comments"># =&gt; "c"</code></div><div class="line number2 index1 alt1"><code class="ruby plain">%w(a b c d).fifth </code><code class="ruby comments"># =&gt; nil</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/array/access.rb</code>.</p></div><h4 id="adding-elements">10.2 Adding Elements</h4><h5 id="prepend">10.2.1 <code>prepend</code>
</h5><p>This method is an alias of <code>Array#unshift</code>.</p><div class="code_container">
<div><div id="highlighter_30803" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(a b c d).prepend(</code><code class="ruby string">'e'</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; ["e", "a", "b", "c", "d"]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[].prepend(</code><code class="ruby constants">10</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [10]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/array/prepend_and_append.rb</code>.</p></div><h5 id="append">10.2.2 <code>append</code>
</h5><p>This method is an alias of <code>Array#&lt;&lt;</code>.</p><div class="code_container">
<div><div id="highlighter_290873" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(a b c d).append(</code><code class="ruby string">'e'</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; ["a", "b", "c", "d", "e"]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[].append([</code><code class="ruby constants">1</code><code class="ruby plain">,</code><code class="ruby constants">2</code><code class="ruby plain">])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [[1, 2]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/array/prepend_and_append.rb</code>.</p></div><h4 id="options-extraction">10.3 Options Extraction</h4><p>When the last argument in a method call is a hash, except perhaps for a <code>&amp;block</code> argument, Ruby allows you to omit the brackets:</p><div class="code_container">
<div><div id="highlighter_717160" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">User.exists?(email: params[</code><code class="ruby color2">:email</code><code class="ruby plain">])</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>That syntactic sugar is used a lot in Rails to avoid positional 
arguments where there would be too many, offering instead interfaces 
that emulate named parameters. In particular it is very idiomatic to use
 a trailing hash for options.</p><p>If a method expects a variable number of arguments and uses <code>*</code> in its declaration, however, such an options hash ends up being an item of the array of arguments, where it loses its role.</p><p>In those cases, you may give an options hash a distinguished treatment with <code>extract_options!</code>.
 This method checks the type of the last item of an array. If it is a 
hash it pops it and returns it, otherwise it returns an empty hash.</p><p>Let's see for example the definition of the <code>caches_action</code> controller macro:</p><div class="code_container">
<div><div id="highlighter_746403" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">caches_action(*actions)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">return</code> <code class="ruby keyword">unless</code> <code class="ruby plain">cache_configured?</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">options = actions.extract_options!</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method receives an arbitrary number of action names, and an optional hash of options as last argument. With the call to <code>extract_options!</code> you obtain the options hash and remove it from <code>actions</code> in a simple and explicit way.</p><div class="note"><p>Defined in <code>active_support/core_ext/array/extract_options.rb</code>.</p></div><h4 id="extensions-to-array-conversions">10.4 Conversions</h4><h5 id="to-sentence">10.4.1 <code>to_sentence</code>
</h5><p>The method <code>to_sentence</code> turns an array into a string containing a sentence that enumerates its items:</p><div class="code_container">
<div><div id="highlighter_71556" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w().to_sentence&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; ""</code></div><div class="line number2 index1 alt1"><code class="ruby plain">%w(Earth).to_sentence&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Earth"</code></div><div class="line number3 index2 alt2"><code class="ruby plain">%w(Earth Wind).to_sentence&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "Earth and Wind"</code></div><div class="line number4 index3 alt1"><code class="ruby plain">%w(Earth Wind Fire).to_sentence </code><code class="ruby comments"># =&gt; "Earth, Wind, and Fire"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method accepts three options:</p>
<ul>
<li>
<code>:two_words_connector</code>: What is used for arrays of length 2. Default is " and ".</li>
<li>
<code>:words_connector</code>: What is used to join the elements of arrays with 3 or more elements, except for the last two. Default is ", ".</li>
<li>
<code>:last_word_connector</code>: What is used to join the last items of an array with 3 or more elements. Default is ", and ".</li>
</ul>
<p>The defaults for these options can be localized, their keys are:</p>
<table class="responsive">
<thead>
<tr>
<th>Option</th>
<th>I18n key</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:two_words_connector</code></td>
<td><code>support.array.two_words_connector</code></td>
</tr>
<tr>
<td><code>:words_connector</code></td>
<td><code>support.array.words_connector</code></td>
</tr>
<tr>
<td><code>:last_word_connector</code></td>
<td><code>support.array.last_word_connector</code></td>
</tr>
</tbody>
</table>
<div class="note"><p>Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p></div><h5 id="extensions-to-array-conversions-to-formatted-s">10.4.2 <code>to_formatted_s</code>
</h5><p>The method <code>to_formatted_s</code> acts like <code>to_s</code> by default.</p><p>If the array contains items that respond to <code>id</code>, however, the symbol
<code>:db</code> may be passed as argument. That's typically used with
collections of Active Record objects. Returned strings are:</p><div class="code_container">
<div><div id="highlighter_256322" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[].to_formatted_s(</code><code class="ruby color2">:db</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "null"</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[user].to_formatted_s(</code><code class="ruby color2">:db</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; "8456"</code></div><div class="line number3 index2 alt2"><code class="ruby plain">invoice.lines.to_formatted_s(</code><code class="ruby color2">:db</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; "23,567,556,12"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Integers in the example above are supposed to come from the respective calls to <code>id</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p></div><h5 id="extensions-to-array-conversions-to-xml">10.4.3 <code>to_xml</code>
</h5><p>The method <code>to_xml</code> returns a string containing an XML representation of its receiver:</p><div class="code_container">
<div><div id="highlighter_180780" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Contributor.limit(</code><code class="ruby constants">2</code><code class="ruby plain">).order(</code><code class="ruby color2">:rank</code><code class="ruby plain">).to_xml</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># &lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># &lt;contributors type="array"&gt;</code></div><div class="line number5 index4 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;contributor&gt;</code></div><div class="line number6 index5 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;id type="integer"&gt;4356&lt;/id&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;name&gt;Jeremy Kemper&lt;/name&gt;</code></div><div class="line number8 index7 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;rank type="integer"&gt;1&lt;/rank&gt;</code></div><div class="line number9 index8 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-id&gt;jeremy-kemper&lt;/url-id&gt;</code></div><div class="line number10 index9 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/contributor&gt;</code></div><div class="line number11 index10 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;contributor&gt;</code></div><div class="line number12 index11 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;id type="integer"&gt;4404&lt;/id&gt;</code></div><div class="line number13 index12 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;name&gt;David Heinemeier Hansson&lt;/name&gt;</code></div><div class="line number14 index13 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;rank type="integer"&gt;2&lt;/rank&gt;</code></div><div class="line number15 index14 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-id&gt;david-heinemeier-hansson&lt;/url-id&gt;</code></div><div class="line number16 index15 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/contributor&gt;</code></div><div class="line number17 index16 alt2"><code class="ruby comments"># &lt;/contributors&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>To do so it sends <code>to_xml</code> to every item in turn, and collects the results under a root node. All items must respond to <code>to_xml</code>, an exception is raised otherwise.</p><p>By
 default, the name of the root element is the underscorized and 
dasherized plural of the name of the class of the first item, provided 
the rest of elements belong to that type (checked with <code>is_a?</code>) and they are not hashes. In the example above that's "contributors".</p><p>If there's any element that does not belong to the type of the first one the root node becomes "objects":</p><div class="code_container">
<div><div id="highlighter_15823" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[Contributor.first, Commit.first].to_xml</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># &lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># &lt;objects type="array"&gt;</code></div><div class="line number5 index4 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;object&gt;</code></div><div class="line number6 index5 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;id type="integer"&gt;4583&lt;/id&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;name&gt;Aaron Batalion&lt;/name&gt;</code></div><div class="line number8 index7 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;rank type="integer"&gt;53&lt;/rank&gt;</code></div><div class="line number9 index8 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-id&gt;aaron-batalion&lt;/url-id&gt;</code></div><div class="line number10 index9 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/object&gt;</code></div><div class="line number11 index10 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;object&gt;</code></div><div class="line number12 index11 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;author&gt;Joshua Peek&lt;/author&gt;</code></div><div class="line number13 index12 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;authored-timestamp type="datetime"&gt;2009-09-02T16:44:36Z&lt;/authored-timestamp&gt;</code></div><div class="line number14 index13 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;branch&gt;origin/master&lt;/branch&gt;</code></div><div class="line number15 index14 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;committed-timestamp type="datetime"&gt;2009-09-02T16:44:36Z&lt;/committed-timestamp&gt;</code></div><div class="line number16 index15 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;committer&gt;Joshua Peek&lt;/committer&gt;</code></div><div class="line number17 index16 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;git-show nil="true"&gt;&lt;/git-show&gt;</code></div><div class="line number18 index17 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;id type="integer"&gt;190316&lt;/id&gt;</code></div><div class="line number19 index18 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;imported-from-svn type="boolean"&gt;false&lt;/imported-from-svn&gt;</code></div><div class="line number20 index19 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;message&gt;Kill AMo observing wrap_with_notifications since ARes was only using it&lt;/message&gt;</code></div><div class="line number21 index20 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;sha1&gt;723a47bfb3708f968821bc969a9a3fc873a3ed58&lt;/sha1&gt;</code></div><div class="line number22 index21 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/object&gt;</code></div><div class="line number23 index22 alt2"><code class="ruby comments"># &lt;/objects&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the receiver is an array of hashes the root element is by default also "objects":</p><div class="code_container">
<div><div id="highlighter_503731" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">}, {c: </code><code class="ruby constants">3</code><code class="ruby plain">}].to_xml</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># &lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># &lt;objects type="array"&gt;</code></div><div class="line number5 index4 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;object&gt;</code></div><div class="line number6 index5 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;b type="integer"&gt;2&lt;/b&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;a type="integer"&gt;1&lt;/a&gt;</code></div><div class="line number8 index7 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/object&gt;</code></div><div class="line number9 index8 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;object&gt;</code></div><div class="line number10 index9 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;c type="integer"&gt;3&lt;/c&gt;</code></div><div class="line number11 index10 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;/object&gt;</code></div><div class="line number12 index11 alt1"><code class="ruby comments"># &lt;/objects&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>If the collection is empty the root element is 
by default "nil-classes". That's a gotcha, for example the root element 
of the list of contributors above would not be "contributors" if the 
collection was empty, but "nil-classes". You may use the <code>:root</code> option to ensure a consistent root element.</p></div><p>The
 name of children nodes is by default the name of the root node 
singularized. In the examples above we've seen "contributor" and 
"object". The option <code>:children</code> allows you to set these node names.</p><p>The default XML builder is a fresh instance of <code>Builder::XmlMarkup</code>. You can configure your own builder via the <code>:builder</code> option. The method also accepts options like <code>:dasherize</code> and friends, they are forwarded to the builder:</p><div class="code_container">
<div><div id="highlighter_127809" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Contributor.limit(</code><code class="ruby constants">2</code><code class="ruby plain">).order(</code><code class="ruby color2">:rank</code><code class="ruby plain">).to_xml(skip_types: </code><code class="ruby keyword">true</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># &lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># &lt;contributors&gt;</code></div><div class="line number5 index4 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;contributor&gt;</code></div><div class="line number6 index5 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;id&gt;4356&lt;/id&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;name&gt;Jeremy Kemper&lt;/name&gt;</code></div><div class="line number8 index7 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;rank&gt;1&lt;/rank&gt;</code></div><div class="line number9 index8 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-id&gt;jeremy-kemper&lt;/url-id&gt;</code></div><div class="line number10 index9 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/contributor&gt;</code></div><div class="line number11 index10 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;contributor&gt;</code></div><div class="line number12 index11 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;id&gt;4404&lt;/id&gt;</code></div><div class="line number13 index12 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;name&gt;David Heinemeier Hansson&lt;/name&gt;</code></div><div class="line number14 index13 alt1"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;rank&gt;2&lt;/rank&gt;</code></div><div class="line number15 index14 alt2"><code class="ruby comments">#&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-id&gt;david-heinemeier-hansson&lt;/url-id&gt;</code></div><div class="line number16 index15 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;/contributor&gt;</code></div><div class="line number17 index16 alt2"><code class="ruby comments"># &lt;/contributors&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/array/conversions.rb</code>.</p></div><h4 id="wrapping">10.5 Wrapping</h4><p>The method <code>Array.wrap</code> wraps its argument in an array unless it is already an array (or array-like).</p><p>Specifically:</p>
<ul>
<li>If the argument is <code>nil</code> an empty array is returned.</li>
<li>Otherwise, if the argument responds to <code>to_ary</code> it is invoked, and if the value of <code>to_ary</code> is not <code>nil</code>, it is returned.</li>
<li>Otherwise, an array with the argument as its single element is returned.</li>
</ul>
<div class="code_container">
<div><div id="highlighter_920229" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Array</code><code class="ruby plain">.wrap(</code><code class="ruby keyword">nil</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; []</code></div><div class="line number2 index1 alt1"><code class="ruby color1">Array</code><code class="ruby plain">.wrap([</code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">]) </code><code class="ruby comments"># =&gt; [1, 2, 3]</code></div><div class="line number3 index2 alt2"><code class="ruby color1">Array</code><code class="ruby plain">.wrap(</code><code class="ruby constants">0</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [0]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method is similar in purpose to <code>Kernel#Array</code>, but there are some differences:</p>
<ul>
<li>If the argument responds to <code>to_ary</code> the method is invoked. <code>Kernel#Array</code> moves on to try <code>to_a</code> if the returned value is <code>nil</code>, but <code>Array.wrap</code> returns an array with the argument as its single element right away.</li>
<li>If the returned value from <code>to_ary</code> is neither <code>nil</code> nor an <code>Array</code> object, <code>Kernel#Array</code> raises an exception, while <code>Array.wrap</code> does not, it just returns the value.</li>
<li>It does not call <code>to_a</code> on the argument, if the argument does not respond to +to_ary+ it returns an array with the argument as its single element.</li>
</ul>
<p>The last point is particularly worth comparing for some enumerables:</p><div class="code_container">
<div><div id="highlighter_816784" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Array</code><code class="ruby plain">.wrap(foo: </code><code class="ruby color2">:bar</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; [{:foo=&gt;:bar}]</code></div><div class="line number2 index1 alt1"><code class="ruby color1">Array</code><code class="ruby plain">(foo: </code><code class="ruby color2">:bar</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; [[:foo, :bar]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>There's also a related idiom that uses the splat operator:</p><div class="code_container">
<div><div id="highlighter_498650" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[*object]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>which in Ruby 1.8 returns <code>[nil]</code> for <code>nil</code>, and calls to <code>Array(object)</code> otherwise. (Please if you know the exact behavior in 1.9 contact fxn.)</p><p>Thus, in this case the behavior is different for <code>nil</code>, and the differences with <code>Kernel#Array</code> explained above apply to the rest of <code>object</code>s.</p><div class="note"><p>Defined in <code>active_support/core_ext/array/wrap.rb</code>.</p></div><h4 id="duplicating">10.6 Duplicating</h4><p>The method <code>Array#deep_dup</code> duplicates itself and all objects inside
recursively with Active Support method <code>Object#deep_dup</code>. It works like <code>Array#map</code> with sending <code>deep_dup</code> method to each object inside.</p><div class="code_container">
<div><div id="highlighter_896537" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">array = [</code><code class="ruby constants">1</code><code class="ruby plain">, [</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">]]</code></div><div class="line number2 index1 alt1"><code class="ruby plain">dup = array.deep_dup</code></div><div class="line number3 index2 alt2"><code class="ruby plain">dup[</code><code class="ruby constants">1</code><code class="ruby plain">][</code><code class="ruby constants">2</code><code class="ruby plain">] = </code><code class="ruby constants">4</code></div><div class="line number4 index3 alt1"><code class="ruby plain">array[</code><code class="ruby constants">1</code><code class="ruby plain">][</code><code class="ruby constants">2</code><code class="ruby plain">] == </code><code class="ruby keyword">nil</code>&nbsp;&nbsp; <code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p></div><h4 id="grouping">10.7 Grouping</h4><h5 id="in-groups-of-number-fill-with-nil">10.7.1 <code>in_groups_of(number, fill_with = nil)</code>
</h5><p>The method <code>in_groups_of</code> splits an array into consecutive groups of a certain size. It returns an array with the groups:</p><div class="code_container">
<div><div id="highlighter_959663" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">].in_groups_of(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; [[1, 2], [3, nil]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>or yields them in turn if a block is passed:</p><div class="code_container">
<div><div id="highlighter_442558" class="syntaxhighlighter nogutter  htmlscript"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby script">&lt;%</code> <code class="ruby plain">sample.in_groups_of(</code><code class="ruby constants">3</code><code class="ruby plain">) </code><code class="ruby keyword">do</code> <code class="ruby plain">|a, b, c| </code><code class="ruby script">%&gt;</code></div><div class="line number2 index1 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">tr</code><code class="htmlscript plain">&gt;</code></div><div class="line number3 index2 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">td</code><code class="ruby plain">&gt;</code><code class="ruby script">&lt;%=</code> <code class="ruby plain">a </code><code class="ruby script">%&gt;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">td</code><code class="htmlscript plain">&gt;</code></div><div class="line number4 index3 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">td</code><code class="ruby plain">&gt;</code><code class="ruby script">&lt;%=</code> <code class="ruby plain">b </code><code class="ruby script">%&gt;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">td</code><code class="htmlscript plain">&gt;</code></div><div class="line number5 index4 alt2"><code class="htmlscript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;</code><code class="htmlscript keyword">td</code><code class="ruby plain">&gt;</code><code class="ruby script">&lt;%=</code> <code class="ruby plain">c </code><code class="ruby script">%&gt;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">td</code><code class="htmlscript plain">&gt;</code></div><div class="line number6 index5 alt1"><code class="htmlscript spaces">&nbsp;&nbsp;</code><code class="htmlscript plain">&lt;/</code><code class="htmlscript keyword">tr</code><code class="ruby plain">&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby script">&lt;%</code> <code class="ruby keyword">end</code> <code class="ruby script">%&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The first example shows <code>in_groups_of</code> fills the last group with as many <code>nil</code> elements as needed to have the requested size. You can change this padding value using the second optional argument:</p><div class="code_container">
<div><div id="highlighter_584525" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">].in_groups_of(</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">0</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; [[1, 2], [3, 0]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>And you can tell the method not to fill the last group passing <code>false</code>:</p><div class="code_container">
<div><div id="highlighter_822846" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">].in_groups_of(</code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby keyword">false</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; [[1, 2], [3]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As a consequence <code>false</code> can't be a used as a padding value.</p><div class="note"><p>Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p></div><h5 id="in-groups-number-fill-with-nil">10.7.2 <code>in_groups(number, fill_with = nil)</code>
</h5><p>The method <code>in_groups</code> splits an array into a certain number of groups. The method returns an array with the groups:</p><div class="code_container">
<div><div id="highlighter_597421" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(</code><code class="ruby constants">1</code> <code class="ruby constants">2</code> <code class="ruby constants">3</code> <code class="ruby constants">4</code> <code class="ruby constants">5</code> <code class="ruby constants">6</code> <code class="ruby constants">7</code><code class="ruby plain">).in_groups(</code><code class="ruby constants">3</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; [["1", "2", "3"], ["4", "5", nil], ["6", "7", nil]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>or yields them in turn if a block is passed:</p><div class="code_container">
<div><div id="highlighter_131569" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(</code><code class="ruby constants">1</code> <code class="ruby constants">2</code> <code class="ruby constants">3</code> <code class="ruby constants">4</code> <code class="ruby constants">5</code> <code class="ruby constants">6</code> <code class="ruby constants">7</code><code class="ruby plain">).in_groups(</code><code class="ruby constants">3</code><code class="ruby plain">) {|group| p group}</code></div><div class="line number2 index1 alt1"><code class="ruby plain">[</code><code class="ruby string">"1"</code><code class="ruby plain">, </code><code class="ruby string">"2"</code><code class="ruby plain">, </code><code class="ruby string">"3"</code><code class="ruby plain">]</code></div><div class="line number3 index2 alt2"><code class="ruby plain">[</code><code class="ruby string">"4"</code><code class="ruby plain">, </code><code class="ruby string">"5"</code><code class="ruby plain">, </code><code class="ruby keyword">nil</code><code class="ruby plain">]</code></div><div class="line number4 index3 alt1"><code class="ruby plain">[</code><code class="ruby string">"6"</code><code class="ruby plain">, </code><code class="ruby string">"7"</code><code class="ruby plain">, </code><code class="ruby keyword">nil</code><code class="ruby plain">]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The examples above show that <code>in_groups</code> fills some groups with a trailing <code>nil</code>
 element as needed. A group can get at most one of these extra elements,
 the rightmost one if any. And the groups that have them are always the 
last ones.</p><p>You can change this padding value using the second optional argument:</p><div class="code_container">
<div><div id="highlighter_983750" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(</code><code class="ruby constants">1</code> <code class="ruby constants">2</code> <code class="ruby constants">3</code> <code class="ruby constants">4</code> <code class="ruby constants">5</code> <code class="ruby constants">6</code> <code class="ruby constants">7</code><code class="ruby plain">).in_groups(</code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby string">"0"</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; [["1", "2", "3"], ["4", "5", "0"], ["6", "7", "0"]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>And you can tell the method not to fill the smaller groups passing <code>false</code>:</p><div class="code_container">
<div><div id="highlighter_17021" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%w(</code><code class="ruby constants">1</code> <code class="ruby constants">2</code> <code class="ruby constants">3</code> <code class="ruby constants">4</code> <code class="ruby constants">5</code> <code class="ruby constants">6</code> <code class="ruby constants">7</code><code class="ruby plain">).in_groups(</code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby keyword">false</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; [["1", "2", "3"], ["4", "5"], ["6", "7"]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As a consequence <code>false</code> can't be a used as a padding value.</p><div class="note"><p>Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p></div><h5 id="split-value-nil">10.7.3 <code>split(value = nil)</code>
</h5><p>The method <code>split</code> divides an array by a separator and returns the resulting chunks.</p><p>If a block is passed the separators are those elements of the array for which the block returns true:</p><div class="code_container">
<div><div id="highlighter_447354" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">(-</code><code class="ruby constants">5</code><code class="ruby plain">..</code><code class="ruby constants">5</code><code class="ruby plain">).to_a.split { |i| i.multiple_of?(</code><code class="ruby constants">4</code><code class="ruby plain">) }</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; [[-5], [-3, -2, -1], [1, 2, 3], [5]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Otherwise, the value received as argument, which defaults to <code>nil</code>, is the separator:</p><div class="code_container">
<div><div id="highlighter_907310" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">[</code><code class="ruby constants">0</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">, -</code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby string">"foo"</code><code class="ruby plain">, </code><code class="ruby string">"bar"</code><code class="ruby plain">].split(</code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; [[0], [-5], [], ["foo", "bar"]]</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="info"><p>Observe in the previous example that consecutive separators result in empty arrays.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/array/grouping.rb</code>.</p></div><h3 id="extensions-to-hash">11 Extensions to <code>Hash</code>
</h3><h4 id="extensions-to-hash-conversions">11.1 Conversions</h4><h5 id="conversions-to-xml">11.1.1 <code>to_xml</code>
</h5><p>The method <code>to_xml</code> returns a string containing an XML representation of its receiver:</p><div class="code_container">
<div><div id="highlighter_182316" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby string">"foo"</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby string">"bar"</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">2</code><code class="ruby plain">}.to_xml</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># &lt;?xml version="1.0" encoding="UTF-8"?&gt;</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># &lt;hash&gt;</code></div><div class="line number5 index4 alt2"><code class="ruby comments">#&nbsp;&nbsp; &lt;foo type="integer"&gt;1&lt;/foo&gt;</code></div><div class="line number6 index5 alt1"><code class="ruby comments">#&nbsp;&nbsp; &lt;bar type="integer"&gt;2&lt;/bar&gt;</code></div><div class="line number7 index6 alt2"><code class="ruby comments"># &lt;/hash&gt;</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>To do so, the method loops over the pairs and builds nodes that depend on the <em>values</em>. Given a pair <code>key</code>, <code>value</code>:</p>
<ul>
<li><p>If <code>value</code> is a hash there's a recursive call with <code>key</code> as <code>:root</code>.</p></li>
<li><p>If <code>value</code> is an array there's a recursive call with <code>key</code> as <code>:root</code>, and <code>key</code> singularized as <code>:children</code>.</p></li>
<li><p>If <code>value</code> is a callable object it must expect one or two arguments. Depending on the arity, the callable is invoked with the <code>options</code> hash as first argument with <code>key</code> as <code>:root</code>, and <code>key</code> singularized as second argument. Its return value becomes a new node.</p></li>
<li><p>If <code>value</code> responds to <code>to_xml</code> the method is invoked with <code>key</code> as <code>:root</code>.</p></li>
<li><p>Otherwise, a node with <code>key</code> as tag is created with a string representation of <code>value</code> as text node. If <code>value</code> is <code>nil</code> an attribute "nil" set to "true" is added. Unless the option <code>:skip_types</code> exists and is true, an attribute "type" is added as well according to the following mapping:</p></li>
</ul>
<div class="code_container">
<div><div id="highlighter_613648" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby constants">XML_TYPE_NAMES</code> <code class="ruby plain">= {</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"Symbol"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"symbol"</code><code class="ruby plain">,</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"Fixnum"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"integer"</code><code class="ruby plain">,</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"Bignum"</code>&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"integer"</code><code class="ruby plain">,</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"BigDecimal"</code> <code class="ruby plain">=&gt; </code><code class="ruby string">"decimal"</code><code class="ruby plain">,</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"Float"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"float"</code><code class="ruby plain">,</code></div><div class="line number7 index6 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"TrueClass"</code>&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"boolean"</code><code class="ruby plain">,</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"FalseClass"</code> <code class="ruby plain">=&gt; </code><code class="ruby string">"boolean"</code><code class="ruby plain">,</code></div><div class="line number9 index8 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"Date"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"date"</code><code class="ruby plain">,</code></div><div class="line number10 index9 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"DateTime"</code>&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"datetime"</code><code class="ruby plain">,</code></div><div class="line number11 index10 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby string">"Time"</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby plain">=&gt; </code><code class="ruby string">"datetime"</code></div><div class="line number12 index11 alt1"><code class="ruby plain">}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>By default the root node is "hash", but that's configurable via the <code>:root</code> option.</p><p>The default XML builder is a fresh instance of <code>Builder::XmlMarkup</code>. You can configure your own builder with the <code>:builder</code> option. The method also accepts options like <code>:dasherize</code> and friends, they are forwarded to the builder.</p><div class="note"><p>Defined in <code>active_support/core_ext/hash/conversions.rb</code>.</p></div><h4 id="merging">11.2 Merging</h4><p>Ruby has a built-in method <code>Hash#merge</code> that merges two hashes:</p><div class="code_container">
<div><div id="highlighter_277477" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">1</code><code class="ruby plain">}.merge(a: </code><code class="ruby constants">0</code><code class="ruby plain">, c: </code><code class="ruby constants">2</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {:a=&gt;0, :b=&gt;1, :c=&gt;2}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Support defines a few more ways of merging hashes that may be convenient.</p><h5 id="reverse-merge-and-reverse-merge-bang">11.2.1 <code>reverse_merge</code> and <code>reverse_merge!</code>
</h5><p>In case of collision the key in the hash of the argument wins in <code>merge</code>. You can support option hashes with default values in a compact way with this idiom:</p><div class="code_container">
<div><div id="highlighter_271955" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">options = {length: </code><code class="ruby constants">30</code><code class="ruby plain">, omission: </code><code class="ruby string">"..."</code><code class="ruby plain">}.merge(options)</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Support defines <code>reverse_merge</code> in case you prefer this alternative notation:</p><div class="code_container">
<div><div id="highlighter_588554" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">options = options.reverse_merge(length: </code><code class="ruby constants">30</code><code class="ruby plain">, omission: </code><code class="ruby string">"..."</code><code class="ruby plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>And a bang version <code>reverse_merge!</code> that performs the merge in place:</p><div class="code_container">
<div><div id="highlighter_999502" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">options.reverse_merge!(length: </code><code class="ruby constants">30</code><code class="ruby plain">, omission: </code><code class="ruby string">"..."</code><code class="ruby plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>Take into account that <code>reverse_merge!</code> may change the hash in the caller, which may or may not be a good idea.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/hash/reverse_merge.rb</code>.</p></div><h5 id="reverse-update">11.2.2 <code>reverse_update</code>
</h5><p>The method <code>reverse_update</code> is an alias for <code>reverse_merge!</code>, explained above.</p><div class="warning"><p>Note that <code>reverse_update</code> has no bang.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/hash/reverse_merge.rb</code>.</p></div><h5 id="deep-merge-and-deep-merge-bang">11.2.3 <code>deep_merge</code> and <code>deep_merge!</code>
</h5><p>As you can see in the previous example if a key is found in both hashes the value in the one in the argument wins.</p><p>Active Support defines <code>Hash#deep_merge</code>. In a deep merge, if a key is found in both hashes and their values are hashes in turn, then their <em>merge</em> becomes the value in the resulting hash:</p><div class="code_container">
<div><div id="highlighter_523167" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: {b: </code><code class="ruby constants">1</code><code class="ruby plain">}}.deep_merge(a: {c: </code><code class="ruby constants">2</code><code class="ruby plain">})</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {:a=&gt;{:b=&gt;1, :c=&gt;2}}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>deep_merge!</code> performs a deep merge in place.</p><div class="note"><p>Defined in <code>active_support/core_ext/hash/deep_merge.rb</code>.</p></div><h4 id="deep-duplicating">11.3 Deep duplicating</h4><p>The method <code>Hash#deep_dup</code> duplicates itself and all keys and values
inside recursively with Active Support method <code>Object#deep_dup</code>. It works like <code>Enumerator#each_with_object</code> with sending <code>deep_dup</code> method to each pair inside.</p><div class="code_container">
<div><div id="highlighter_565701" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">hash = { a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: { c: </code><code class="ruby constants">2</code><code class="ruby plain">, d: [</code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">] } }</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="ruby plain">dup = hash.deep_dup</code></div><div class="line number4 index3 alt1"><code class="ruby plain">dup[</code><code class="ruby color2">:b</code><code class="ruby plain">][</code><code class="ruby color2">:e</code><code class="ruby plain">] = </code><code class="ruby constants">5</code></div><div class="line number5 index4 alt2"><code class="ruby plain">dup[</code><code class="ruby color2">:b</code><code class="ruby plain">][</code><code class="ruby color2">:d</code><code class="ruby plain">] &lt;&lt; </code><code class="ruby constants">5</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="ruby plain">hash[</code><code class="ruby color2">:b</code><code class="ruby plain">][</code><code class="ruby color2">:e</code><code class="ruby plain">] == </code><code class="ruby keyword">nil</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code class="ruby comments"># =&gt; true</code></div><div class="line number8 index7 alt1"><code class="ruby plain">hash[</code><code class="ruby color2">:b</code><code class="ruby plain">][</code><code class="ruby color2">:d</code><code class="ruby plain">] == [</code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">]&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/object/deep_dup.rb</code>.</p></div><h4 id="working-with-keys">11.4 Working with Keys</h4><h5 id="except-and-except-bang">11.4.1 <code>except</code> and <code>except!</code>
</h5><p>The method <code>except</code> returns a hash with the keys in the argument list removed, if present:</p><div class="code_container">
<div><div id="highlighter_373753" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">}.except(</code><code class="ruby color2">:a</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; {:b=&gt;2}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the receiver responds to <code>convert_key</code>, the method is called on each of the arguments. This allows <code>except</code> to play nice with hashes with indifferent access for instance:</p><div class="code_container">
<div><div id="highlighter_766876" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">}.with_indifferent_access.except(</code><code class="ruby color2">:a</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; {}</code></div><div class="line number2 index1 alt1"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">}.with_indifferent_access.except(</code><code class="ruby string">"a"</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; {}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>There's also the bang variant <code>except!</code> that removes keys in the very receiver.</p><div class="note"><p>Defined in <code>active_support/core_ext/hash/except.rb</code>.</p></div><h5 id="transform-keys-and-transform-keys-bang">11.4.2 <code>transform_keys</code> and <code>transform_keys!</code>
</h5><p>The method <code>transform_keys</code> accepts a block and returns a hash that has applied the block operations to each of the keys in the receiver:</p><div class="code_container">
<div><div id="highlighter_103111" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, a: </code><code class="ruby color2">:a</code><code class="ruby plain">}.transform_keys { |key| key.to_s.upcase }</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {"" =&gt; nil, "A" =&gt; :a, "1" =&gt; 1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In case of key collision, one of the values will be chosen. The chosen value may not always be the same given the same hash:</p><div class="code_container">
<div><div id="highlighter_156430" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby string">"a"</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, a: </code><code class="ruby constants">2</code><code class="ruby plain">}.transform_keys { |key| key.to_s.upcase }</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># The result could either be</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># =&gt; {"A"=&gt;2}</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># or</code></div><div class="line number5 index4 alt2"><code class="ruby comments"># =&gt; {"A"=&gt;1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method may be useful for example to build specialized conversions. For instance <code>stringify_keys</code> and <code>symbolize_keys</code> use <code>transform_keys</code> to perform their key conversions:</p><div class="code_container">
<div><div id="highlighter_103839" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">stringify_keys</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">transform_keys { |key| key.to_s }</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div><div class="line number4 index3 alt1"><code class="ruby plain">...</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">symbolize_keys</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">transform_keys { |key| key.to_sym </code><code class="ruby keyword">rescue</code> <code class="ruby plain">key }</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>There's also the bang variant <code>transform_keys!</code> that applies the block operations to keys in the very receiver.</p><p>Besides that, one can use <code>deep_transform_keys</code> and <code>deep_transform_keys!</code>
 to perform the block operation on all the keys in the given hash and 
all the hashes nested into it. An example of the result is:</p><div class="code_container">
<div><div id="highlighter_807430" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, nested: {a: </code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">5</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">5</code><code class="ruby plain">}}.deep_transform_keys { |key| key.to_s.upcase }</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {""=&gt;nil, "1"=&gt;1, "NESTED"=&gt;{"A"=&gt;3, "5"=&gt;5}}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p></div><h5 id="stringify-keys-and-stringify-keys-bang">11.4.3 <code>stringify_keys</code> and <code>stringify_keys!</code>
</h5><p>The method <code>stringify_keys</code> returns a hash that has a stringified version of the keys in the receiver. It does so by sending <code>to_s</code> to them:</p><div class="code_container">
<div><div id="highlighter_698436" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, a: </code><code class="ruby color2">:a</code><code class="ruby plain">}.stringify_keys</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {"" =&gt; nil, "a" =&gt; :a, "1" =&gt; 1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>In case of key collision, one of the values will be chosen. The chosen value may not always be the same given the same hash:</p><div class="code_container">
<div><div id="highlighter_8057" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby string">"a"</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, a: </code><code class="ruby constants">2</code><code class="ruby plain">}.stringify_keys</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># The result could either be</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># =&gt; {"a"=&gt;2}</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># or</code></div><div class="line number5 index4 alt2"><code class="ruby comments"># =&gt; {"a"=&gt;1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method may be useful for example to easily accept both symbols and strings as options. For instance <code>ActionView::Helpers::FormHelper</code> defines:</p><div class="code_container">
<div><div id="highlighter_569103" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">to_check_box_tag(options = {}, checked_value = </code><code class="ruby string">"1"</code><code class="ruby plain">, unchecked_value = </code><code class="ruby string">"0"</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">options = options.stringify_keys</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">options[</code><code class="ruby string">"type"</code><code class="ruby plain">] = </code><code class="ruby string">"checkbox"</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The second line can safely access the "type" key, and let the user to pass either <code>:type</code> or "type".</p><p>There's also the bang variant <code>stringify_keys!</code> that stringifies keys in the very receiver.</p><p>Besides that, one can use <code>deep_stringify_keys</code> and <code>deep_stringify_keys!</code> to stringify all the keys in the given hash and all the hashes nested into it. An example of the result is:</p><div class="code_container">
<div><div id="highlighter_236022" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, nested: {a: </code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">5</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">5</code><code class="ruby plain">}}.deep_stringify_keys</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {""=&gt;nil, "1"=&gt;1, "nested"=&gt;{"a"=&gt;3, "5"=&gt;5}}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p></div><h5 id="symbolize-keys-and-symbolize-keys-bang">11.4.4 <code>symbolize_keys</code> and <code>symbolize_keys!</code>
</h5><p>The method <code>symbolize_keys</code> returns a hash that has a symbolized version of the keys in the receiver, where possible. It does so by sending <code>to_sym</code> to them:</p><div class="code_container">
<div><div id="highlighter_968929" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby string">"a"</code> <code class="ruby plain">=&gt; </code><code class="ruby string">"a"</code><code class="ruby plain">}.symbolize_keys</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {1=&gt;1, nil=&gt;nil, :a=&gt;"a"}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>Note in the previous example only one key was symbolized.</p></div><p>In case of key collision, one of the values will be chosen. The chosen value may not always be the same given the same hash:</p><div class="code_container">
<div><div id="highlighter_590965" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby string">"a"</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, a: </code><code class="ruby constants">2</code><code class="ruby plain">}.symbolize_keys</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># The result could either be</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># =&gt; {:a=&gt;2}</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># or</code></div><div class="line number5 index4 alt2"><code class="ruby comments"># =&gt; {:a=&gt;1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method may be useful for example to easily accept both symbols and strings as options. For instance <code>ActionController::UrlRewriter</code> defines</p><div class="code_container">
<div><div id="highlighter_298109" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">rewrite_path(options)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">options = options.symbolize_keys</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">options.update(options[</code><code class="ruby color2">:params</code><code class="ruby plain">].symbolize_keys) </code><code class="ruby keyword">if</code> <code class="ruby plain">options[</code><code class="ruby color2">:params</code><code class="ruby plain">]</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The second line can safely access the <code>:params</code> key, and let the user to pass either <code>:params</code> or "params".</p><p>There's also the bang variant <code>symbolize_keys!</code> that symbolizes keys in the very receiver.</p><p>Besides that, one can use <code>deep_symbolize_keys</code> and <code>deep_symbolize_keys!</code> to symbolize all the keys in the given hash and all the hashes nested into it. An example of the result is:</p><div class="code_container">
<div><div id="highlighter_639696" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{</code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby string">"nested"</code> <code class="ruby plain">=&gt; {</code><code class="ruby string">"a"</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">5</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">5</code><code class="ruby plain">}}.deep_symbolize_keys</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {nil=&gt;nil, 1=&gt;1, nested:{a:3, 5=&gt;5}}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p></div><h5 id="to-options-and-to-options-bang">11.4.5 <code>to_options</code> and <code>to_options!</code>
</h5><p>The methods <code>to_options</code> and <code>to_options!</code> are respectively aliases of <code>symbolize_keys</code> and <code>symbolize_keys!</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p></div><h5 id="assert-valid-keys">11.4.6 <code>assert_valid_keys</code>
</h5><p>The method <code>assert_valid_keys</code> receives an arbitrary number of arguments, and checks whether the receiver has any key outside that white list. If it does <code>ArgumentError</code> is raised.</p><div class="code_container">
<div><div id="highlighter_274977" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">}.assert_valid_keys(</code><code class="ruby color2">:a</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># passes</code></div><div class="line number2 index1 alt1"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">}.assert_valid_keys(</code><code class="ruby string">"a"</code><code class="ruby plain">) </code><code class="ruby comments"># ArgumentError</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Record does not accept unknown options when building associations, for example. It implements that control via <code>assert_valid_keys</code>.</p><div class="note"><p>Defined in <code>active_support/core_ext/hash/keys.rb</code>.</p></div><h4 id="working-with-values">11.5 Working with Values</h4><h5 id="transform-values-transform-values-bang">11.5.1 <code>transform_values</code> &amp;&amp; <code>transform_values!</code>
</h5><p>The method <code>transform_values</code> accepts a block and returns a hash that has applied the block operations to each of the values in the receiver.</p><div class="code_container">
<div><div id="highlighter_544247" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{ </code><code class="ruby keyword">nil</code> <code class="ruby plain">=&gt; </code><code class="ruby keyword">nil</code><code class="ruby plain">, </code><code class="ruby constants">1</code> <code class="ruby plain">=&gt; </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby color2">:x</code> <code class="ruby plain">=&gt; </code><code class="ruby color2">:a</code> <code class="ruby plain">}.transform_values { |value| value.to_s.upcase }</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {nil=&gt;"", 1=&gt;"1", :x=&gt;"A"}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>There's also the bang variant <code>transform_values!</code> that applies the block operations to values in the very receiver.</p><div class="note"><p>Defined in <code>active_support/core_ext/hash/transform_values.rb</code>.</p></div><h4 id="slicing">11.6 Slicing</h4><p>Ruby has built-in support for taking slices out of strings and arrays. Active Support extends slicing to hashes:</p><div class="code_container">
<div><div id="highlighter_602242" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">, c: </code><code class="ruby constants">3</code><code class="ruby plain">}.slice(</code><code class="ruby color2">:a</code><code class="ruby plain">, </code><code class="ruby color2">:c</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {:c=&gt;3, :a=&gt;1}</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">, c: </code><code class="ruby constants">3</code><code class="ruby plain">}.slice(</code><code class="ruby color2">:b</code><code class="ruby plain">, :</code><code class="ruby constants">X</code><code class="ruby plain">)</code></div><div class="line number5 index4 alt2"><code class="ruby comments"># =&gt; {:b=&gt;2} # non-existing keys are ignored</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the receiver responds to <code>convert_key</code> keys are normalized:</p><div class="code_container">
<div><div id="highlighter_483861" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">}.with_indifferent_access.slice(</code><code class="ruby string">"a"</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; {:a=&gt;1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Slicing may come in handy for sanitizing option hashes with a white list of keys.</p></div><p>There's also <code>slice!</code> which in addition to perform a slice in place returns what's removed:</p><div class="code_container">
<div><div id="highlighter_349842" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">hash = {a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">}</code></div><div class="line number2 index1 alt1"><code class="ruby plain">rest = hash.slice!(</code><code class="ruby color2">:a</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; {:b=&gt;2}</code></div><div class="line number3 index2 alt2"><code class="ruby plain">hash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; {:a=&gt;1}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/slice.rb</code>.</p></div><h4 id="extracting">11.7 Extracting</h4><p>The method <code>extract!</code> removes and returns the key/value pairs matching the given keys.</p><div class="code_container">
<div><div id="highlighter_976970" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">hash = {a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">}</code></div><div class="line number2 index1 alt1"><code class="ruby plain">rest = hash.extract!(</code><code class="ruby color2">:a</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; {:a=&gt;1}</code></div><div class="line number3 index2 alt2"><code class="ruby plain">hash&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; {:b=&gt;2}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>extract!</code> returns the same subclass of Hash, that the receiver is.</p><div class="code_container">
<div><div id="highlighter_638961" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">hash = {a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">}.with_indifferent_access</code></div><div class="line number2 index1 alt1"><code class="ruby plain">rest = hash.extract!(</code><code class="ruby color2">:a</code><code class="ruby plain">).</code><code class="ruby keyword">class</code></div><div class="line number3 index2 alt2"><code class="ruby comments"># =&gt; ActiveSupport::HashWithIndifferentAccess</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/slice.rb</code>.</p></div><h4 id="indifferent-access">11.8 Indifferent Access</h4><p>The method <code>with_indifferent_access</code> returns an <code>ActiveSupport::HashWithIndifferentAccess</code> out of its receiver:</p><div class="code_container">
<div><div id="highlighter_375913" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">}.with_indifferent_access[</code><code class="ruby string">"a"</code><code class="ruby plain">] </code><code class="ruby comments"># =&gt; 1</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/indifferent_access.rb</code>.</p></div><h4 id="compacting">11.9 Compacting</h4><p>The methods <code>compact</code> and <code>compact!</code> return a Hash without items with <code>nil</code> value.</p><div class="code_container">
<div><div id="highlighter_24108" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">{a: </code><code class="ruby constants">1</code><code class="ruby plain">, b: </code><code class="ruby constants">2</code><code class="ruby plain">, c: </code><code class="ruby keyword">nil</code><code class="ruby plain">}.compact </code><code class="ruby comments"># =&gt; {a: 1, b: 2}</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/hash/compact.rb</code>.</p></div><h3 id="extensions-to-regexp">12 Extensions to <code>Regexp</code>
</h3><h4 id="multiline-questionmark">12.1 <code>multiline?</code>
</h4><p>The method <code>multiline?</code> says whether a regexp has the <code>/m</code> flag set, that is, whether the dot matches newlines.</p><div class="code_container">
<div><div id="highlighter_804499" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">%r{.}.multiline?&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number2 index1 alt1"><code class="ruby plain">%r{.}m.multiline? </code><code class="ruby comments"># =&gt; true</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby color1">Regexp</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby string">'.'</code><code class="ruby plain">).multiline?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number5 index4 alt2"><code class="ruby color1">Regexp</code><code class="ruby plain">.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby string">'.'</code><code class="ruby plain">, </code><code class="ruby color1">Regexp</code><code class="ruby plain">::</code><code class="ruby constants">MULTILINE</code><code class="ruby plain">).multiline? </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Rails uses this method in a single place, also in the routing code. 
Multiline regexps are disallowed for route requirements and this flag 
eases enforcing that constraint.</p><div class="code_container">
<div><div id="highlighter_904687" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">assign_route_options(segments, defaults, requirements)</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">if</code> <code class="ruby plain">requirement.multiline?</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="ruby keyword">raise</code> <code class="ruby plain">ArgumentError, </code><code class="ruby string">"Regexp multiline option not allowed in routing requirements: #{requirement.inspect}"</code></div><div class="line number5 index4 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">end</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">...</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/regexp.rb</code>.</p></div><h3 id="extensions-to-range">13 Extensions to <code>Range</code>
</h3><h4 id="extensions-to-range-to-s">13.1 <code>to_s</code>
</h4><p>Active Support extends the method <code>Range#to_s</code> so that it understands an optional format argument. As of this writing the only supported non-default format is <code>:db</code>:</p><div class="code_container">
<div><div id="highlighter_285916" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">(Date.today..Date.tomorrow).to_s</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; "2009-10-25..2009-10-26"</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby plain">(Date.today..Date.tomorrow).to_s(</code><code class="ruby color2">:db</code><code class="ruby plain">)</code></div><div class="line number5 index4 alt2"><code class="ruby comments"># =&gt; "BETWEEN '2009-10-25' AND '2009-10-26'"</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>As the example depicts, the <code>:db</code> format generates a <code>BETWEEN</code> SQL clause. That is used by Active Record in its support for range values in conditions.</p><div class="note"><p>Defined in <code>active_support/core_ext/range/conversions.rb</code>.</p></div><h4 id="include-questionmark">13.2 <code>include?</code>
</h4><p>The methods <code>Range#include?</code> and <code>Range#===</code> say whether some value falls between the ends of a given instance:</p><div class="code_container">
<div><div id="highlighter_542612" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">(</code><code class="ruby constants">2</code><code class="ruby plain">..</code><code class="ruby constants">3</code><code class="ruby plain">).include?(Math::</code><code class="ruby constants">E</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Active Support extends these methods so that the argument may be 
another range in turn. In that case we test whether the ends of the 
argument range belong to the receiver themselves:</p><div class="code_container">
<div><div id="highlighter_55946" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">).include?(</code><code class="ruby constants">3</code><code class="ruby plain">..</code><code class="ruby constants">7</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">).include?(</code><code class="ruby constants">0</code><code class="ruby plain">..</code><code class="ruby constants">7</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number3 index2 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">).include?(</code><code class="ruby constants">3</code><code class="ruby plain">..</code><code class="ruby constants">11</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; false</code></div><div class="line number4 index3 alt1"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">...</code><code class="ruby constants">9</code><code class="ruby plain">).include?(</code><code class="ruby constants">3</code><code class="ruby plain">..</code><code class="ruby constants">9</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">) === (</code><code class="ruby constants">3</code><code class="ruby plain">..</code><code class="ruby constants">7</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number7 index6 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">) === (</code><code class="ruby constants">0</code><code class="ruby plain">..</code><code class="ruby constants">7</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number8 index7 alt1"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">) === (</code><code class="ruby constants">3</code><code class="ruby plain">..</code><code class="ruby constants">11</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; false</code></div><div class="line number9 index8 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">...</code><code class="ruby constants">9</code><code class="ruby plain">) === (</code><code class="ruby constants">3</code><code class="ruby plain">..</code><code class="ruby constants">9</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/range/include_range.rb</code>.</p></div><h4 id="overlaps-questionmark">13.3 <code>overlaps?</code>
</h4><p>The method <code>Range#overlaps?</code> says whether any two given ranges have non-void intersection:</p><div class="code_container">
<div><div id="highlighter_772329" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">).overlaps?(</code><code class="ruby constants">7</code><code class="ruby plain">..</code><code class="ruby constants">11</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number2 index1 alt1"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">).overlaps?(</code><code class="ruby constants">0</code><code class="ruby plain">..</code><code class="ruby constants">7</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div><div class="line number3 index2 alt2"><code class="ruby plain">(</code><code class="ruby constants">1</code><code class="ruby plain">..</code><code class="ruby constants">10</code><code class="ruby plain">).overlaps?(</code><code class="ruby constants">11</code><code class="ruby plain">..</code><code class="ruby constants">27</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; false</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/range/overlaps.rb</code>.</p></div><h3 id="extensions-to-date">14 Extensions to <code>Date</code>
</h3><h4 id="extensions-to-date-calculations">14.1 Calculations</h4><div class="note"><p>All the following methods are defined in <code>active_support/core_ext/date/calculations.rb</code>.</p></div><div class="info"><p>The
 following calculation methods have edge cases in October 1582, since 
days 5..14 just do not exist. This guide does not document their 
behavior around those days for brevity, but it is enough to say that 
they do what you would expect. That is, <code>Date.new(1582, 10, 4).tomorrow</code> returns <code>Date.new(1582, 10, 15)</code> and so on. Please check <code>test/core_ext/date_ext_test.rb</code> in the Active Support test suite for expected behavior.</p></div><h5 id="date-current">14.1.1 <code>Date.current</code>
</h5><p>Active Support defines <code>Date.current</code> to be today in the current time zone. That's like <code>Date.today</code>, except that it honors the user time zone, if defined. It also defines <code>Date.yesterday</code> and <code>Date.tomorrow</code>, and the instance predicates <code>past?</code>, <code>today?</code>, and <code>future?</code>, all of them relative to <code>Date.current</code>.</p><p>When making Date comparisons using methods which honor the user time zone, make sure to use <code>Date.current</code> and not <code>Date.today</code>. There are cases where the user time zone might be in the future compared to the system time zone, which <code>Date.today</code> uses by default. This means <code>Date.today</code> may equal <code>Date.yesterday</code>.</p><h5 id="named-dates">14.1.2 Named dates</h5><h6 id="prev-year-next-year">14.1.2.1 <code>prev_year</code>, <code>next_year</code>
</h6><p>In Ruby 1.9 <code>prev_year</code> and <code>next_year</code> return a date with the same day/month in the last or next year:</p><div class="code_container">
<div><div id="highlighter_754670" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">8</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sat, 08 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.prev_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Fri, 08 May 2009</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.next_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 08 May 2011</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If date is the 29th of February of a leap year, you obtain the 28th:</p><div class="code_container">
<div><div id="highlighter_233899" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">29</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Tue, 29 Feb 2000</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.prev_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 28 Feb 1999</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.next_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Wed, 28 Feb 2001</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>prev_year</code> is aliased to <code>last_year</code>.</p><h6 id="prev-month-next-month">14.1.2.2 <code>prev_month</code>, <code>next_month</code>
</h6><p>In Ruby 1.9 <code>prev_month</code> and <code>next_month</code> return the date with the same day in the last or next month:</p><div class="code_container">
<div><div id="highlighter_660098" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">8</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sat, 08 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.prev_month&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Thu, 08 Apr 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.next_month&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Tue, 08 Jun 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If such a day does not exist, the last day of the corresponding month is returned:</p><div class="code_container">
<div><div id="highlighter_173838" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).prev_month </code><code class="ruby comments"># =&gt; Sun, 30 Apr 2000</code></div><div class="line number2 index1 alt1"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).prev_month </code><code class="ruby comments"># =&gt; Tue, 29 Feb 2000</code></div><div class="line number3 index2 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).next_month </code><code class="ruby comments"># =&gt; Fri, 30 Jun 2000</code></div><div class="line number4 index3 alt1"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).next_month </code><code class="ruby comments"># =&gt; Tue, 29 Feb 2000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>prev_month</code> is aliased to <code>last_month</code>.</p><h6 id="prev-quarter-next-quarter">14.1.2.3 <code>prev_quarter</code>, <code>next_quarter</code>
</h6><p>Same as <code>prev_month</code> and <code>next_month</code>. It returns the date with the same day in the previous or next quarter:</p><div class="code_container">
<div><div id="highlighter_581354" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">t = </code><code class="ruby color1">Time</code><code class="ruby plain">.local(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">8</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sat, 08 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">t.prev_quarter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 08 Feb 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">t.next_quarter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 08 Aug 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If such a day does not exist, the last day of the corresponding month is returned:</p><div class="code_container">
<div><div id="highlighter_293219" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Time</code><code class="ruby plain">.local(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).prev_quarter&nbsp; </code><code class="ruby comments"># =&gt; Sun, 30 Apr 2000</code></div><div class="line number2 index1 alt1"><code class="ruby color1">Time</code><code class="ruby plain">.local(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).prev_quarter&nbsp; </code><code class="ruby comments"># =&gt; Tue, 29 Feb 2000</code></div><div class="line number3 index2 alt2"><code class="ruby color1">Time</code><code class="ruby plain">.local(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">10</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).prev_quarter </code><code class="ruby comments"># =&gt; Mon, 30 Oct 2000</code></div><div class="line number4 index3 alt1"><code class="ruby color1">Time</code><code class="ruby plain">.local(</code><code class="ruby constants">2000</code><code class="ruby plain">, </code><code class="ruby constants">11</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).next_quarter </code><code class="ruby comments"># =&gt; Wed, 28 Feb 2001</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>prev_quarter</code> is aliased to <code>last_quarter</code>.</p><h6 id="beginning-of-week-end-of-week">14.1.2.4 <code>beginning_of_week</code>, <code>end_of_week</code>
</h6><p>The methods <code>beginning_of_week</code> and <code>end_of_week</code> return the dates for the
beginning and end of the week, respectively. Weeks are assumed to start on
Monday, but that can be changed passing an argument, setting thread local
<code>Date.beginning_of_week</code> or <code>config.beginning_of_week</code>.</p><div class="code_container">
<div><div id="highlighter_819715" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">8</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 08 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.beginning_of_week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 03 May 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.beginning_of_week(</code><code class="ruby color2">:sunday</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 02 May 2010</code></div><div class="line number4 index3 alt1"><code class="ruby plain">d.end_of_week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 09 May 2010</code></div><div class="line number5 index4 alt2"><code class="ruby plain">d.end_of_week(</code><code class="ruby color2">:sunday</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 08 May 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_week</code> is aliased to <code>at_beginning_of_week</code> and <code>end_of_week</code> is aliased to <code>at_end_of_week</code>.</p><h6 id="monday-sunday">14.1.2.5 <code>monday</code>, <code>sunday</code>
</h6><p>The methods <code>monday</code> and <code>sunday</code> return the dates for the previous Monday and
next Sunday, respectively.</p><div class="code_container">
<div><div id="highlighter_294753" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">8</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 08 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.monday&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 03 May 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.sunday&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 09 May 2010</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2012</code><code class="ruby plain">, </code><code class="ruby constants">9</code><code class="ruby plain">, </code><code class="ruby constants">10</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 10 Sep 2012</code></div><div class="line number6 index5 alt1"><code class="ruby plain">d.monday&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 10 Sep 2012</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2012</code><code class="ruby plain">, </code><code class="ruby constants">9</code><code class="ruby plain">, </code><code class="ruby constants">16</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 16 Sep 2012</code></div><div class="line number9 index8 alt2"><code class="ruby plain">d.sunday&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 16 Sep 2012</code></div></div></td></tr></tbody></table></div></div>
</div>
<h6 id="prev-week-next-week">14.1.2.6 <code>prev_week</code>, <code>next_week</code>
</h6><p>The method <code>next_week</code> receives a symbol with a day name in English (default is the thread local <code>Date.beginning_of_week</code>, or <code>config.beginning_of_week</code>, or <code>:monday</code>) and it returns the date corresponding to that day.</p><div class="code_container">
<div><div id="highlighter_476165" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">9</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 09 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.next_week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 10 May 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.next_week(</code><code class="ruby color2">:saturday</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 15 May 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>prev_week</code> is analogous:</p><div class="code_container">
<div><div id="highlighter_222307" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d.prev_week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 26 Apr 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.prev_week(</code><code class="ruby color2">:saturday</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 01 May 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.prev_week(</code><code class="ruby color2">:friday</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Fri, 30 Apr 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>prev_week</code> is aliased to <code>last_week</code>.</p><p>Both <code>next_week</code> and <code>prev_week</code> work as expected when <code>Date.beginning_of_week</code> or <code>config.beginning_of_week</code> are set.</p><h6 id="beginning-of-month-end-of-month">14.1.2.7 <code>beginning_of_month</code>, <code>end_of_month</code>
</h6><p>The methods <code>beginning_of_month</code> and <code>end_of_month</code> return the dates for the beginning and end of the month:</p><div class="code_container">
<div><div id="highlighter_717883" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">9</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 09 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.beginning_of_month&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 01 May 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.end_of_month&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 31 May 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_month</code> is aliased to <code>at_beginning_of_month</code>, and <code>end_of_month</code> is aliased to <code>at_end_of_month</code>.</p><h6 id="beginning-of-quarter-end-of-quarter">14.1.2.8 <code>beginning_of_quarter</code>, <code>end_of_quarter</code>
</h6><p>The methods <code>beginning_of_quarter</code> and <code>end_of_quarter</code> return the dates for the beginning and end of the quarter of the receiver's calendar year:</p><div class="code_container">
<div><div id="highlighter_195566" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">9</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 09 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.beginning_of_quarter&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Thu, 01 Apr 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.end_of_quarter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Wed, 30 Jun 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_quarter</code> is aliased to <code>at_beginning_of_quarter</code>, and <code>end_of_quarter</code> is aliased to <code>at_end_of_quarter</code>.</p><h6 id="beginning-of-year-end-of-year">14.1.2.9 <code>beginning_of_year</code>, <code>end_of_year</code>
</h6><p>The methods <code>beginning_of_year</code> and <code>end_of_year</code> return the dates for the beginning and end of the year:</p><div class="code_container">
<div><div id="highlighter_687706" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">9</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 09 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">d.beginning_of_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Fri, 01 Jan 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.end_of_year&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Fri, 31 Dec 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_year</code> is aliased to <code>at_beginning_of_year</code>, and <code>end_of_year</code> is aliased to <code>at_end_of_year</code>.</p><h5 id="other-date-computations">14.1.3 Other Date Computations</h5><h6 id="years-ago-years-since">14.1.3.1 <code>years_ago</code>, <code>years_since</code>
</h6><p>The method <code>years_ago</code> receives a number of years and returns the same date those many years ago:</p><div class="code_container">
<div><div id="highlighter_32673" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.years_ago(</code><code class="ruby constants">10</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Wed, 07 Jun 2000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>years_since</code> moves forward in time:</p><div class="code_container">
<div><div id="highlighter_965147" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.years_since(</code><code class="ruby constants">10</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 07 Jun 2020</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If such a day does not exist, the last day of the corresponding month is returned:</p><div class="code_container">
<div><div id="highlighter_603838" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2012</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">29</code><code class="ruby plain">).years_ago(</code><code class="ruby constants">3</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 28 Feb 2009</code></div><div class="line number2 index1 alt1"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2012</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">29</code><code class="ruby plain">).years_since(</code><code class="ruby constants">3</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sat, 28 Feb 2015</code></div></div></td></tr></tbody></table></div></div>
</div>
<h6 id="months-ago-months-since">14.1.3.2 <code>months_ago</code>, <code>months_since</code>
</h6><p>The methods <code>months_ago</code> and <code>months_since</code> work analogously for months:</p><div class="code_container">
<div><div id="highlighter_670620" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">, </code><code class="ruby constants">30</code><code class="ruby plain">).months_ago(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 28 Feb 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">, </code><code class="ruby constants">30</code><code class="ruby plain">).months_since(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Wed, 30 Jun 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If such a day does not exist, the last day of the corresponding month is returned:</p><div class="code_container">
<div><div id="highlighter_663839" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">, </code><code class="ruby constants">30</code><code class="ruby plain">).months_ago(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Sun, 28 Feb 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2009</code><code class="ruby plain">, </code><code class="ruby constants">12</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).months_since(</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Sun, 28 Feb 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<h6 id="weeks-ago">14.1.3.3 <code>weeks_ago</code>
</h6><p>The method <code>weeks_ago</code> works analogously for weeks:</p><div class="code_container">
<div><div id="highlighter_892431" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">24</code><code class="ruby plain">).weeks_ago(</code><code class="ruby constants">1</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 17 May 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">5</code><code class="ruby plain">, </code><code class="ruby constants">24</code><code class="ruby plain">).weeks_ago(</code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 10 May 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<h6 id="other-date-computations-advance">14.1.3.4 <code>advance</code>
</h6><p>The most generic way to jump to other days is <code>advance</code>. This method receives a hash with keys <code>:years</code>, <code>:months</code>, <code>:weeks</code>, <code>:days</code>, and returns a date advanced as much as the present keys indicate:</p><div class="code_container">
<div><div id="highlighter_731329" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.advance(years: </code><code class="ruby constants">1</code><code class="ruby plain">, weeks: </code><code class="ruby constants">2</code><code class="ruby plain">)&nbsp; </code><code class="ruby comments"># =&gt; Mon, 20 Jun 2011</code></div><div class="line number3 index2 alt2"><code class="ruby plain">date.advance(months: </code><code class="ruby constants">2</code><code class="ruby plain">, days: -</code><code class="ruby constants">2</code><code class="ruby plain">) </code><code class="ruby comments"># =&gt; Wed, 04 Aug 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Note in the previous example that increments may be negative.</p><p>To
 perform the computation the method first increments years, then months,
 then weeks, and finally days. This order is important towards the end 
of months. Say for example we are at the end of February of 2010, and we
 want to move one month and one day forward.</p><p>The method <code>advance</code> advances first one month, and then one day, the result is:</p><div class="code_container">
<div><div id="highlighter_445824" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">28</code><code class="ruby plain">).advance(months: </code><code class="ruby constants">1</code><code class="ruby plain">, days: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Sun, 29 Mar 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>While if it did it the other way around the result would be different:</p><div class="code_container">
<div><div id="highlighter_193952" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">28</code><code class="ruby plain">).advance(days: </code><code class="ruby constants">1</code><code class="ruby plain">).advance(months: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Thu, 01 Apr 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="extensions-to-date-calculations-changing-components">14.1.4 Changing Components</h5><p>The method <code>change</code> allows you to get a new date which is the same as the receiver except for the given year, month, or day:</p><div class="code_container">
<div><div id="highlighter_522293" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">12</code><code class="ruby plain">, </code><code class="ruby constants">23</code><code class="ruby plain">).change(year: </code><code class="ruby constants">2011</code><code class="ruby plain">, month: </code><code class="ruby constants">11</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Wed, 23 Nov 2011</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method is not tolerant to non-existing dates, if the change is invalid <code>ArgumentError</code> is raised:</p><div class="code_container">
<div><div id="highlighter_862052" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">31</code><code class="ruby plain">).change(month: </code><code class="ruby constants">2</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; ArgumentError: invalid date</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="extensions-to-date-calculations-durations">14.1.5 Durations</h5><p>Durations can be added to and subtracted from dates:</p><div class="code_container">
<div><div id="highlighter_423885" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = Date.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d + </code><code class="ruby constants">1</code><code class="ruby plain">.year</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Tue, 09 Aug 2011</code></div><div class="line number5 index4 alt2"><code class="ruby plain">d - </code><code class="ruby constants">3</code><code class="ruby plain">.hours</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; Sun, 08 Aug 2010 21:00:00 UTC +00:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They translate to calls to <code>since</code> or <code>advance</code>. For example here we get the correct jump in the calendar reform:</p><div class="code_container">
<div><div id="highlighter_327421" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">1582</code><code class="ruby plain">, </code><code class="ruby constants">10</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">) + </code><code class="ruby constants">1</code><code class="ruby plain">.day</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Fri, 15 Oct 1582</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="timestamps">14.1.6 Timestamps</h5><div class="info"><p>The following methods return a <code>Time</code> object if possible, otherwise a <code>DateTime</code>. If set, they honor the user time zone.</p></div><h6 id="beginning-of-day-end-of-day">14.1.6.1 <code>beginning_of_day</code>, <code>end_of_day</code>
</h6><p>The method <code>beginning_of_day</code> returns a timestamp at the beginning of the day (00:00:00):</p><div class="code_container">
<div><div id="highlighter_809860" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.beginning_of_day </code><code class="ruby comments"># =&gt; Mon Jun 07 00:00:00 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>end_of_day</code> returns a timestamp at the end of the day (23:59:59):</p><div class="code_container">
<div><div id="highlighter_629945" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.end_of_day </code><code class="ruby comments"># =&gt; Mon Jun 07 23:59:59 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_day</code> is aliased to <code>at_beginning_of_day</code>, <code>midnight</code>, <code>at_midnight</code>.</p><h6 id="beginning-of-hour-end-of-hour">14.1.6.2 <code>beginning_of_hour</code>, <code>end_of_hour</code>
</h6><p>The method <code>beginning_of_hour</code> returns a timestamp at the beginning of the hour (hh:00:00):</p><div class="code_container">
<div><div id="highlighter_111491" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = DateTime.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">, </code><code class="ruby constants">19</code><code class="ruby plain">, </code><code class="ruby constants">55</code><code class="ruby plain">, </code><code class="ruby constants">25</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.beginning_of_hour </code><code class="ruby comments"># =&gt; Mon Jun 07 19:00:00 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>end_of_hour</code> returns a timestamp at the end of the hour (hh:59:59):</p><div class="code_container">
<div><div id="highlighter_332705" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = DateTime.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">, </code><code class="ruby constants">19</code><code class="ruby plain">, </code><code class="ruby constants">55</code><code class="ruby plain">, </code><code class="ruby constants">25</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.end_of_hour </code><code class="ruby comments"># =&gt; Mon Jun 07 19:59:59 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_hour</code> is aliased to <code>at_beginning_of_hour</code>.</p><h6 id="beginning-of-minute-end-of-minute">14.1.6.3 <code>beginning_of_minute</code>, <code>end_of_minute</code>
</h6><p>The method <code>beginning_of_minute</code> returns a timestamp at the beginning of the minute (hh:mm:00):</p><div class="code_container">
<div><div id="highlighter_534817" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = DateTime.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">, </code><code class="ruby constants">19</code><code class="ruby plain">, </code><code class="ruby constants">55</code><code class="ruby plain">, </code><code class="ruby constants">25</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.beginning_of_minute </code><code class="ruby comments"># =&gt; Mon Jun 07 19:55:00 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The method <code>end_of_minute</code> returns a timestamp at the end of the minute (hh:mm:59):</p><div class="code_container">
<div><div id="highlighter_359027" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = DateTime.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">7</code><code class="ruby plain">, </code><code class="ruby constants">19</code><code class="ruby plain">, </code><code class="ruby constants">55</code><code class="ruby plain">, </code><code class="ruby constants">25</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.end_of_minute </code><code class="ruby comments"># =&gt; Mon Jun 07 19:55:59 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>
<p><code>beginning_of_minute</code> is aliased to <code>at_beginning_of_minute</code>.</p><div class="info"><p><code>beginning_of_hour</code>, <code>end_of_hour</code>, <code>beginning_of_minute</code> and <code>end_of_minute</code> are implemented for <code>Time</code> and <code>DateTime</code> but <strong>not</strong> <code>Date</code> as it does not make sense to request the beginning or end of an hour or minute on a <code>Date</code> instance.</p></div><h6 id="ago-since">14.1.6.4 <code>ago</code>, <code>since</code>
</h6><p>The method <code>ago</code> receives a number of seconds as argument and returns a timestamp those many seconds ago from midnight:</p><div class="code_container">
<div><div id="highlighter_301640" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.current </code><code class="ruby comments"># =&gt; Fri, 11 Jun 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.ago(</code><code class="ruby constants">1</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Thu, 10 Jun 2010 23:59:59 EDT -04:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Similarly, <code>since</code> moves forward:</p><div class="code_container">
<div><div id="highlighter_73104" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">date = Date.current </code><code class="ruby comments"># =&gt; Fri, 11 Jun 2010</code></div><div class="line number2 index1 alt1"><code class="ruby plain">date.since(</code><code class="ruby constants">1</code><code class="ruby plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Fri, 11 Jun 2010 00:00:01 EDT -04:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="other-time-computations">14.1.7 Other Time Computations</h5><h4 id="extensions-to-date-conversions">14.2 Conversions</h4><h3 id="extensions-to-datetime">15 Extensions to <code>DateTime</code>
</h3><div class="warning"><p><code>DateTime</code> is not aware of DST rules and so some of these methods have edge cases when a DST change is going on. For example <code>seconds_since_midnight</code> might not return the real amount in such a day.</p></div><h4 id="extensions-to-datetime-calculations">15.1 Calculations</h4><div class="note"><p>All the following methods are defined in <code>active_support/core_ext/date_time/calculations.rb</code>.</p></div><p>The class <code>DateTime</code> is a subclass of <code>Date</code> so by loading <code>active_support/core_ext/date/calculations.rb</code> you inherit these methods and their aliases, except that they will always return datetimes:</p><div class="code_container">
<div><div id="highlighter_47124" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">yesterday</code></div><div class="line number2 index1 alt1"><code class="ruby plain">tomorrow</code></div><div class="line number3 index2 alt2"><code class="ruby plain">beginning_of_week (at_beginning_of_week)</code></div><div class="line number4 index3 alt1"><code class="ruby plain">end_of_week (at_end_of_week)</code></div><div class="line number5 index4 alt2"><code class="ruby plain">monday</code></div><div class="line number6 index5 alt1"><code class="ruby plain">sunday</code></div><div class="line number7 index6 alt2"><code class="ruby plain">weeks_ago</code></div><div class="line number8 index7 alt1"><code class="ruby plain">prev_week (last_week)</code></div><div class="line number9 index8 alt2"><code class="ruby plain">next_week</code></div><div class="line number10 index9 alt1"><code class="ruby plain">months_ago</code></div><div class="line number11 index10 alt2"><code class="ruby plain">months_since</code></div><div class="line number12 index11 alt1"><code class="ruby plain">beginning_of_month (at_beginning_of_month)</code></div><div class="line number13 index12 alt2"><code class="ruby plain">end_of_month (at_end_of_month)</code></div><div class="line number14 index13 alt1"><code class="ruby plain">prev_month (last_month)</code></div><div class="line number15 index14 alt2"><code class="ruby plain">next_month</code></div><div class="line number16 index15 alt1"><code class="ruby plain">beginning_of_quarter (at_beginning_of_quarter)</code></div><div class="line number17 index16 alt2"><code class="ruby plain">end_of_quarter (at_end_of_quarter)</code></div><div class="line number18 index17 alt1"><code class="ruby plain">beginning_of_year (at_beginning_of_year)</code></div><div class="line number19 index18 alt2"><code class="ruby plain">end_of_year (at_end_of_year)</code></div><div class="line number20 index19 alt1"><code class="ruby plain">years_ago</code></div><div class="line number21 index20 alt2"><code class="ruby plain">years_since</code></div><div class="line number22 index21 alt1"><code class="ruby plain">prev_year (last_year)</code></div><div class="line number23 index22 alt2"><code class="ruby plain">next_year</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>The following methods are reimplemented so you do <strong>not</strong> need to load <code>active_support/core_ext/date/calculations.rb</code> for these ones:</p><div class="code_container">
<div><div id="highlighter_574202" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">beginning_of_day (midnight, at_midnight, at_beginning_of_day)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">end_of_day</code></div><div class="line number3 index2 alt2"><code class="ruby plain">ago</code></div><div class="line number4 index3 alt1"><code class="ruby plain">since (</code><code class="ruby keyword">in</code><code class="ruby plain">)</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>On the other hand, <code>advance</code> and <code>change</code> are also defined and support more options, they are documented below.</p><p>The following methods are only implemented in <code>active_support/core_ext/date_time/calculations.rb</code> as they only make sense when used with a <code>DateTime</code> instance:</p><div class="code_container">
<div><div id="highlighter_60065" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">beginning_of_hour (at_beginning_of_hour)</code></div><div class="line number2 index1 alt1"><code class="ruby plain">end_of_hour</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="named-datetimes">15.1.1 Named Datetimes</h5><h6 id="datetime-current">15.1.1.1 <code>DateTime.current</code>
</h6><p>Active Support defines <code>DateTime.current</code> to be like <code>Time.now.to_datetime</code>, except that it honors the user time zone, if defined. It also defines <code>DateTime.yesterday</code> and <code>DateTime.tomorrow</code>, and the instance predicates <code>past?</code>, and <code>future?</code> relative to <code>DateTime.current</code>.</p><h5 id="other-extensions">15.1.2 Other Extensions</h5><h6 id="seconds-since-midnight">15.1.2.1 <code>seconds_since_midnight</code>
</h6><p>The method <code>seconds_since_midnight</code> returns the number of seconds since midnight:</p><div class="code_container">
<div><div id="highlighter_24385" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = DateTime.current&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 07 Jun 2010 20:26:36 +0000</code></div><div class="line number2 index1 alt1"><code class="ruby plain">now.seconds_since_midnight </code><code class="ruby comments"># =&gt; 73596</code></div></div></td></tr></tbody></table></div></div>
</div>
<h6 id="utc">15.1.2.2 <code>utc</code>
</h6><p>The method <code>utc</code> gives you the same datetime in the receiver expressed in UTC.</p><div class="code_container">
<div><div id="highlighter_921649" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = DateTime.current </code><code class="ruby comments"># =&gt; Mon, 07 Jun 2010 19:27:52 -0400</code></div><div class="line number2 index1 alt1"><code class="ruby plain">now.utc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; Mon, 07 Jun 2010 23:27:52 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method is also aliased as <code>getutc</code>.</p><h6 id="utc-questionmark">15.1.2.3 <code>utc?</code>
</h6><p>The predicate <code>utc?</code> says whether the receiver has UTC as its time zone:</p><div class="code_container">
<div><div id="highlighter_807507" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = DateTime.now </code><code class="ruby comments"># =&gt; Mon, 07 Jun 2010 19:30:47 -0400</code></div><div class="line number2 index1 alt1"><code class="ruby plain">now.utc?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; false</code></div><div class="line number3 index2 alt2"><code class="ruby plain">now.utc.utc?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="ruby comments"># =&gt; true</code></div></div></td></tr></tbody></table></div></div>
</div>
<h6 id="other-extensions-advance">15.1.2.4 <code>advance</code>
</h6><p>The most generic way to jump to another datetime is <code>advance</code>. This method receives a hash with keys <code>:years</code>, <code>:months</code>, <code>:weeks</code>, <code>:days</code>, <code>:hours</code>, <code>:minutes</code>, and <code>:seconds</code>, and returns a datetime advanced as much as the present keys indicate.</p><div class="code_container">
<div><div id="highlighter_63600" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = DateTime.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Thu, 05 Aug 2010 11:33:31 +0000</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.advance(years: </code><code class="ruby constants">1</code><code class="ruby plain">, months: </code><code class="ruby constants">1</code><code class="ruby plain">, days: </code><code class="ruby constants">1</code><code class="ruby plain">, hours: </code><code class="ruby constants">1</code><code class="ruby plain">, minutes: </code><code class="ruby constants">1</code><code class="ruby plain">, seconds: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Tue, 06 Sep 2011 12:34:32 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method first computes the destination date passing <code>:years</code>, <code>:months</code>, <code>:weeks</code>, and <code>:days</code> to <code>Date#advance</code> documented above. After that, it adjusts the time calling <code>since</code>
 with the number of seconds to advance. This order is relevant, a 
different ordering would give different datetimes in some edge-cases. 
The example in <code>Date#advance</code> applies, and we can extend it to show order relevance related to the time bits.</p><p>If
 we first move the date bits (that have also a relative order of 
processing, as documented before), and then the time bits we get for 
example the following computation:</p><div class="code_container">
<div><div id="highlighter_205290" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d = DateTime.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">2</code><code class="ruby plain">, </code><code class="ruby constants">28</code><code class="ruby plain">, </code><code class="ruby constants">23</code><code class="ruby plain">, </code><code class="ruby constants">59</code><code class="ruby plain">, </code><code class="ruby constants">59</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Sun, 28 Feb 2010 23:59:59 +0000</code></div><div class="line number3 index2 alt2"><code class="ruby plain">d.advance(months: </code><code class="ruby constants">1</code><code class="ruby plain">, seconds: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Mon, 29 Mar 2010 00:00:00 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>but if we computed them the other way around, the result would be different:</p><div class="code_container">
<div><div id="highlighter_460741" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">d.advance(seconds: </code><code class="ruby constants">1</code><code class="ruby plain">).advance(months: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Thu, 01 Apr 2010 00:00:00 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="warning"><p>Since <code>DateTime</code> is not DST-aware you can end up in a non-existing point in time with no warning or error telling you so.</p></div><h5 id="extensions-to-datetime-calculations-changing-components">15.1.3 Changing Components</h5><p>The method <code>change</code> allows you to get a new datetime which is the same as the receiver except for the given options, which may include <code>:year</code>, <code>:month</code>, <code>:day</code>, <code>:hour</code>, <code>:min</code>, <code>:sec</code>, <code>:offset</code>, <code>:start</code>:</p><div class="code_container">
<div><div id="highlighter_122443" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = DateTime.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Tue, 08 Jun 2010 01:56:22 +0000</code></div><div class="line number3 index2 alt2"><code class="ruby plain">now.change(year: </code><code class="ruby constants">2011</code><code class="ruby plain">, offset: Rational(-</code><code class="ruby constants">6</code><code class="ruby plain">, </code><code class="ruby constants">24</code><code class="ruby plain">))</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Wed, 08 Jun 2011 01:56:22 -0600</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If hours are zeroed, then minutes and seconds are too (unless they have given values):</p><div class="code_container">
<div><div id="highlighter_620591" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now.change(hour: </code><code class="ruby constants">0</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Tue, 08 Jun 2010 00:00:00 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Similarly, if minutes are zeroed, then seconds are too (unless it has given a value):</p><div class="code_container">
<div><div id="highlighter_760471" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now.change(min: </code><code class="ruby constants">0</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Tue, 08 Jun 2010 01:00:00 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>This method is not tolerant to non-existing dates, if the change is invalid <code>ArgumentError</code> is raised:</p><div class="code_container">
<div><div id="highlighter_898749" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">DateTime.current.change(month: </code><code class="ruby constants">2</code><code class="ruby plain">, day: </code><code class="ruby constants">30</code><code class="ruby plain">)</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; ArgumentError: invalid date</code></div></div></td></tr></tbody></table></div></div>
</div>
<h5 id="extensions-to-datetime-calculations-durations">15.1.4 Durations</h5><p>Durations can be added to and subtracted from datetimes:</p><div class="code_container">
<div><div id="highlighter_358116" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = DateTime.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010 23:15:17 +0000</code></div><div class="line number3 index2 alt2"><code class="ruby plain">now + </code><code class="ruby constants">1</code><code class="ruby plain">.year</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Tue, 09 Aug 2011 23:15:17 +0000</code></div><div class="line number5 index4 alt2"><code class="ruby plain">now - </code><code class="ruby constants">1</code><code class="ruby plain">.week</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; Mon, 02 Aug 2010 23:15:17 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They translate to calls to <code>since</code> or <code>advance</code>. For example here we get the correct jump in the calendar reform:</p><div class="code_container">
<div><div id="highlighter_9125" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">DateTime.</code><code class="ruby keyword">new</code><code class="ruby plain">(</code><code class="ruby constants">1582</code><code class="ruby plain">, </code><code class="ruby constants">10</code><code class="ruby plain">, </code><code class="ruby constants">4</code><code class="ruby plain">, </code><code class="ruby constants">23</code><code class="ruby plain">) + </code><code class="ruby constants">1</code><code class="ruby plain">.hour</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Fri, 15 Oct 1582 00:00:00 +0000</code></div></div></td></tr></tbody></table></div></div>
</div>
<h3 id="extensions-to-time">16 Extensions to <code>Time</code>
</h3><h4 id="calculations">16.1 Calculations</h4><div class="note"><p>All the following methods are defined in <code>active_support/core_ext/time/calculations.rb</code>.</p></div><p>Active Support adds to <code>Time</code> many of the methods available for <code>DateTime</code>:</p><div class="code_container">
<div><div id="highlighter_530106" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">past?</code></div><div class="line number2 index1 alt1"><code class="ruby plain">today?</code></div><div class="line number3 index2 alt2"><code class="ruby plain">future?</code></div><div class="line number4 index3 alt1"><code class="ruby plain">yesterday</code></div><div class="line number5 index4 alt2"><code class="ruby plain">tomorrow</code></div><div class="line number6 index5 alt1"><code class="ruby plain">seconds_since_midnight</code></div><div class="line number7 index6 alt2"><code class="ruby plain">change</code></div><div class="line number8 index7 alt1"><code class="ruby plain">advance</code></div><div class="line number9 index8 alt2"><code class="ruby plain">ago</code></div><div class="line number10 index9 alt1"><code class="ruby plain">since (</code><code class="ruby keyword">in</code><code class="ruby plain">)</code></div><div class="line number11 index10 alt2"><code class="ruby plain">beginning_of_day (midnight, at_midnight, at_beginning_of_day)</code></div><div class="line number12 index11 alt1"><code class="ruby plain">end_of_day</code></div><div class="line number13 index12 alt2"><code class="ruby plain">beginning_of_hour (at_beginning_of_hour)</code></div><div class="line number14 index13 alt1"><code class="ruby plain">end_of_hour</code></div><div class="line number15 index14 alt2"><code class="ruby plain">beginning_of_week (at_beginning_of_week)</code></div><div class="line number16 index15 alt1"><code class="ruby plain">end_of_week (at_end_of_week)</code></div><div class="line number17 index16 alt2"><code class="ruby plain">monday</code></div><div class="line number18 index17 alt1"><code class="ruby plain">sunday</code></div><div class="line number19 index18 alt2"><code class="ruby plain">weeks_ago</code></div><div class="line number20 index19 alt1"><code class="ruby plain">prev_week (last_week)</code></div><div class="line number21 index20 alt2"><code class="ruby plain">next_week</code></div><div class="line number22 index21 alt1"><code class="ruby plain">months_ago</code></div><div class="line number23 index22 alt2"><code class="ruby plain">months_since</code></div><div class="line number24 index23 alt1"><code class="ruby plain">beginning_of_month (at_beginning_of_month)</code></div><div class="line number25 index24 alt2"><code class="ruby plain">end_of_month (at_end_of_month)</code></div><div class="line number26 index25 alt1"><code class="ruby plain">prev_month (last_month)</code></div><div class="line number27 index26 alt2"><code class="ruby plain">next_month</code></div><div class="line number28 index27 alt1"><code class="ruby plain">beginning_of_quarter (at_beginning_of_quarter)</code></div><div class="line number29 index28 alt2"><code class="ruby plain">end_of_quarter (at_end_of_quarter)</code></div><div class="line number30 index29 alt1"><code class="ruby plain">beginning_of_year (at_beginning_of_year)</code></div><div class="line number31 index30 alt2"><code class="ruby plain">end_of_year (at_end_of_year)</code></div><div class="line number32 index31 alt1"><code class="ruby plain">years_ago</code></div><div class="line number33 index32 alt2"><code class="ruby plain">years_since</code></div><div class="line number34 index33 alt1"><code class="ruby plain">prev_year (last_year)</code></div><div class="line number35 index34 alt2"><code class="ruby plain">next_year</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They are analogous. Please refer to their documentation above and take into account the following differences:</p>
<ul>
<li>
<code>change</code> accepts an additional <code>:usec</code> option.</li>
<li>
<code>Time</code> understands DST, so you get correct DST calculations as in</li>
</ul>
<div class="code_container">
<div><div id="highlighter_108834" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Time</code><code class="ruby plain">.zone_default</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; #&lt;ActiveSupport::TimeZone:0x7f73654d4f38 @utc_offset=nil, @name="Madrid", ...&gt;</code></div><div class="line number3 index2 alt2">&nbsp;</div><div class="line number4 index3 alt1"><code class="ruby comments"># In Barcelona, 2010/03/28 02:00 +0100 becomes 2010/03/28 03:00 +0200 due to DST.</code></div><div class="line number5 index4 alt2"><code class="ruby plain">t = </code><code class="ruby color1">Time</code><code class="ruby plain">.local(</code><code class="ruby constants">2010</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">, </code><code class="ruby constants">28</code><code class="ruby plain">, </code><code class="ruby constants">1</code><code class="ruby plain">, </code><code class="ruby constants">59</code><code class="ruby plain">, </code><code class="ruby constants">59</code><code class="ruby plain">)</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; Sun Mar 28 01:59:59 +0100 2010</code></div><div class="line number7 index6 alt2"><code class="ruby plain">t.advance(seconds: </code><code class="ruby constants">1</code><code class="ruby plain">)</code></div><div class="line number8 index7 alt1"><code class="ruby comments"># =&gt; Sun Mar 28 03:00:00 +0200 2010</code></div></div></td></tr></tbody></table></div></div>
</div>

<ul>
<li>If <code>since</code> or <code>ago</code> jump to a time that can't be expressed with <code>Time</code> a <code>DateTime</code> object is returned instead.</li>
</ul>
<h5 id="time-current">16.1.1 <code>Time.current</code>
</h5><p>Active Support defines <code>Time.current</code> to be today in the current time zone. That's like <code>Time.now</code>, except that it honors the user time zone, if defined. It also defines the instance predicates <code>past?</code>, <code>today?</code>, and <code>future?</code>, all of them relative to <code>Time.current</code>.</p><p>When making Time comparisons using methods which honor the user time zone, make sure to use <code>Time.current</code> instead of <code>Time.now</code>. There are cases where the user time zone might be in the future compared to the system time zone, which <code>Time.now</code> uses by default. This means <code>Time.now.to_date</code> may equal <code>Date.yesterday</code>.</p><h5 id="all-day-all-week-all-month-all-quarter-and-all-year">16.1.2 <code>all_day</code>, <code>all_week</code>, <code>all_month</code>, <code>all_quarter</code> and <code>all_year</code>
</h5><p>The method <code>all_day</code> returns a range representing the whole day of the current time.</p><div class="code_container">
<div><div id="highlighter_955298" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = </code><code class="ruby color1">Time</code><code class="ruby plain">.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00</code></div><div class="line number3 index2 alt2"><code class="ruby plain">now.all_day</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010 00:00:00 UTC +00:00..Mon, 09 Aug 2010 23:59:59 UTC +00:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Analogously, <code>all_week</code>, <code>all_month</code>, <code>all_quarter</code> and <code>all_year</code> all serve the purpose of generating time ranges.</p><div class="code_container">
<div><div id="highlighter_605768" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = </code><code class="ruby color1">Time</code><code class="ruby plain">.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00</code></div><div class="line number3 index2 alt2"><code class="ruby plain">now.all_week</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010 00:00:00 UTC +00:00..Sun, 15 Aug 2010 23:59:59 UTC +00:00</code></div><div class="line number5 index4 alt2"><code class="ruby plain">now.all_week(</code><code class="ruby color2">:sunday</code><code class="ruby plain">)</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; Sun, 16 Sep 2012 00:00:00 UTC +00:00..Sat, 22 Sep 2012 23:59:59 UTC +00:00</code></div><div class="line number7 index6 alt2"><code class="ruby plain">now.all_month</code></div><div class="line number8 index7 alt1"><code class="ruby comments"># =&gt; Sat, 01 Aug 2010 00:00:00 UTC +00:00..Tue, 31 Aug 2010 23:59:59 UTC +00:00</code></div><div class="line number9 index8 alt2"><code class="ruby plain">now.all_quarter</code></div><div class="line number10 index9 alt1"><code class="ruby comments"># =&gt; Thu, 01 Jul 2010 00:00:00 UTC +00:00..Thu, 30 Sep 2010 23:59:59 UTC +00:00</code></div><div class="line number11 index10 alt2"><code class="ruby plain">now.all_year</code></div><div class="line number12 index11 alt1"><code class="ruby comments"># =&gt; Fri, 01 Jan 2010 00:00:00 UTC +00:00..Fri, 31 Dec 2010 23:59:59 UTC +00:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<h4 id="time-constructors">16.2 Time Constructors</h4><p>Active Support defines <code>Time.current</code> to be <code>Time.zone.now</code> if there's a user time zone defined, with fallback to <code>Time.now</code>:</p><div class="code_container">
<div><div id="highlighter_316423" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Time</code><code class="ruby plain">.zone_default</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; #&lt;ActiveSupport::TimeZone:0x7f73654d4f38 @utc_offset=nil, @name="Madrid", ...&gt;</code></div><div class="line number3 index2 alt2"><code class="ruby color1">Time</code><code class="ruby plain">.current</code></div><div class="line number4 index3 alt1"><code class="ruby comments"># =&gt; Fri, 06 Aug 2010 17:11:58 CEST +02:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>Analogously to <code>DateTime</code>, the predicates <code>past?</code>, and <code>future?</code> are relative to <code>Time.current</code>.</p><p>If the time to be constructed lies beyond the range supported by <code>Time</code> in the runtime platform, usecs are discarded and a <code>DateTime</code> object is returned instead.</p><h5 id="durations">16.2.1 Durations</h5><p>Durations can be added to and subtracted from time objects:</p><div class="code_container">
<div><div id="highlighter_589911" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby plain">now = </code><code class="ruby color1">Time</code><code class="ruby plain">.current</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Mon, 09 Aug 2010 23:20:05 UTC +00:00</code></div><div class="line number3 index2 alt2"><code class="ruby plain">now + </code><code class="ruby constants">1</code><code class="ruby plain">.year</code></div><div class="line number4 index3 alt1"><code class="ruby comments">#&nbsp; =&gt; Tue, 09 Aug 2011 23:21:11 UTC +00:00</code></div><div class="line number5 index4 alt2"><code class="ruby plain">now - </code><code class="ruby constants">1</code><code class="ruby plain">.week</code></div><div class="line number6 index5 alt1"><code class="ruby comments"># =&gt; Mon, 02 Aug 2010 23:21:11 UTC +00:00</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>They translate to calls to <code>since</code> or <code>advance</code>. For example here we get the correct jump in the calendar reform:</p><div class="code_container">
<div><div id="highlighter_368086" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">Time</code><code class="ruby plain">.utc(</code><code class="ruby constants">1582</code><code class="ruby plain">, </code><code class="ruby constants">10</code><code class="ruby plain">, </code><code class="ruby constants">3</code><code class="ruby plain">) + </code><code class="ruby constants">5</code><code class="ruby plain">.days</code></div><div class="line number2 index1 alt1"><code class="ruby comments"># =&gt; Mon Oct 18 00:00:00 UTC 1582</code></div></div></td></tr></tbody></table></div></div>
</div>
<h3 id="extensions-to-file">17 Extensions to <code>File</code>
</h3><h4 id="atomic-write">17.1 <code>atomic_write</code>
</h4><p>With the class method <code>File.atomic_write</code> you can write to a file in a way that will prevent any reader from seeing half-written content.</p><p>The name of the file is passed as an argument, and the method yields a file handle opened for writing. Once the block is done <code>atomic_write</code> closes the file handle and completes its job.</p><p>For example, Action Pack uses this method to write asset cache files like <code>all.css</code>:</p><div class="code_container">
<div><div id="highlighter_645651" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">File</code><code class="ruby plain">.atomic_write(joined_asset_path) </code><code class="ruby keyword">do</code> <code class="ruby plain">|cache|</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">cache.write(join_asset_file_contents(asset_paths))</code></div><div class="line number3 index2 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>To accomplish this <code>atomic_write</code> creates a temporary 
file. That's the file the code in the block actually writes to. On 
completion, the temporary file is renamed, which is an atomic operation 
on POSIX systems. If the target file exists <code>atomic_write</code> overwrites it and keeps owners and permissions. However there are a few cases where <code>atomic_write</code>
 cannot change the file ownership or permissions, this error is caught 
and skipped over trusting in the user/filesystem to ensure the file is 
accessible to the processes that need it.</p><div class="note"><p>Due to the chmod operation <code>atomic_write</code> performs, if the target file has an ACL set on it this ACL will be recalculated/modified.</p></div><div class="warning"><p>Note you can't append with <code>atomic_write</code>.</p></div><p>The
 auxiliary file is written in a standard directory for temporary files, 
but you can pass a directory of your choice as second argument.</p><div class="note"><p>Defined in <code>active_support/core_ext/file/atomic.rb</code>.</p></div><h3 id="extensions-to-marshal">18 Extensions to <code>Marshal</code>
</h3><h4 id="load">18.1 <code>load</code>
</h4><p>Active Support adds constant autoloading support to <code>load</code>.</p><p>For example, the file cache store deserializes this way:</p><div class="code_container">
<div><div id="highlighter_714612" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby color1">File</code><code class="ruby plain">.open(file_name) { |f| Marshal.load(f) }</code></div></div></td></tr></tbody></table></div></div>
</div>
<p>If the cached data refers to a constant that is unknown at that 
point, the autoloading mechanism is triggered and if it succeeds the 
deserialization is retried transparently.</p><div class="warning"><p>If the argument is an <code>IO</code> it needs to respond to <code>rewind</code> to be able to retry. Regular files respond to <code>rewind</code>.</p></div><div class="note"><p>Defined in <code>active_support/core_ext/marshal.rb</code>.</p></div><h3 id="extensions-to-nameerror">19 Extensions to <code>NameError</code>
</h3><p>Active Support adds <code>missing_name?</code> to <code>NameError</code>, which tests whether the exception was raised because of the name passed as argument.</p><p>The
 name may be given as a symbol or string. A symbol is tested against the
 bare constant name, a string is against the fully-qualified constant 
name.</p><div class="info"><p>A symbol can represent a fully-qualified constant name as in <code>:"ActiveRecord::Base"</code>, so the behavior for symbols is defined for convenience, not because it has to be that way technically.</p></div><p>For example, when an action of <code>ArticlesController</code> is called Rails tries optimistically to use <code>ArticlesHelper</code>.
 It is OK that the helper module does not exist, so if an exception for 
that constant name is raised it should be silenced. But it could be the 
case that <code>articles_helper.rb</code> raises a <code>NameError</code> due to an actual unknown constant. That should be reraised. The method <code>missing_name?</code> provides a way to distinguish both cases:</p><div class="code_container">
<div><div id="highlighter_520404" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">default_helper_module!</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">module_name = name.sub(/Controller$/, </code><code class="ruby string">''</code><code class="ruby plain">)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">module_path = module_name.underscore</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">helper module_path</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">rescue</code> <code class="ruby plain">LoadError =&gt; e</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">raise</code> <code class="ruby plain">e </code><code class="ruby keyword">unless</code> <code class="ruby plain">e.is_missing? </code><code class="ruby string">"helpers/#{module_path}_helper"</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">rescue</code> <code class="ruby plain">NameError =&gt; e</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">raise</code> <code class="ruby plain">e </code><code class="ruby keyword">unless</code> <code class="ruby plain">e.missing_name? </code><code class="ruby string">"#{module_name}Helper"</code></div><div class="line number9 index8 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/name_error.rb</code>.</p></div><h3 id="extensions-to-loaderror">20 Extensions to <code>LoadError</code>
</h3><p>Active Support adds <code>is_missing?</code> to <code>LoadError</code>.</p><p>Given a path name <code>is_missing?</code> tests whether the exception was raised due to that particular file (except perhaps for the ".rb" extension).</p><p>For example, when an action of <code>ArticlesController</code> is called Rails tries to load <code>articles_helper.rb</code>,
 but that file may not exist. That's fine, the helper module is not 
mandatory so Rails silences a load error. But it could be the case that 
the helper module does exist and in turn requires another library that 
is missing. In that case Rails must reraise the exception. The method <code>is_missing?</code> provides a way to distinguish both cases:</p><div class="code_container">
<div><div id="highlighter_487705" class="syntaxhighlighter nogutter  ruby"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="ruby keyword">def</code> <code class="ruby plain">default_helper_module!</code></div><div class="line number2 index1 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">module_name = name.sub(/Controller$/, </code><code class="ruby string">''</code><code class="ruby plain">)</code></div><div class="line number3 index2 alt2"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">module_path = module_name.underscore</code></div><div class="line number4 index3 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby plain">helper module_path</code></div><div class="line number5 index4 alt2"><code class="ruby keyword">rescue</code> <code class="ruby plain">LoadError =&gt; e</code></div><div class="line number6 index5 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">raise</code> <code class="ruby plain">e </code><code class="ruby keyword">unless</code> <code class="ruby plain">e.is_missing? </code><code class="ruby string">"helpers/#{module_path}_helper"</code></div><div class="line number7 index6 alt2"><code class="ruby keyword">rescue</code> <code class="ruby plain">NameError =&gt; e</code></div><div class="line number8 index7 alt1"><code class="ruby spaces">&nbsp;&nbsp;</code><code class="ruby keyword">raise</code> <code class="ruby plain">e </code><code class="ruby keyword">unless</code> <code class="ruby plain">e.missing_name? </code><code class="ruby string">"#{module_name}Helper"</code></div><div class="line number9 index8 alt2"><code class="ruby keyword">end</code></div></div></td></tr></tbody></table></div></div>
</div>
<div class="note"><p>Defined in <code>active_support/core_ext/load_error.rb</code>.</p></div>

        <h3>Feedback</h3>
        <p>
          You're encouraged to help improve the quality of this guide.
        </p>
        <p>
          Please contribute if you see any typos or factual errors.
          To get started, you can read our <a href="http://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">documentation contributions</a> section.
        </p>
        <p>
          You may also find incomplete content, or stuff that is not up to date.
          Please do add any missing documentation for master. Make sure to check
          <a href="http://edgeguides.rubyonrails.org/">Edge Guides</a> first to verify
          if the issues are already fixed or not on the master branch.
          Check the <a href="http://edgeguides.rubyonrails.org/ruby_on_rails_guides_guidelines.html">Ruby on Rails Guides Guidelines</a>
          for style and conventions.
        </p>
        <p>
          If for whatever reason you spot something to fix but cannot patch it yourself, please
          <a href="https://github.com/rails/rails/issues">open an issue</a>.
        </p>
        <p>And last but not least, any kind of discussion regarding Ruby on Rails
          documentation is very welcome in the <a href="http://groups.google.com/group/rubyonrails-docs">rubyonrails-docs mailing list</a>.
        </p>
      </div>
    </div>
  </div>

  <hr class="hide">
  <div id="footer">
    <div class="wrapper">
      <p>This work is licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a> License</p>
<p>"Rails", "Ruby on Rails", and the Rails logo are trademarks of David Heinemeier Hansson. All rights reserved.</p>

    </div>
  </div>

  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/jquery.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/responsive-tables.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/guides.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shCore.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shBrushRuby.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shBrushXml.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shBrushSql.js"></script>
  <script type="text/javascript" src="Active%20Support%20Core%20Extensions%20%E2%80%94%20Ruby%20on%20Rails%20Guides_files/shBrushPlain.js"></script>
  <script type="text/javascript">
    SyntaxHighlighter.all();
    $(guidesIndex.bind);
  </script>


</body></html>